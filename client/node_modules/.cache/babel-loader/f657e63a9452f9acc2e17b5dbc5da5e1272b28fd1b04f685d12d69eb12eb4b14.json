{"ast":null,"code":"/**\n * Utilitaire d'optimisation des performances pour le site Grand Est Cyclisme\n * Implémente des techniques avancées pour améliorer les performances globales\n */import{useEffect,useState,useRef}from'react';// Constantes pour les seuils de performance\nconst PERFORMANCE_THRESHOLDS={INTERACTION_DELAY:100,// ms\nLONG_TASK_THRESHOLD:50,// ms\nIDLE_CALLBACK_TIMEOUT:1000,// ms\nRESOURCE_CACHE_MAX_AGE:7*24*60*60*1000,// 7 jours\nIMAGE_LAZY_LOAD_OFFSET:200// px\n};/**\n * Classe principale d'optimisation des performances\n */class PerformanceOptimizer{constructor(){this.isEnabled=true;this.metrics={fpsHistory:[],resourceLoadTimes:{},interactionDelays:[],memoryUsage:[]};this.observers={};this.optimizations={lazyLoading:true,codeChunking:true,imageOptimization:true,caching:true,prefetching:true,resourceHints:true};this.deviceInfo=this._detectDeviceCapabilities();this.initialized=false;}/**\n   * Initialise l'optimiseur de performances\n   * @param {Object} options - Options de configuration\n   */initialize(){let options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(this.initialized)return;console.log('Initialisation de l\\'optimiseur de performances...');// Fusionner les options avec les valeurs par défaut\nthis.optimizations={...this.optimizations,...options};// Démarrer la collecte de métriques\nthis._startMetricsCollection();// Initialiser les observateurs\nthis._initializeObservers();// Appliquer les optimisations initiales\nthis._applyInitialOptimizations();this.initialized=true;console.log('Optimiseur de performances initialisé avec succès');}/**\n   * Détecte les capacités de l'appareil\n   * @returns {Object} Informations sur l'appareil\n   * @private\n   */_detectDeviceCapabilities(){const info={isMobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),isLowEndDevice:false,hasLimitedMemory:false,hasSlowConnection:false,supportsWebGL:false,supportsWebP:false,devicePixelRatio:window.devicePixelRatio||1,screenSize:{width:window.screen.width,height:window.screen.height},connection:null};// Détecter les appareils à faibles ressources\nif('deviceMemory'in navigator){info.hasLimitedMemory=navigator.deviceMemory<4;// Moins de 4GB de RAM\n}// Détecter les connexions lentes\nif('connection'in navigator&&navigator.connection){info.connection={type:navigator.connection.effectiveType,downlink:navigator.connection.downlink,rtt:navigator.connection.rtt,saveData:navigator.connection.saveData};info.hasSlowConnection=navigator.connection.effectiveType==='slow-2g'||navigator.connection.effectiveType==='2g'||navigator.connection.downlink<1.0;}// Vérifier le support WebGL\ntry{const canvas=document.createElement('canvas');info.supportsWebGL=!!(window.WebGLRenderingContext&&(canvas.getContext('webgl')||canvas.getContext('experimental-webgl')));}catch(e){info.supportsWebGL=false;}// Vérifier le support WebP\nconst webpImage=new Image();webpImage.onload=function(){info.supportsWebP=webpImage.width>0&&webpImage.height>0;};webpImage.onerror=function(){info.supportsWebP=false;};webpImage.src='data:image/webp;base64,UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==';// Déterminer si c'est un appareil à faibles performances\ninfo.isLowEndDevice=info.hasLimitedMemory||info.hasSlowConnection||info.isMobile&&info.screenSize.width<768;return info;}/**\n   * Démarre la collecte de métriques de performance\n   * @private\n   */_startMetricsCollection(){// Collecter les FPS\nif(window.requestAnimationFrame){let lastTime=performance.now();let frames=0;const collectFPS=()=>{const now=performance.now();frames++;if(now>lastTime+1000){const fps=Math.round(frames*1000/(now-lastTime));this.metrics.fpsHistory.push({timestamp:now,fps:fps});// Limiter l'historique à 60 entrées (1 minute à 1 mesure/s)\nif(this.metrics.fpsHistory.length>60){this.metrics.fpsHistory.shift();}frames=0;lastTime=now;}window.requestAnimationFrame(collectFPS);};window.requestAnimationFrame(collectFPS);}// Surveiller l'utilisation de la mémoire\nif(window.performance&&window.performance.memory){setInterval(()=>{this.metrics.memoryUsage.push({timestamp:performance.now(),usedJSHeapSize:performance.memory.usedJSHeapSize,totalJSHeapSize:performance.memory.totalJSHeapSize});// Limiter l'historique à 60 entrées\nif(this.metrics.memoryUsage.length>60){this.metrics.memoryUsage.shift();}},10000);// Toutes les 10 secondes\n}// Surveiller les temps de chargement des ressources\nif(window.performance&&window.performance.getEntriesByType){const processResources=()=>{const resources=performance.getEntriesByType('resource');resources.forEach(resource=>{const url=resource.name;const type=this._getResourceType(url);if(!this.metrics.resourceLoadTimes[type]){this.metrics.resourceLoadTimes[type]=[];}this.metrics.resourceLoadTimes[type].push({url:url,duration:resource.duration,size:resource.transferSize||0,timestamp:resource.startTime});});// Effacer les entrées traitées\nperformance.clearResourceTimings();};// Observer les nouvelles ressources\nif(window.PerformanceObserver){const observer=new PerformanceObserver(list=>{processResources();});observer.observe({entryTypes:['resource']});}else{// Fallback pour les navigateurs sans PerformanceObserver\nsetInterval(processResources,5000);}}// Surveiller les délais d'interaction\ndocument.addEventListener('click',e=>{const start=performance.now();window.requestAnimationFrame(()=>{const duration=performance.now()-start;this.metrics.interactionDelays.push({timestamp:start,duration:duration,type:'click'});// Limiter l'historique à 50 entrées\nif(this.metrics.interactionDelays.length>50){this.metrics.interactionDelays.shift();}});},{passive:true});}/**\n   * Initialise les observateurs pour surveiller les performances\n   * @private\n   */_initializeObservers(){// Observer les tâches longues\nif(window.PerformanceObserver){try{this.observers.longTasks=new PerformanceObserver(list=>{list.getEntries().forEach(entry=>{console.warn(`Tâche longue détectée: ${entry.duration}ms`,entry);// Si la tâche est très longue, ajuster automatiquement les optimisations\nif(entry.duration>PERFORMANCE_THRESHOLDS.LONG_TASK_THRESHOLD*2){this._adjustOptimizationsForLowPerformance();}});});this.observers.longTasks.observe({entryTypes:['longtask']});}catch(e){console.log('PerformanceObserver pour longtask non supporté');}}// Observer les changements de connexion réseau\nif(navigator.connection){navigator.connection.addEventListener('change',()=>{this.deviceInfo.connection={type:navigator.connection.effectiveType,downlink:navigator.connection.downlink,rtt:navigator.connection.rtt,saveData:navigator.connection.saveData};this.deviceInfo.hasSlowConnection=navigator.connection.effectiveType==='slow-2g'||navigator.connection.effectiveType==='2g'||navigator.connection.downlink<1.0;// Ajuster les optimisations en fonction de la connexion\nthis._adjustOptimizationsForConnection();});}// Observer la visibilité de la page\ndocument.addEventListener('visibilitychange',()=>{if(document.visibilityState==='hidden'){// La page est cachée, réduire les opérations\nthis._pauseNonEssentialOperations();}else{// La page est visible à nouveau, reprendre les opérations\nthis._resumeOperations();}});}/**\n   * Applique les optimisations initiales\n   * @private\n   */_applyInitialOptimizations(){// Optimisations basées sur les capacités de l'appareil\nif(this.deviceInfo.isLowEndDevice){this._adjustOptimizationsForLowPerformance();}// Optimisations basées sur la connexion\nthis._adjustOptimizationsForConnection();// Préchargement des ressources critiques\nif(this.optimizations.prefetching){this._prefetchCriticalResources();}// Indications de ressources\nif(this.optimizations.resourceHints){this._addResourceHints();}}/**\n   * Ajuste les optimisations pour les appareils à faibles performances\n   * @private\n   */_adjustOptimizationsForLowPerformance(){console.log('Ajustement des optimisations pour appareil à faibles performances');// Réduire la qualité des images\nif(this.optimizations.imageOptimization){document.documentElement.classList.add('optimize-images');}// Désactiver les animations non essentielles\ndocument.documentElement.classList.add('reduce-animations');// Réduire la fréquence des mises à jour de l'interface\nthis._throttleUIUpdates();}/**\n   * Ajuste les optimisations en fonction de la connexion réseau\n   * @private\n   */_adjustOptimizationsForConnection(){if(!this.deviceInfo.connection)return;console.log(`Ajustement des optimisations pour connexion: ${this.deviceInfo.connection.type}`);if(this.deviceInfo.hasSlowConnection){// Activer le mode économie de données\ndocument.documentElement.classList.add('data-saver');// Réduire la qualité des images\nif(this.optimizations.imageOptimization){document.documentElement.classList.add('optimize-images');}// Désactiver le préchargement\nthis.optimizations.prefetching=false;}else{// Connexion rapide, optimisations normales\ndocument.documentElement.classList.remove('data-saver');document.documentElement.classList.remove('optimize-images');// Réactiver le préchargement si désactivé\nthis.optimizations.prefetching=true;}}/**\n   * Précharge les ressources critiques\n   * @private\n   */_prefetchCriticalResources(){// Liste des ressources critiques à précharger\nconst criticalResources=[// Ajouter ici les ressources critiques\n];// Ne pas précharger sur les connexions lentes\nif(this.deviceInfo.hasSlowConnection)return;criticalResources.forEach(resource=>{const link=document.createElement('link');link.rel='prefetch';link.href=resource;document.head.appendChild(link);});}/**\n   * Ajoute des indications de ressources (resource hints)\n   * @private\n   */_addResourceHints(){// Domaines à préconnecter\nconst domainsToPreconnect=['https://api.mapbox.com','https://api.openweathermap.org','https://api.openrouteservice.org'];domainsToPreconnect.forEach(domain=>{const link=document.createElement('link');link.rel='preconnect';link.href=domain;link.crossOrigin='anonymous';document.head.appendChild(link);});}/**\n   * Limite la fréquence des mises à jour de l'interface\n   * @private\n   */_throttleUIUpdates(){// Implémenter la limitation des mises à jour UI\n// Cette fonction serait utilisée par les composants via les hooks\n}/**\n   * Met en pause les opérations non essentielles\n   * @private\n   */_pauseNonEssentialOperations(){// Mettre en pause les animations\ndocument.documentElement.classList.add('pause-animations');// Arrêter les mises à jour non essentielles\nthis.isPaused=true;}/**\n   * Reprend les opérations\n   * @private\n   */_resumeOperations(){// Reprendre les animations\ndocument.documentElement.classList.remove('pause-animations');// Reprendre les mises à jour\nthis.isPaused=false;}/**\n   * Détermine le type de ressource à partir de l'URL\n   * @param {string} url - URL de la ressource\n   * @returns {string} Type de ressource\n   * @private\n   */_getResourceType(url){if(url.match(/\\.(jpg|jpeg|png|gif|webp|svg)(\\?|$)/i)){return'image';}else if(url.match(/\\.(js)(\\?|$)/i)){return'script';}else if(url.match(/\\.(css)(\\?|$)/i)){return'style';}else if(url.match(/\\.(woff|woff2|ttf|otf|eot)(\\?|$)/i)){return'font';}else if(url.match(/\\.(json)(\\?|$)/i)){return'json';}else{return'other';}}/**\n   * Obtient un rapport de performance\n   * @returns {Object} Rapport de performance\n   */getPerformanceReport(){// Calculer les métriques moyennes\nconst avgFPS=this.metrics.fpsHistory.length>0?this.metrics.fpsHistory.reduce((sum,entry)=>sum+entry.fps,0)/this.metrics.fpsHistory.length:0;const avgInteractionDelay=this.metrics.interactionDelays.length>0?this.metrics.interactionDelays.reduce((sum,entry)=>sum+entry.duration,0)/this.metrics.interactionDelays.length:0;// Préparer le rapport\nreturn{device:this.deviceInfo,metrics:{avgFPS,avgInteractionDelay,resourceLoadTimes:this.metrics.resourceLoadTimes,memoryUsage:this.metrics.memoryUsage.length>0?this.metrics.memoryUsage[this.metrics.memoryUsage.length-1]:null},optimizations:this.optimizations,recommendations:this._generateRecommendations()};}/**\n   * Génère des recommandations d'optimisation\n   * @returns {Array} Liste de recommandations\n   * @private\n   */_generateRecommendations(){const recommendations=[];// Vérifier les FPS\nconst recentFPS=this.metrics.fpsHistory.slice(-5);const avgRecentFPS=recentFPS.length>0?recentFPS.reduce((sum,entry)=>sum+entry.fps,0)/recentFPS.length:0;if(avgRecentFPS<30){recommendations.push({type:'critical',area:'performance',message:'FPS bas détecté, considérer la réduction des effets visuels'});}// Vérifier les délais d'interaction\nconst recentDelays=this.metrics.interactionDelays.slice(-5);const avgRecentDelay=recentDelays.length>0?recentDelays.reduce((sum,entry)=>sum+entry.duration,0)/recentDelays.length:0;if(avgRecentDelay>PERFORMANCE_THRESHOLDS.INTERACTION_DELAY){recommendations.push({type:'warning',area:'interactivity',message:'Délais d\\'interaction élevés, optimiser les gestionnaires d\\'événements'});}return recommendations;}}// Exporter une instance de l'optimiseur\nconst performanceOptimizer=new PerformanceOptimizer();export default performanceOptimizer;/**\n * Hook React pour utiliser l'optimiseur de performances\n * @param {Object} options - Options de configuration\n * @returns {Object} Informations sur l'appareil et méthodes d'optimisation\n */export function usePerformanceOptimizer(){let options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};const[isInitialized,setIsInitialized]=useState(false);useEffect(()=>{if(!isInitialized){performanceOptimizer.initialize(options);setIsInitialized(true);}},[options,isInitialized]);return{deviceInfo:performanceOptimizer.deviceInfo,getPerformanceReport:performanceOptimizer.getPerformanceReport.bind(performanceOptimizer),pauseNonEssentialOperations:performanceOptimizer._pauseNonEssentialOperations.bind(performanceOptimizer),resumeOperations:performanceOptimizer._resumeOperations.bind(performanceOptimizer)};}","map":{"version":3,"names":["useEffect","useState","useRef","PERFORMANCE_THRESHOLDS","INTERACTION_DELAY","LONG_TASK_THRESHOLD","IDLE_CALLBACK_TIMEOUT","RESOURCE_CACHE_MAX_AGE","IMAGE_LAZY_LOAD_OFFSET","PerformanceOptimizer","constructor","isEnabled","metrics","fpsHistory","resourceLoadTimes","interactionDelays","memoryUsage","observers","optimizations","lazyLoading","codeChunking","imageOptimization","caching","prefetching","resourceHints","deviceInfo","_detectDeviceCapabilities","initialized","initialize","options","arguments","length","undefined","console","log","_startMetricsCollection","_initializeObservers","_applyInitialOptimizations","info","isMobile","test","navigator","userAgent","isLowEndDevice","hasLimitedMemory","hasSlowConnection","supportsWebGL","supportsWebP","devicePixelRatio","window","screenSize","width","screen","height","connection","deviceMemory","type","effectiveType","downlink","rtt","saveData","canvas","document","createElement","WebGLRenderingContext","getContext","e","webpImage","Image","onload","onerror","src","requestAnimationFrame","lastTime","performance","now","frames","collectFPS","fps","Math","round","push","timestamp","shift","memory","setInterval","usedJSHeapSize","totalJSHeapSize","getEntriesByType","processResources","resources","forEach","resource","url","name","_getResourceType","duration","size","transferSize","startTime","clearResourceTimings","PerformanceObserver","observer","list","observe","entryTypes","addEventListener","start","passive","longTasks","getEntries","entry","warn","_adjustOptimizationsForLowPerformance","_adjustOptimizationsForConnection","visibilityState","_pauseNonEssentialOperations","_resumeOperations","_prefetchCriticalResources","_addResourceHints","documentElement","classList","add","_throttleUIUpdates","remove","criticalResources","link","rel","href","head","appendChild","domainsToPreconnect","domain","crossOrigin","isPaused","match","getPerformanceReport","avgFPS","reduce","sum","avgInteractionDelay","device","recommendations","_generateRecommendations","recentFPS","slice","avgRecentFPS","area","message","recentDelays","avgRecentDelay","performanceOptimizer","usePerformanceOptimizer","isInitialized","setIsInitialized","bind","pauseNonEssentialOperations","resumeOperations"],"sources":["C:/Users/busin/CascadeProjects/grand-est-cyclisme-website-final (1) VERSION FINAL/client/src/utils/PerformanceOptimizer.js"],"sourcesContent":["/**\n * Utilitaire d'optimisation des performances pour le site Grand Est Cyclisme\n * Implémente des techniques avancées pour améliorer les performances globales\n */\n\nimport { useEffect, useState, useRef } from 'react';\n\n// Constantes pour les seuils de performance\nconst PERFORMANCE_THRESHOLDS = {\n  INTERACTION_DELAY: 100, // ms\n  LONG_TASK_THRESHOLD: 50, // ms\n  IDLE_CALLBACK_TIMEOUT: 1000, // ms\n  RESOURCE_CACHE_MAX_AGE: 7 * 24 * 60 * 60 * 1000, // 7 jours\n  IMAGE_LAZY_LOAD_OFFSET: 200, // px\n};\n\n/**\n * Classe principale d'optimisation des performances\n */\nclass PerformanceOptimizer {\n  constructor() {\n    this.isEnabled = true;\n    this.metrics = {\n      fpsHistory: [],\n      resourceLoadTimes: {},\n      interactionDelays: [],\n      memoryUsage: [],\n    };\n    this.observers = {};\n    this.optimizations = {\n      lazyLoading: true,\n      codeChunking: true,\n      imageOptimization: true,\n      caching: true,\n      prefetching: true,\n      resourceHints: true,\n    };\n    this.deviceInfo = this._detectDeviceCapabilities();\n    this.initialized = false;\n  }\n\n  /**\n   * Initialise l'optimiseur de performances\n   * @param {Object} options - Options de configuration\n   */\n  initialize(options = {}) {\n    if (this.initialized) return;\n\n    console.log('Initialisation de l\\'optimiseur de performances...');\n    \n    // Fusionner les options avec les valeurs par défaut\n    this.optimizations = { ...this.optimizations, ...options };\n    \n    // Démarrer la collecte de métriques\n    this._startMetricsCollection();\n    \n    // Initialiser les observateurs\n    this._initializeObservers();\n    \n    // Appliquer les optimisations initiales\n    this._applyInitialOptimizations();\n    \n    this.initialized = true;\n    console.log('Optimiseur de performances initialisé avec succès');\n  }\n\n  /**\n   * Détecte les capacités de l'appareil\n   * @returns {Object} Informations sur l'appareil\n   * @private\n   */\n  _detectDeviceCapabilities() {\n    const info = {\n      isMobile: /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),\n      isLowEndDevice: false,\n      hasLimitedMemory: false,\n      hasSlowConnection: false,\n      supportsWebGL: false,\n      supportsWebP: false,\n      devicePixelRatio: window.devicePixelRatio || 1,\n      screenSize: {\n        width: window.screen.width,\n        height: window.screen.height,\n      },\n      connection: null,\n    };\n    \n    // Détecter les appareils à faibles ressources\n    if ('deviceMemory' in navigator) {\n      info.hasLimitedMemory = navigator.deviceMemory < 4; // Moins de 4GB de RAM\n    }\n    \n    // Détecter les connexions lentes\n    if ('connection' in navigator && navigator.connection) {\n      info.connection = {\n        type: navigator.connection.effectiveType,\n        downlink: navigator.connection.downlink,\n        rtt: navigator.connection.rtt,\n        saveData: navigator.connection.saveData,\n      };\n      \n      info.hasSlowConnection = \n        navigator.connection.effectiveType === 'slow-2g' || \n        navigator.connection.effectiveType === '2g' ||\n        navigator.connection.downlink < 1.0;\n    }\n    \n    // Vérifier le support WebGL\n    try {\n      const canvas = document.createElement('canvas');\n      info.supportsWebGL = !!(window.WebGLRenderingContext && \n        (canvas.getContext('webgl') || canvas.getContext('experimental-webgl')));\n    } catch (e) {\n      info.supportsWebGL = false;\n    }\n    \n    // Vérifier le support WebP\n    const webpImage = new Image();\n    webpImage.onload = function() {\n      info.supportsWebP = (webpImage.width > 0) && (webpImage.height > 0);\n    };\n    webpImage.onerror = function() {\n      info.supportsWebP = false;\n    };\n    webpImage.src = 'data:image/webp;base64,UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==';\n    \n    // Déterminer si c'est un appareil à faibles performances\n    info.isLowEndDevice = info.hasLimitedMemory || \n                          info.hasSlowConnection || \n                          info.isMobile && info.screenSize.width < 768;\n    \n    return info;\n  }\n\n  /**\n   * Démarre la collecte de métriques de performance\n   * @private\n   */\n  _startMetricsCollection() {\n    // Collecter les FPS\n    if (window.requestAnimationFrame) {\n      let lastTime = performance.now();\n      let frames = 0;\n      \n      const collectFPS = () => {\n        const now = performance.now();\n        frames++;\n        \n        if (now > lastTime + 1000) {\n          const fps = Math.round((frames * 1000) / (now - lastTime));\n          this.metrics.fpsHistory.push({\n            timestamp: now,\n            fps: fps\n          });\n          \n          // Limiter l'historique à 60 entrées (1 minute à 1 mesure/s)\n          if (this.metrics.fpsHistory.length > 60) {\n            this.metrics.fpsHistory.shift();\n          }\n          \n          frames = 0;\n          lastTime = now;\n        }\n        \n        window.requestAnimationFrame(collectFPS);\n      };\n      \n      window.requestAnimationFrame(collectFPS);\n    }\n    \n    // Surveiller l'utilisation de la mémoire\n    if (window.performance && window.performance.memory) {\n      setInterval(() => {\n        this.metrics.memoryUsage.push({\n          timestamp: performance.now(),\n          usedJSHeapSize: performance.memory.usedJSHeapSize,\n          totalJSHeapSize: performance.memory.totalJSHeapSize\n        });\n        \n        // Limiter l'historique à 60 entrées\n        if (this.metrics.memoryUsage.length > 60) {\n          this.metrics.memoryUsage.shift();\n        }\n      }, 10000); // Toutes les 10 secondes\n    }\n    \n    // Surveiller les temps de chargement des ressources\n    if (window.performance && window.performance.getEntriesByType) {\n      const processResources = () => {\n        const resources = performance.getEntriesByType('resource');\n        \n        resources.forEach(resource => {\n          const url = resource.name;\n          const type = this._getResourceType(url);\n          \n          if (!this.metrics.resourceLoadTimes[type]) {\n            this.metrics.resourceLoadTimes[type] = [];\n          }\n          \n          this.metrics.resourceLoadTimes[type].push({\n            url: url,\n            duration: resource.duration,\n            size: resource.transferSize || 0,\n            timestamp: resource.startTime\n          });\n        });\n        \n        // Effacer les entrées traitées\n        performance.clearResourceTimings();\n      };\n      \n      // Observer les nouvelles ressources\n      if (window.PerformanceObserver) {\n        const observer = new PerformanceObserver(list => {\n          processResources();\n        });\n        \n        observer.observe({ entryTypes: ['resource'] });\n      } else {\n        // Fallback pour les navigateurs sans PerformanceObserver\n        setInterval(processResources, 5000);\n      }\n    }\n    \n    // Surveiller les délais d'interaction\n    document.addEventListener('click', e => {\n      const start = performance.now();\n      \n      window.requestAnimationFrame(() => {\n        const duration = performance.now() - start;\n        \n        this.metrics.interactionDelays.push({\n          timestamp: start,\n          duration: duration,\n          type: 'click'\n        });\n        \n        // Limiter l'historique à 50 entrées\n        if (this.metrics.interactionDelays.length > 50) {\n          this.metrics.interactionDelays.shift();\n        }\n      });\n    }, { passive: true });\n  }\n\n  /**\n   * Initialise les observateurs pour surveiller les performances\n   * @private\n   */\n  _initializeObservers() {\n    // Observer les tâches longues\n    if (window.PerformanceObserver) {\n      try {\n        this.observers.longTasks = new PerformanceObserver(list => {\n          list.getEntries().forEach(entry => {\n            console.warn(`Tâche longue détectée: ${entry.duration}ms`, entry);\n            \n            // Si la tâche est très longue, ajuster automatiquement les optimisations\n            if (entry.duration > PERFORMANCE_THRESHOLDS.LONG_TASK_THRESHOLD * 2) {\n              this._adjustOptimizationsForLowPerformance();\n            }\n          });\n        });\n        \n        this.observers.longTasks.observe({ entryTypes: ['longtask'] });\n      } catch (e) {\n        console.log('PerformanceObserver pour longtask non supporté');\n      }\n    }\n    \n    // Observer les changements de connexion réseau\n    if (navigator.connection) {\n      navigator.connection.addEventListener('change', () => {\n        this.deviceInfo.connection = {\n          type: navigator.connection.effectiveType,\n          downlink: navigator.connection.downlink,\n          rtt: navigator.connection.rtt,\n          saveData: navigator.connection.saveData,\n        };\n        \n        this.deviceInfo.hasSlowConnection = \n          navigator.connection.effectiveType === 'slow-2g' || \n          navigator.connection.effectiveType === '2g' ||\n          navigator.connection.downlink < 1.0;\n        \n        // Ajuster les optimisations en fonction de la connexion\n        this._adjustOptimizationsForConnection();\n      });\n    }\n    \n    // Observer la visibilité de la page\n    document.addEventListener('visibilitychange', () => {\n      if (document.visibilityState === 'hidden') {\n        // La page est cachée, réduire les opérations\n        this._pauseNonEssentialOperations();\n      } else {\n        // La page est visible à nouveau, reprendre les opérations\n        this._resumeOperations();\n      }\n    });\n  }\n\n  /**\n   * Applique les optimisations initiales\n   * @private\n   */\n  _applyInitialOptimizations() {\n    // Optimisations basées sur les capacités de l'appareil\n    if (this.deviceInfo.isLowEndDevice) {\n      this._adjustOptimizationsForLowPerformance();\n    }\n    \n    // Optimisations basées sur la connexion\n    this._adjustOptimizationsForConnection();\n    \n    // Préchargement des ressources critiques\n    if (this.optimizations.prefetching) {\n      this._prefetchCriticalResources();\n    }\n    \n    // Indications de ressources\n    if (this.optimizations.resourceHints) {\n      this._addResourceHints();\n    }\n  }\n\n  /**\n   * Ajuste les optimisations pour les appareils à faibles performances\n   * @private\n   */\n  _adjustOptimizationsForLowPerformance() {\n    console.log('Ajustement des optimisations pour appareil à faibles performances');\n    \n    // Réduire la qualité des images\n    if (this.optimizations.imageOptimization) {\n      document.documentElement.classList.add('optimize-images');\n    }\n    \n    // Désactiver les animations non essentielles\n    document.documentElement.classList.add('reduce-animations');\n    \n    // Réduire la fréquence des mises à jour de l'interface\n    this._throttleUIUpdates();\n  }\n\n  /**\n   * Ajuste les optimisations en fonction de la connexion réseau\n   * @private\n   */\n  _adjustOptimizationsForConnection() {\n    if (!this.deviceInfo.connection) return;\n    \n    console.log(`Ajustement des optimisations pour connexion: ${this.deviceInfo.connection.type}`);\n    \n    if (this.deviceInfo.hasSlowConnection) {\n      // Activer le mode économie de données\n      document.documentElement.classList.add('data-saver');\n      \n      // Réduire la qualité des images\n      if (this.optimizations.imageOptimization) {\n        document.documentElement.classList.add('optimize-images');\n      }\n      \n      // Désactiver le préchargement\n      this.optimizations.prefetching = false;\n    } else {\n      // Connexion rapide, optimisations normales\n      document.documentElement.classList.remove('data-saver');\n      document.documentElement.classList.remove('optimize-images');\n      \n      // Réactiver le préchargement si désactivé\n      this.optimizations.prefetching = true;\n    }\n  }\n\n  /**\n   * Précharge les ressources critiques\n   * @private\n   */\n  _prefetchCriticalResources() {\n    // Liste des ressources critiques à précharger\n    const criticalResources = [\n      // Ajouter ici les ressources critiques\n    ];\n    \n    // Ne pas précharger sur les connexions lentes\n    if (this.deviceInfo.hasSlowConnection) return;\n    \n    criticalResources.forEach(resource => {\n      const link = document.createElement('link');\n      link.rel = 'prefetch';\n      link.href = resource;\n      document.head.appendChild(link);\n    });\n  }\n\n  /**\n   * Ajoute des indications de ressources (resource hints)\n   * @private\n   */\n  _addResourceHints() {\n    // Domaines à préconnecter\n    const domainsToPreconnect = [\n      'https://api.mapbox.com',\n      'https://api.openweathermap.org',\n      'https://api.openrouteservice.org'\n    ];\n    \n    domainsToPreconnect.forEach(domain => {\n      const link = document.createElement('link');\n      link.rel = 'preconnect';\n      link.href = domain;\n      link.crossOrigin = 'anonymous';\n      document.head.appendChild(link);\n    });\n  }\n\n  /**\n   * Limite la fréquence des mises à jour de l'interface\n   * @private\n   */\n  _throttleUIUpdates() {\n    // Implémenter la limitation des mises à jour UI\n    // Cette fonction serait utilisée par les composants via les hooks\n  }\n\n  /**\n   * Met en pause les opérations non essentielles\n   * @private\n   */\n  _pauseNonEssentialOperations() {\n    // Mettre en pause les animations\n    document.documentElement.classList.add('pause-animations');\n    \n    // Arrêter les mises à jour non essentielles\n    this.isPaused = true;\n  }\n\n  /**\n   * Reprend les opérations\n   * @private\n   */\n  _resumeOperations() {\n    // Reprendre les animations\n    document.documentElement.classList.remove('pause-animations');\n    \n    // Reprendre les mises à jour\n    this.isPaused = false;\n  }\n\n  /**\n   * Détermine le type de ressource à partir de l'URL\n   * @param {string} url - URL de la ressource\n   * @returns {string} Type de ressource\n   * @private\n   */\n  _getResourceType(url) {\n    if (url.match(/\\.(jpg|jpeg|png|gif|webp|svg)(\\?|$)/i)) {\n      return 'image';\n    } else if (url.match(/\\.(js)(\\?|$)/i)) {\n      return 'script';\n    } else if (url.match(/\\.(css)(\\?|$)/i)) {\n      return 'style';\n    } else if (url.match(/\\.(woff|woff2|ttf|otf|eot)(\\?|$)/i)) {\n      return 'font';\n    } else if (url.match(/\\.(json)(\\?|$)/i)) {\n      return 'json';\n    } else {\n      return 'other';\n    }\n  }\n\n  /**\n   * Obtient un rapport de performance\n   * @returns {Object} Rapport de performance\n   */\n  getPerformanceReport() {\n    // Calculer les métriques moyennes\n    const avgFPS = this.metrics.fpsHistory.length > 0 \n      ? this.metrics.fpsHistory.reduce((sum, entry) => sum + entry.fps, 0) / this.metrics.fpsHistory.length \n      : 0;\n    \n    const avgInteractionDelay = this.metrics.interactionDelays.length > 0 \n      ? this.metrics.interactionDelays.reduce((sum, entry) => sum + entry.duration, 0) / this.metrics.interactionDelays.length \n      : 0;\n    \n    // Préparer le rapport\n    return {\n      device: this.deviceInfo,\n      metrics: {\n        avgFPS,\n        avgInteractionDelay,\n        resourceLoadTimes: this.metrics.resourceLoadTimes,\n        memoryUsage: this.metrics.memoryUsage.length > 0 ? this.metrics.memoryUsage[this.metrics.memoryUsage.length - 1] : null\n      },\n      optimizations: this.optimizations,\n      recommendations: this._generateRecommendations()\n    };\n  }\n\n  /**\n   * Génère des recommandations d'optimisation\n   * @returns {Array} Liste de recommandations\n   * @private\n   */\n  _generateRecommendations() {\n    const recommendations = [];\n    \n    // Vérifier les FPS\n    const recentFPS = this.metrics.fpsHistory.slice(-5);\n    const avgRecentFPS = recentFPS.length > 0 \n      ? recentFPS.reduce((sum, entry) => sum + entry.fps, 0) / recentFPS.length \n      : 0;\n    \n    if (avgRecentFPS < 30) {\n      recommendations.push({\n        type: 'critical',\n        area: 'performance',\n        message: 'FPS bas détecté, considérer la réduction des effets visuels'\n      });\n    }\n    \n    // Vérifier les délais d'interaction\n    const recentDelays = this.metrics.interactionDelays.slice(-5);\n    const avgRecentDelay = recentDelays.length > 0 \n      ? recentDelays.reduce((sum, entry) => sum + entry.duration, 0) / recentDelays.length \n      : 0;\n    \n    if (avgRecentDelay > PERFORMANCE_THRESHOLDS.INTERACTION_DELAY) {\n      recommendations.push({\n        type: 'warning',\n        area: 'interactivity',\n        message: 'Délais d\\'interaction élevés, optimiser les gestionnaires d\\'événements'\n      });\n    }\n    \n    return recommendations;\n  }\n}\n\n// Exporter une instance de l'optimiseur\nconst performanceOptimizer = new PerformanceOptimizer();\nexport default performanceOptimizer;\n\n/**\n * Hook React pour utiliser l'optimiseur de performances\n * @param {Object} options - Options de configuration\n * @returns {Object} Informations sur l'appareil et méthodes d'optimisation\n */\nexport function usePerformanceOptimizer(options = {}) {\n  const [isInitialized, setIsInitialized] = useState(false);\n  \n  useEffect(() => {\n    if (!isInitialized) {\n      performanceOptimizer.initialize(options);\n      setIsInitialized(true);\n    }\n  }, [options, isInitialized]);\n  \n  return {\n    deviceInfo: performanceOptimizer.deviceInfo,\n    getPerformanceReport: performanceOptimizer.getPerformanceReport.bind(performanceOptimizer),\n    pauseNonEssentialOperations: performanceOptimizer._pauseNonEssentialOperations.bind(performanceOptimizer),\n    resumeOperations: performanceOptimizer._resumeOperations.bind(performanceOptimizer)\n  };\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}