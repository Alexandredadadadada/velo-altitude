{"ast":null,"code":"import React,{useEffect,useRef,useState}from'react';import{Box,Button,Typography,Slider,Paper,Grid,IconButton,Tooltip,CircularProgress}from'@mui/material';import{PlayArrow,Pause,ReplayOutlined,SlowMotionVideo,Speed,FlightTakeoff,FlightLand,CameraAlt,VolumeUp,VolumeOff,ZoomIn,ZoomOut,Fullscreen,FullscreenExit,TouchApp}from'@mui/icons-material';import*as THREE from'three';import{OrbitControls}from'three/examples/jsm/controls/OrbitControls';import{GPUComputationRenderer}from'three/examples/jsm/misc/GPUComputationRenderer';import styled from'styled-components';// Composant pour la fonctionnalité Fly-through des cols cyclistes\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ColFlyThrough=_ref=>{let{colId,colData,pointsOfInterest,elevationData,isMobile}=_ref;// Références\nconst containerRef=useRef(null);const sceneRef=useRef(null);const cameraRef=useRef(null);const rendererRef=useRef(null);const controlsRef=useRef(null);const pathRef=useRef(null);const flyThroughRef=useRef(null);const statsRef=useRef(null);// État\nconst[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[isPlaying,setIsPlaying]=useState(false);const[progress,setProgress]=useState(0);const[speed,setSpeed]=useState(1);const[isMuted,setIsMuted]=useState(true);const[isFullscreen,setIsFullscreen]=useState(false);const[currentElevation,setCurrentElevation]=useState(0);const[currentGradient,setCurrentGradient]=useState(0);const[currentDistance,setCurrentDistance]=useState(0);const[showControls,setShowControls]=useState(true);const[cameraMode,setCameraMode]=useState('follow');// 'follow', 'orbit', 'cinematic'\nconst[totalDistance,setTotalDistance]=useState(0);// Initialisation de la scène Three.js\nuseEffect(()=>{if(!containerRef.current||!colData||colData.length===0)return;const container=containerRef.current;const width=container.clientWidth;const height=container.clientHeight;// Initialiser la scène\nconst scene=new THREE.Scene();scene.background=new THREE.Color(0x87ceeb);// Ciel bleu\nscene.fog=new THREE.FogExp2(0x87ceeb,0.002);sceneRef.current=scene;// Initialiser la caméra\nconst camera=new THREE.PerspectiveCamera(75,width/height,0.1,10000);camera.position.set(0,50,200);cameraRef.current=camera;// Initialiser le renderer\nconst renderer=new THREE.WebGLRenderer({antialias:true});renderer.setSize(width,height);renderer.setPixelRatio(window.devicePixelRatio);renderer.shadowMap.enabled=true;container.appendChild(renderer.domElement);rendererRef.current=renderer;// Contrôles pour la visualisation interactive\nconst controls=new OrbitControls(camera,renderer.domElement);controls.enableDamping=true;controls.dampingFactor=0.05;controls.maxPolarAngle=Math.PI/2;controls.enabled=false;// Désactivé par défaut, activé en mode 'orbit'\ncontrolsRef.current=controls;// Éclairage\nconst ambientLight=new THREE.AmbientLight(0xffffff,0.6);scene.add(ambientLight);const directionalLight=new THREE.DirectionalLight(0xffffff,0.8);directionalLight.position.set(100,100,50);directionalLight.castShadow=true;directionalLight.shadow.mapSize.width=1024;directionalLight.shadow.mapSize.height=1024;scene.add(directionalLight);// Créer le terrain basé sur les données du col\nconst createTerrain=()=>{// Créer le groupe pour le terrain\nconst terrainGroup=new THREE.Group();scene.add(terrainGroup);// Créer la route\nconst createPath=()=>{// Convertir les coordonnées du col en points 3D\nconst points=colData.map(point=>{return new THREE.Vector3(point.x*10,// Échelle pour visualisation\npoint.elevation,point.y*10);});// Calculer la distance totale\nlet distance=0;for(let i=1;i<points.length;i++){distance+=points[i].distanceTo(points[i-1]);}setTotalDistance(distance/10);// En kilomètres\n// Créer la courbe du chemin\nconst curve=new THREE.CatmullRomCurve3(points);pathRef.current=curve;// Créer la géométrie de la route\nconst pathGeometry=new THREE.TubeGeometry(curve,200,2,8,false);const pathMaterial=new THREE.MeshStandardMaterial({color:0x333333,roughness:0.8,metalness:0.2});const pathMesh=new THREE.Mesh(pathGeometry,pathMaterial);pathMesh.receiveShadow=true;terrainGroup.add(pathMesh);return curve;};// Créer le terrain autour de la route\nconst createTerrainMesh=path=>{// Créer une géométrie de terrain plus large\nconst terrainWidth=1000;const terrainDepth=1000;const terrainSegments=100;const terrainGeometry=new THREE.PlaneGeometry(terrainWidth,terrainDepth,terrainSegments,terrainSegments);// Déformer le terrain en fonction du chemin\nconst vertices=terrainGeometry.attributes.position.array;for(let i=0;i<vertices.length;i+=3){const x=vertices[i];const z=vertices[i+2];// Trouver le point le plus proche sur le chemin\nlet minDistance=Infinity;let elevation=0;// Échantillonner le chemin\nfor(let t=0;t<=1;t+=0.01){const pathPoint=path.getPoint(t);const distance=new THREE.Vector2(x-pathPoint.x,z-pathPoint.z).length();if(distance<minDistance){minDistance=distance;elevation=pathPoint.y;}}// Appliquer l'élévation avec un facteur de lissage basé sur la distance\nconst smoothFactor=Math.min(1,minDistance/50);vertices[i+1]=elevation*(1-smoothFactor)+(elevation-50)*smoothFactor;}// Recalculer les normales pour un éclairage correct\nterrainGeometry.computeVertexNormals();// Rotation pour orienter le terrain correctement\nterrainGeometry.rotateX(-Math.PI/2);// Matériau du terrain avec dégradé en fonction de l'élévation\nconst terrainMaterial=new THREE.MeshStandardMaterial({vertexColors:true,roughness:0.8,metalness:0.2});// Ajouter des couleurs en fonction de l'élévation\nconst colors=[];const color=new THREE.Color();for(let i=0;i<vertices.length;i+=3){const elevation=vertices[i+1];// Palette de couleurs pour le terrain\nif(elevation<200){color.setRGB(0.2,0.5,0.2);// Vert foncé\n}else if(elevation<500){color.setRGB(0.4,0.6,0.3);// Vert\n}else if(elevation<1000){color.setRGB(0.6,0.6,0.4);// Vert-brun\n}else if(elevation<1500){color.setRGB(0.7,0.7,0.6);// Brun clair\n}else if(elevation<2000){color.setRGB(0.8,0.8,0.8);// Gris\n}else{color.setRGB(1,1,1);// Blanc (neige)\n}colors.push(color.r,color.g,color.b);}const colorAttribute=new THREE.Float32BufferAttribute(colors,3);terrainGeometry.setAttribute('color',colorAttribute);const terrainMesh=new THREE.Mesh(terrainGeometry,terrainMaterial);terrainMesh.receiveShadow=true;terrainGroup.add(terrainMesh);};// Ajouter les points d'intérêt\nconst addPointsOfInterest=path=>{if(!pointsOfInterest||pointsOfInterest.length===0)return;pointsOfInterest.forEach(poi=>{// Trouver la position sur le chemin\nconst position=path.getPoint(poi.position/totalDistance);// Créer un marqueur\nconst markerGeometry=new THREE.SphereGeometry(3,16,16);// Couleur en fonction du type de POI\nlet markerColor=0xff0000;if(poi.type==='viewpoint'){markerColor=0x00ff00;}else if(poi.type==='rest'){markerColor=0x0000ff;}else if(poi.type==='summit'){markerColor=0xff9900;}const markerMaterial=new THREE.MeshStandardMaterial({color:markerColor,emissive:markerColor,emissiveIntensity:0.3});const marker=new THREE.Mesh(markerGeometry,markerMaterial);marker.position.copy(position);marker.position.y+=5;// Légèrement au-dessus du terrain\nmarker.castShadow=true;// Ajouter un texte flottant\nconst canvas=document.createElement('canvas');const context=canvas.getContext('2d');canvas.width=256;canvas.height=128;context.fillStyle='#ffffff';context.fillRect(0,0,canvas.width,canvas.height);context.fillStyle='#000000';context.font='Bold 20px Arial';context.fillText(poi.name,10,64);const texture=new THREE.CanvasTexture(canvas);const labelMaterial=new THREE.SpriteMaterial({map:texture});const label=new THREE.Sprite(labelMaterial);label.position.copy(marker.position);label.position.y+=10;label.scale.set(20,10,1);terrainGroup.add(marker);terrainGroup.add(label);});};// Créer les éléments du terrain\nconst path=createPath();createTerrainMesh(path);addPointsOfInterest(path);return{path,terrainGroup};};// Initialiser les éléments du terrain\nconst{path}=createTerrain();// Fonction d'animation\nconst flyThroughAnimation={animationId:null,isPlaying:false,progress:0,speed:1,start:function(){this.isPlaying=true;setIsPlaying(true);this.animate();},pause:function(){this.isPlaying=false;setIsPlaying(false);if(this.animationId){cancelAnimationFrame(this.animationId);}},reset:function(){this.progress=0;setProgress(0);this.updateCamera();},setProgress:function(value){this.progress=Math.max(0,Math.min(1,value));setProgress(value);this.updateCamera();},setSpeed:function(value){this.speed=value;setSpeed(value);},updateCamera:function(){if(!path)return;// Obtenir la position actuelle sur le chemin\nconst pathPoint=path.getPoint(this.progress);// Calculer la direction (tangente)\nconst tangent=path.getTangent(this.progress);// Position de la caméra en fonction du mode\nif(cameraMode==='follow'){// Mode suivi : caméra derrière le point actuel\ncamera.position.set(pathPoint.x-tangent.x*10,pathPoint.y+5,// Un peu au-dessus du chemin\npathPoint.z-tangent.z*10);// Regarder vers l'avant sur le chemin\nconst lookAtPoint=new THREE.Vector3(pathPoint.x+tangent.x*20,pathPoint.y+1,pathPoint.z+tangent.z*20);camera.lookAt(lookAtPoint);}else if(cameraMode==='cinematic'){// Mode cinématique : caméra qui suit avec un angle\nconst angle=this.progress*Math.PI*4;// Rotation autour du chemin\nconst radius=20;camera.position.set(pathPoint.x+Math.cos(angle)*radius,pathPoint.y+10,pathPoint.z+Math.sin(angle)*radius);camera.lookAt(pathPoint);}// Mettre à jour les statistiques\nif(elevationData&&elevationData.length>0){const index=Math.floor(this.progress*(elevationData.length-1));const data=elevationData[index];if(data){setCurrentElevation(data.elevation);setCurrentGradient(data.gradient);setCurrentDistance(data.distance);}}},animate:function(){if(!this.isPlaying)return;// Mettre à jour la progression\nconst progressIncrement=0.0001*this.speed;this.progress+=progressIncrement;// Boucler ou arrêter à la fin\nif(this.progress>=1){this.progress=0;}setProgress(this.progress);this.updateCamera();// Continuer l'animation\nthis.animationId=requestAnimationFrame(()=>this.animate());}};flyThroughRef.current=flyThroughAnimation;// Initialiser la position de la caméra\nflyThroughAnimation.updateCamera();// Gestionnaire de redimensionnement\nconst handleResize=()=>{const width=container.clientWidth;const height=container.clientHeight;camera.aspect=width/height;camera.updateProjectionMatrix();renderer.setSize(width,height);};window.addEventListener('resize',handleResize);// Fonction d'animation générale (incluant OrbitControls)\nconst animate=()=>{requestAnimationFrame(animate);if(controlsRef.current){controlsRef.current.update();}renderer.render(scene,camera);};animate();// Signal que le chargement est terminé\nsetLoading(false);// Nettoyage\nreturn()=>{window.removeEventListener('resize',handleResize);if(flyThroughRef.current&&flyThroughRef.current.animationId){cancelAnimationFrame(flyThroughRef.current.animationId);}if(rendererRef.current&&container.contains(rendererRef.current.domElement)){container.removeChild(rendererRef.current.domElement);}if(controlsRef.current){controlsRef.current.dispose();}};},[colData,pointsOfInterest,cameraMode,elevationData]);// Gestion des interactions utilisateur\nconst handlePlayPause=()=>{if(flyThroughRef.current){if(isPlaying){flyThroughRef.current.pause();}else{flyThroughRef.current.start();}}};const handleReset=()=>{if(flyThroughRef.current){flyThroughRef.current.reset();}};const handleProgressChange=(event,newValue)=>{if(flyThroughRef.current){flyThroughRef.current.setProgress(newValue);}};const handleSpeedChange=(event,newValue)=>{if(flyThroughRef.current){flyThroughRef.current.setSpeed(newValue);}};const handleMuteToggle=()=>{setIsMuted(!isMuted);};const handleFullscreenToggle=()=>{if(!containerRef.current)return;if(!isFullscreen){if(containerRef.current.requestFullscreen){containerRef.current.requestFullscreen();}}else{if(document.exitFullscreen){document.exitFullscreen();}}setIsFullscreen(!isFullscreen);};const handleCameraModeChange=mode=>{setCameraMode(mode);if(controlsRef.current){controlsRef.current.enabled=mode==='orbit';}};// Écouteur pour les changements de plein écran\nuseEffect(()=>{const handleFullscreenChange=()=>{setIsFullscreen(!!document.fullscreenElement);};document.addEventListener('fullscreenchange',handleFullscreenChange);return()=>{document.removeEventListener('fullscreenchange',handleFullscreenChange);};},[]);// Afficher un indicateur de chargement\nif(loading){return/*#__PURE__*/_jsxs(Box,{display:\"flex\",flexDirection:\"column\",justifyContent:\"center\",alignItems:\"center\",height:\"100%\",sx:{backgroundColor:'rgba(0, 0, 0, 0.03)'},children:[/*#__PURE__*/_jsx(CircularProgress,{size:40}),/*#__PURE__*/_jsx(Typography,{variant:\"subtitle1\",sx:{mt:2},children:\"Pr\\xE9paration du Fly-through...\"})]});}// Afficher un message d'erreur\nif(error){return/*#__PURE__*/_jsx(Box,{display:\"flex\",justifyContent:\"center\",alignItems:\"center\",height:\"100%\",sx:{backgroundColor:'rgba(0, 0, 0, 0.03)'},children:/*#__PURE__*/_jsx(Typography,{color:\"error\",role:\"alert\",children:error})});}return/*#__PURE__*/_jsxs(Box,{sx:{position:'relative',height:'100%',overflow:'hidden',borderRadius:'8px',boxShadow:3},ref:containerRef,onMouseMove:()=>setShowControls(true),onMouseLeave:()=>setTimeout(()=>setShowControls(false),3000),onTouchStart:()=>setShowControls(true),onTouchEnd:()=>setTimeout(()=>setShowControls(false),3000),children:[/*#__PURE__*/_jsxs(StatsOverlay,{show:showControls||isMobile,ref:statsRef,isMobile:isMobile,children:[/*#__PURE__*/_jsxs(Typography,{variant:isMobile?'caption':'body2',children:[\"Altitude: \",/*#__PURE__*/_jsxs(\"strong\",{children:[currentElevation.toFixed(0),\" m\"]})]}),/*#__PURE__*/_jsxs(Typography,{variant:isMobile?'caption':'body2',children:[\"Pente: \",/*#__PURE__*/_jsxs(\"strong\",{children:[currentGradient.toFixed(1),\"%\"]})]}),/*#__PURE__*/_jsxs(Typography,{variant:isMobile?'caption':'body2',children:[\"Distance: \",/*#__PURE__*/_jsxs(\"strong\",{children:[currentDistance.toFixed(1),\" / \",totalDistance.toFixed(1),\" km\"]})]})]}),/*#__PURE__*/_jsxs(ControlsOverlay,{show:showControls||isMobile,isMobile:isMobile,children:[/*#__PURE__*/_jsxs(ControlButtonsGroup,{children:[/*#__PURE__*/_jsx(Tooltip,{title:isPlaying?\"Pause\":\"Lecture\",children:/*#__PURE__*/_jsx(IconButton,{onClick:handlePlayPause,color:\"primary\",size:isMobile?\"small\":\"medium\",children:isPlaying?/*#__PURE__*/_jsx(Pause,{}):/*#__PURE__*/_jsx(PlayArrow,{})})}),/*#__PURE__*/_jsx(Tooltip,{title:\"Recommencer\",children:/*#__PURE__*/_jsx(IconButton,{onClick:handleReset,color:\"primary\",size:isMobile?\"small\":\"medium\",children:/*#__PURE__*/_jsx(ReplayOutlined,{})})}),/*#__PURE__*/_jsx(Box,{sx:{width:isMobile?100:150,mx:1},children:/*#__PURE__*/_jsx(Slider,{value:progress,onChange:handleProgressChange,min:0,max:1,step:0.001,\"aria-label\":\"Progression\",size:isMobile?\"small\":\"medium\"})}),/*#__PURE__*/_jsx(Tooltip,{title:isMuted?\"Activer le son\":\"Couper le son\",children:/*#__PURE__*/_jsx(IconButton,{onClick:handleMuteToggle,color:\"primary\",size:isMobile?\"small\":\"medium\",children:isMuted?/*#__PURE__*/_jsx(VolumeOff,{}):/*#__PURE__*/_jsx(VolumeUp,{})})}),/*#__PURE__*/_jsx(Tooltip,{title:isFullscreen?\"Quitter le plein écran\":\"Plein écran\",children:/*#__PURE__*/_jsx(IconButton,{onClick:handleFullscreenToggle,color:\"primary\",size:isMobile?\"small\":\"medium\",children:isFullscreen?/*#__PURE__*/_jsx(FullscreenExit,{}):/*#__PURE__*/_jsx(Fullscreen,{})})})]}),/*#__PURE__*/_jsxs(AdvancedControlsGroup,{children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',mr:2},children:[/*#__PURE__*/_jsx(Typography,{variant:isMobile?'caption':'body2',sx:{mr:1},children:\"Vitesse:\"}),/*#__PURE__*/_jsx(Box,{sx:{width:isMobile?80:100},children:/*#__PURE__*/_jsx(Slider,{value:speed,onChange:handleSpeedChange,min:0.5,max:3,step:0.5,marks:[{value:0.5,label:isMobile?'':'0.5x'},{value:1,label:isMobile?'':'1x'},{value:2,label:isMobile?'':'2x'},{value:3,label:isMobile?'':'3x'}],\"aria-label\":\"Vitesse\",size:\"small\"})})]}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center'},children:[/*#__PURE__*/_jsx(Typography,{variant:isMobile?'caption':'body2',sx:{mr:1},children:\"Cam\\xE9ra:\"}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex'},children:[/*#__PURE__*/_jsx(Tooltip,{title:\"Suivre le parcours\",children:/*#__PURE__*/_jsx(IconButton,{onClick:()=>handleCameraModeChange('follow'),color:cameraMode==='follow'?\"primary\":\"default\",size:\"small\",children:/*#__PURE__*/_jsx(FlightTakeoff,{})})}),/*#__PURE__*/_jsx(Tooltip,{title:\"Cam\\xE9ra libre\",children:/*#__PURE__*/_jsx(IconButton,{onClick:()=>handleCameraModeChange('orbit'),color:cameraMode==='orbit'?\"primary\":\"default\",size:\"small\",children:/*#__PURE__*/_jsx(CameraAlt,{})})}),/*#__PURE__*/_jsx(Tooltip,{title:\"Vue cin\\xE9matique\",children:/*#__PURE__*/_jsx(IconButton,{onClick:()=>handleCameraModeChange('cinematic'),color:cameraMode==='cinematic'?\"primary\":\"default\",size:\"small\",children:/*#__PURE__*/_jsx(SlowMotionVideo,{})})})]})]})]})]}),isMobile&&/*#__PURE__*/_jsxs(TouchIndicator,{children:[/*#__PURE__*/_jsx(TouchApp,{}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",children:\"Touchez pour afficher les contr\\xF4les\"})]})]});};// Composants stylisés\nconst StatsOverlay=styled(Box)`\n  position: absolute;\n  top: 10px;\n  left: 10px;\n  background-color: rgba(255, 255, 255, 0.8);\n  padding: 8px 12px;\n  border-radius: 8px;\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n  transition: opacity 0.3s ease-in-out;\n  opacity: ${props=>props.show?1:0};\n  pointer-events: ${props=>props.show?'auto':'none'};\n  z-index: 10;\n  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);\n  font-size: ${props=>props.isMobile?'0.75rem':'0.875rem'};\n`;const ControlsOverlay=styled(Box)`\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  background-color: rgba(255, 255, 255, 0.9);\n  padding: ${props=>props.isMobile?'8px':'12px'};\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n  transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;\n  opacity: ${props=>props.show?1:0};\n  transform: translateY(${props=>props.show?'0':'100%'});\n  pointer-events: ${props=>props.show?'auto':'none'};\n  z-index: 10;\n  box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.1);\n`;const ControlButtonsGroup=styled(Box)`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n`;const AdvancedControlsGroup=styled(Box)`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-wrap: wrap;\n  padding-top: 4px;\n  border-top: 1px solid rgba(0, 0, 0, 0.1);\n`;const TouchIndicator=styled(Box)`\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  color: rgba(255, 255, 255, 0.8);\n  opacity: 0.7;\n  pointer-events: none;\n  \n  & > .MuiSvgIcon-root {\n    font-size: 3rem;\n    animation: pulse 2s infinite;\n  }\n  \n  @keyframes pulse {\n    0% {\n      opacity: 0.7;\n      transform: scale(1);\n    }\n    50% {\n      opacity: 1;\n      transform: scale(1.1);\n    }\n    100% {\n      opacity: 0.7;\n      transform: scale(1);\n    }\n  }\n`;export default/*#__PURE__*/React.memo(ColFlyThrough);","map":{"version":3,"names":["React","useEffect","useRef","useState","Box","Button","Typography","Slider","Paper","Grid","IconButton","Tooltip","CircularProgress","PlayArrow","Pause","ReplayOutlined","SlowMotionVideo","Speed","FlightTakeoff","FlightLand","CameraAlt","VolumeUp","VolumeOff","ZoomIn","ZoomOut","Fullscreen","FullscreenExit","TouchApp","THREE","OrbitControls","GPUComputationRenderer","styled","jsx","_jsx","jsxs","_jsxs","ColFlyThrough","_ref","colId","colData","pointsOfInterest","elevationData","isMobile","containerRef","sceneRef","cameraRef","rendererRef","controlsRef","pathRef","flyThroughRef","statsRef","loading","setLoading","error","setError","isPlaying","setIsPlaying","progress","setProgress","speed","setSpeed","isMuted","setIsMuted","isFullscreen","setIsFullscreen","currentElevation","setCurrentElevation","currentGradient","setCurrentGradient","currentDistance","setCurrentDistance","showControls","setShowControls","cameraMode","setCameraMode","totalDistance","setTotalDistance","current","length","container","width","clientWidth","height","clientHeight","scene","Scene","background","Color","fog","FogExp2","camera","PerspectiveCamera","position","set","renderer","WebGLRenderer","antialias","setSize","setPixelRatio","window","devicePixelRatio","shadowMap","enabled","appendChild","domElement","controls","enableDamping","dampingFactor","maxPolarAngle","Math","PI","ambientLight","AmbientLight","add","directionalLight","DirectionalLight","castShadow","shadow","mapSize","createTerrain","terrainGroup","Group","createPath","points","map","point","Vector3","x","elevation","y","distance","i","distanceTo","curve","CatmullRomCurve3","pathGeometry","TubeGeometry","pathMaterial","MeshStandardMaterial","color","roughness","metalness","pathMesh","Mesh","receiveShadow","createTerrainMesh","path","terrainWidth","terrainDepth","terrainSegments","terrainGeometry","PlaneGeometry","vertices","attributes","array","z","minDistance","Infinity","t","pathPoint","getPoint","Vector2","smoothFactor","min","computeVertexNormals","rotateX","terrainMaterial","vertexColors","colors","setRGB","push","r","g","b","colorAttribute","Float32BufferAttribute","setAttribute","terrainMesh","addPointsOfInterest","forEach","poi","markerGeometry","SphereGeometry","markerColor","type","markerMaterial","emissive","emissiveIntensity","marker","copy","canvas","document","createElement","context","getContext","fillStyle","fillRect","font","fillText","name","texture","CanvasTexture","labelMaterial","SpriteMaterial","label","Sprite","scale","flyThroughAnimation","animationId","start","animate","pause","cancelAnimationFrame","reset","updateCamera","value","max","tangent","getTangent","lookAtPoint","lookAt","angle","radius","cos","sin","index","floor","data","gradient","progressIncrement","requestAnimationFrame","handleResize","aspect","updateProjectionMatrix","addEventListener","update","render","removeEventListener","contains","removeChild","dispose","handlePlayPause","handleReset","handleProgressChange","event","newValue","handleSpeedChange","handleMuteToggle","handleFullscreenToggle","requestFullscreen","exitFullscreen","handleCameraModeChange","mode","handleFullscreenChange","fullscreenElement","display","flexDirection","justifyContent","alignItems","sx","backgroundColor","children","size","variant","mt","role","overflow","borderRadius","boxShadow","ref","onMouseMove","onMouseLeave","setTimeout","onTouchStart","onTouchEnd","StatsOverlay","show","toFixed","ControlsOverlay","ControlButtonsGroup","title","onClick","mx","onChange","step","AdvancedControlsGroup","mr","marks","TouchIndicator","props","memo"],"sources":["C:/Users/busin/CascadeProjects/grand-est-cyclisme-website-final (1) VERSION FINAL/client/src/components/cols/ColFlyThrough.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\nimport { Box, Button, Typography, Slider, Paper, Grid, IconButton, Tooltip, CircularProgress } from '@mui/material';\nimport { \n  PlayArrow, Pause, ReplayOutlined, \n  SlowMotionVideo, Speed, FlightTakeoff,\n  FlightLand, CameraAlt, VolumeUp, VolumeOff,\n  ZoomIn, ZoomOut, Fullscreen, FullscreenExit,\n  TouchApp\n} from '@mui/icons-material';\nimport * as THREE from 'three';\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls';\nimport { GPUComputationRenderer } from 'three/examples/jsm/misc/GPUComputationRenderer';\nimport styled from 'styled-components';\n\n// Composant pour la fonctionnalité Fly-through des cols cyclistes\nconst ColFlyThrough = ({ \n  colId, \n  colData, \n  pointsOfInterest, \n  elevationData, \n  isMobile \n}) => {\n  // Références\n  const containerRef = useRef(null);\n  const sceneRef = useRef(null);\n  const cameraRef = useRef(null);\n  const rendererRef = useRef(null);\n  const controlsRef = useRef(null);\n  const pathRef = useRef(null);\n  const flyThroughRef = useRef(null);\n  const statsRef = useRef(null);\n  \n  // État\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [progress, setProgress] = useState(0);\n  const [speed, setSpeed] = useState(1);\n  const [isMuted, setIsMuted] = useState(true);\n  const [isFullscreen, setIsFullscreen] = useState(false);\n  const [currentElevation, setCurrentElevation] = useState(0);\n  const [currentGradient, setCurrentGradient] = useState(0);\n  const [currentDistance, setCurrentDistance] = useState(0);\n  const [showControls, setShowControls] = useState(true);\n  const [cameraMode, setCameraMode] = useState('follow'); // 'follow', 'orbit', 'cinematic'\n  const [totalDistance, setTotalDistance] = useState(0);\n  \n  // Initialisation de la scène Three.js\n  useEffect(() => {\n    if (!containerRef.current || !colData || colData.length === 0) return;\n    \n    const container = containerRef.current;\n    const width = container.clientWidth;\n    const height = container.clientHeight;\n    \n    // Initialiser la scène\n    const scene = new THREE.Scene();\n    scene.background = new THREE.Color(0x87ceeb); // Ciel bleu\n    scene.fog = new THREE.FogExp2(0x87ceeb, 0.002);\n    sceneRef.current = scene;\n    \n    // Initialiser la caméra\n    const camera = new THREE.PerspectiveCamera(75, width / height, 0.1, 10000);\n    camera.position.set(0, 50, 200);\n    cameraRef.current = camera;\n    \n    // Initialiser le renderer\n    const renderer = new THREE.WebGLRenderer({ antialias: true });\n    renderer.setSize(width, height);\n    renderer.setPixelRatio(window.devicePixelRatio);\n    renderer.shadowMap.enabled = true;\n    container.appendChild(renderer.domElement);\n    rendererRef.current = renderer;\n    \n    // Contrôles pour la visualisation interactive\n    const controls = new OrbitControls(camera, renderer.domElement);\n    controls.enableDamping = true;\n    controls.dampingFactor = 0.05;\n    controls.maxPolarAngle = Math.PI / 2;\n    controls.enabled = false; // Désactivé par défaut, activé en mode 'orbit'\n    controlsRef.current = controls;\n    \n    // Éclairage\n    const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);\n    scene.add(ambientLight);\n    \n    const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);\n    directionalLight.position.set(100, 100, 50);\n    directionalLight.castShadow = true;\n    directionalLight.shadow.mapSize.width = 1024;\n    directionalLight.shadow.mapSize.height = 1024;\n    scene.add(directionalLight);\n    \n    // Créer le terrain basé sur les données du col\n    const createTerrain = () => {\n      // Créer le groupe pour le terrain\n      const terrainGroup = new THREE.Group();\n      scene.add(terrainGroup);\n      \n      // Créer la route\n      const createPath = () => {\n        // Convertir les coordonnées du col en points 3D\n        const points = colData.map(point => {\n          return new THREE.Vector3(\n            point.x * 10, // Échelle pour visualisation\n            point.elevation,\n            point.y * 10\n          );\n        });\n        \n        // Calculer la distance totale\n        let distance = 0;\n        for (let i = 1; i < points.length; i++) {\n          distance += points[i].distanceTo(points[i - 1]);\n        }\n        setTotalDistance(distance / 10); // En kilomètres\n        \n        // Créer la courbe du chemin\n        const curve = new THREE.CatmullRomCurve3(points);\n        pathRef.current = curve;\n        \n        // Créer la géométrie de la route\n        const pathGeometry = new THREE.TubeGeometry(curve, 200, 2, 8, false);\n        const pathMaterial = new THREE.MeshStandardMaterial({ \n          color: 0x333333,\n          roughness: 0.8,\n          metalness: 0.2\n        });\n        const pathMesh = new THREE.Mesh(pathGeometry, pathMaterial);\n        pathMesh.receiveShadow = true;\n        terrainGroup.add(pathMesh);\n        \n        return curve;\n      };\n      \n      // Créer le terrain autour de la route\n      const createTerrainMesh = (path) => {\n        // Créer une géométrie de terrain plus large\n        const terrainWidth = 1000;\n        const terrainDepth = 1000;\n        const terrainSegments = 100;\n        \n        const terrainGeometry = new THREE.PlaneGeometry(\n          terrainWidth, \n          terrainDepth, \n          terrainSegments,\n          terrainSegments\n        );\n        \n        // Déformer le terrain en fonction du chemin\n        const vertices = terrainGeometry.attributes.position.array;\n        \n        for (let i = 0; i < vertices.length; i += 3) {\n          const x = vertices[i];\n          const z = vertices[i + 2];\n          \n          // Trouver le point le plus proche sur le chemin\n          let minDistance = Infinity;\n          let elevation = 0;\n          \n          // Échantillonner le chemin\n          for (let t = 0; t <= 1; t += 0.01) {\n            const pathPoint = path.getPoint(t);\n            const distance = new THREE.Vector2(x - pathPoint.x, z - pathPoint.z).length();\n            \n            if (distance < minDistance) {\n              minDistance = distance;\n              elevation = pathPoint.y;\n            }\n          }\n          \n          // Appliquer l'élévation avec un facteur de lissage basé sur la distance\n          const smoothFactor = Math.min(1, minDistance / 50);\n          vertices[i + 1] = elevation * (1 - smoothFactor) + (elevation - 50) * smoothFactor;\n        }\n        \n        // Recalculer les normales pour un éclairage correct\n        terrainGeometry.computeVertexNormals();\n        \n        // Rotation pour orienter le terrain correctement\n        terrainGeometry.rotateX(-Math.PI / 2);\n        \n        // Matériau du terrain avec dégradé en fonction de l'élévation\n        const terrainMaterial = new THREE.MeshStandardMaterial({\n          vertexColors: true,\n          roughness: 0.8,\n          metalness: 0.2\n        });\n        \n        // Ajouter des couleurs en fonction de l'élévation\n        const colors = [];\n        const color = new THREE.Color();\n        \n        for (let i = 0; i < vertices.length; i += 3) {\n          const elevation = vertices[i + 1];\n          \n          // Palette de couleurs pour le terrain\n          if (elevation < 200) {\n            color.setRGB(0.2, 0.5, 0.2); // Vert foncé\n          } else if (elevation < 500) {\n            color.setRGB(0.4, 0.6, 0.3); // Vert\n          } else if (elevation < 1000) {\n            color.setRGB(0.6, 0.6, 0.4); // Vert-brun\n          } else if (elevation < 1500) {\n            color.setRGB(0.7, 0.7, 0.6); // Brun clair\n          } else if (elevation < 2000) {\n            color.setRGB(0.8, 0.8, 0.8); // Gris\n          } else {\n            color.setRGB(1, 1, 1); // Blanc (neige)\n          }\n          \n          colors.push(color.r, color.g, color.b);\n        }\n        \n        const colorAttribute = new THREE.Float32BufferAttribute(colors, 3);\n        terrainGeometry.setAttribute('color', colorAttribute);\n        \n        const terrainMesh = new THREE.Mesh(terrainGeometry, terrainMaterial);\n        terrainMesh.receiveShadow = true;\n        terrainGroup.add(terrainMesh);\n      };\n      \n      // Ajouter les points d'intérêt\n      const addPointsOfInterest = (path) => {\n        if (!pointsOfInterest || pointsOfInterest.length === 0) return;\n        \n        pointsOfInterest.forEach(poi => {\n          // Trouver la position sur le chemin\n          const position = path.getPoint(poi.position / totalDistance);\n          \n          // Créer un marqueur\n          const markerGeometry = new THREE.SphereGeometry(3, 16, 16);\n          \n          // Couleur en fonction du type de POI\n          let markerColor = 0xff0000;\n          \n          if (poi.type === 'viewpoint') {\n            markerColor = 0x00ff00;\n          } else if (poi.type === 'rest') {\n            markerColor = 0x0000ff;\n          } else if (poi.type === 'summit') {\n            markerColor = 0xff9900;\n          }\n          \n          const markerMaterial = new THREE.MeshStandardMaterial({ \n            color: markerColor,\n            emissive: markerColor,\n            emissiveIntensity: 0.3\n          });\n          \n          const marker = new THREE.Mesh(markerGeometry, markerMaterial);\n          marker.position.copy(position);\n          marker.position.y += 5; // Légèrement au-dessus du terrain\n          marker.castShadow = true;\n          \n          // Ajouter un texte flottant\n          const canvas = document.createElement('canvas');\n          const context = canvas.getContext('2d');\n          canvas.width = 256;\n          canvas.height = 128;\n          \n          context.fillStyle = '#ffffff';\n          context.fillRect(0, 0, canvas.width, canvas.height);\n          context.fillStyle = '#000000';\n          context.font = 'Bold 20px Arial';\n          context.fillText(poi.name, 10, 64);\n          \n          const texture = new THREE.CanvasTexture(canvas);\n          const labelMaterial = new THREE.SpriteMaterial({ map: texture });\n          const label = new THREE.Sprite(labelMaterial);\n          label.position.copy(marker.position);\n          label.position.y += 10;\n          label.scale.set(20, 10, 1);\n          \n          terrainGroup.add(marker);\n          terrainGroup.add(label);\n        });\n      };\n      \n      // Créer les éléments du terrain\n      const path = createPath();\n      createTerrainMesh(path);\n      addPointsOfInterest(path);\n      \n      return { path, terrainGroup };\n    };\n    \n    // Initialiser les éléments du terrain\n    const { path } = createTerrain();\n    \n    // Fonction d'animation\n    const flyThroughAnimation = {\n      animationId: null,\n      isPlaying: false,\n      progress: 0,\n      speed: 1,\n      \n      start: function() {\n        this.isPlaying = true;\n        setIsPlaying(true);\n        this.animate();\n      },\n      \n      pause: function() {\n        this.isPlaying = false;\n        setIsPlaying(false);\n        if (this.animationId) {\n          cancelAnimationFrame(this.animationId);\n        }\n      },\n      \n      reset: function() {\n        this.progress = 0;\n        setProgress(0);\n        this.updateCamera();\n      },\n      \n      setProgress: function(value) {\n        this.progress = Math.max(0, Math.min(1, value));\n        setProgress(value);\n        this.updateCamera();\n      },\n      \n      setSpeed: function(value) {\n        this.speed = value;\n        setSpeed(value);\n      },\n      \n      updateCamera: function() {\n        if (!path) return;\n        \n        // Obtenir la position actuelle sur le chemin\n        const pathPoint = path.getPoint(this.progress);\n        \n        // Calculer la direction (tangente)\n        const tangent = path.getTangent(this.progress);\n        \n        // Position de la caméra en fonction du mode\n        if (cameraMode === 'follow') {\n          // Mode suivi : caméra derrière le point actuel\n          camera.position.set(\n            pathPoint.x - tangent.x * 10,\n            pathPoint.y + 5, // Un peu au-dessus du chemin\n            pathPoint.z - tangent.z * 10\n          );\n          \n          // Regarder vers l'avant sur le chemin\n          const lookAtPoint = new THREE.Vector3(\n            pathPoint.x + tangent.x * 20,\n            pathPoint.y + 1,\n            pathPoint.z + tangent.z * 20\n          );\n          camera.lookAt(lookAtPoint);\n        } else if (cameraMode === 'cinematic') {\n          // Mode cinématique : caméra qui suit avec un angle\n          const angle = this.progress * Math.PI * 4; // Rotation autour du chemin\n          const radius = 20;\n          \n          camera.position.set(\n            pathPoint.x + Math.cos(angle) * radius,\n            pathPoint.y + 10,\n            pathPoint.z + Math.sin(angle) * radius\n          );\n          \n          camera.lookAt(pathPoint);\n        }\n        \n        // Mettre à jour les statistiques\n        if (elevationData && elevationData.length > 0) {\n          const index = Math.floor(this.progress * (elevationData.length - 1));\n          const data = elevationData[index];\n          \n          if (data) {\n            setCurrentElevation(data.elevation);\n            setCurrentGradient(data.gradient);\n            setCurrentDistance(data.distance);\n          }\n        }\n      },\n      \n      animate: function() {\n        if (!this.isPlaying) return;\n        \n        // Mettre à jour la progression\n        const progressIncrement = 0.0001 * this.speed;\n        this.progress += progressIncrement;\n        \n        // Boucler ou arrêter à la fin\n        if (this.progress >= 1) {\n          this.progress = 0;\n        }\n        \n        setProgress(this.progress);\n        this.updateCamera();\n        \n        // Continuer l'animation\n        this.animationId = requestAnimationFrame(() => this.animate());\n      }\n    };\n    \n    flyThroughRef.current = flyThroughAnimation;\n    \n    // Initialiser la position de la caméra\n    flyThroughAnimation.updateCamera();\n    \n    // Gestionnaire de redimensionnement\n    const handleResize = () => {\n      const width = container.clientWidth;\n      const height = container.clientHeight;\n      \n      camera.aspect = width / height;\n      camera.updateProjectionMatrix();\n      renderer.setSize(width, height);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    \n    // Fonction d'animation générale (incluant OrbitControls)\n    const animate = () => {\n      requestAnimationFrame(animate);\n      \n      if (controlsRef.current) {\n        controlsRef.current.update();\n      }\n      \n      renderer.render(scene, camera);\n    };\n    \n    animate();\n    \n    // Signal que le chargement est terminé\n    setLoading(false);\n    \n    // Nettoyage\n    return () => {\n      window.removeEventListener('resize', handleResize);\n      \n      if (flyThroughRef.current && flyThroughRef.current.animationId) {\n        cancelAnimationFrame(flyThroughRef.current.animationId);\n      }\n      \n      if (rendererRef.current && container.contains(rendererRef.current.domElement)) {\n        container.removeChild(rendererRef.current.domElement);\n      }\n      \n      if (controlsRef.current) {\n        controlsRef.current.dispose();\n      }\n    };\n  }, [colData, pointsOfInterest, cameraMode, elevationData]);\n  \n  // Gestion des interactions utilisateur\n  const handlePlayPause = () => {\n    if (flyThroughRef.current) {\n      if (isPlaying) {\n        flyThroughRef.current.pause();\n      } else {\n        flyThroughRef.current.start();\n      }\n    }\n  };\n  \n  const handleReset = () => {\n    if (flyThroughRef.current) {\n      flyThroughRef.current.reset();\n    }\n  };\n  \n  const handleProgressChange = (event, newValue) => {\n    if (flyThroughRef.current) {\n      flyThroughRef.current.setProgress(newValue);\n    }\n  };\n  \n  const handleSpeedChange = (event, newValue) => {\n    if (flyThroughRef.current) {\n      flyThroughRef.current.setSpeed(newValue);\n    }\n  };\n  \n  const handleMuteToggle = () => {\n    setIsMuted(!isMuted);\n  };\n  \n  const handleFullscreenToggle = () => {\n    if (!containerRef.current) return;\n    \n    if (!isFullscreen) {\n      if (containerRef.current.requestFullscreen) {\n        containerRef.current.requestFullscreen();\n      }\n    } else {\n      if (document.exitFullscreen) {\n        document.exitFullscreen();\n      }\n    }\n    \n    setIsFullscreen(!isFullscreen);\n  };\n  \n  const handleCameraModeChange = (mode) => {\n    setCameraMode(mode);\n    \n    if (controlsRef.current) {\n      controlsRef.current.enabled = mode === 'orbit';\n    }\n  };\n  \n  // Écouteur pour les changements de plein écran\n  useEffect(() => {\n    const handleFullscreenChange = () => {\n      setIsFullscreen(!!document.fullscreenElement);\n    };\n    \n    document.addEventListener('fullscreenchange', handleFullscreenChange);\n    \n    return () => {\n      document.removeEventListener('fullscreenchange', handleFullscreenChange);\n    };\n  }, []);\n  \n  // Afficher un indicateur de chargement\n  if (loading) {\n    return (\n      <Box \n        display=\"flex\" \n        flexDirection=\"column\"\n        justifyContent=\"center\" \n        alignItems=\"center\" \n        height=\"100%\"\n        sx={{ backgroundColor: 'rgba(0, 0, 0, 0.03)' }}\n      >\n        <CircularProgress size={40} />\n        <Typography variant=\"subtitle1\" sx={{ mt: 2 }}>\n          Préparation du Fly-through...\n        </Typography>\n      </Box>\n    );\n  }\n  \n  // Afficher un message d'erreur\n  if (error) {\n    return (\n      <Box \n        display=\"flex\" \n        justifyContent=\"center\" \n        alignItems=\"center\" \n        height=\"100%\"\n        sx={{ backgroundColor: 'rgba(0, 0, 0, 0.03)' }}\n      >\n        <Typography color=\"error\" role=\"alert\">{error}</Typography>\n      </Box>\n    );\n  }\n  \n  return (\n    <Box \n      sx={{ \n        position: 'relative', \n        height: '100%', \n        overflow: 'hidden',\n        borderRadius: '8px',\n        boxShadow: 3\n      }}\n      ref={containerRef}\n      onMouseMove={() => setShowControls(true)}\n      onMouseLeave={() => setTimeout(() => setShowControls(false), 3000)}\n      onTouchStart={() => setShowControls(true)}\n      onTouchEnd={() => setTimeout(() => setShowControls(false), 3000)}\n    >\n      {/* Statistiques en temps réel */}\n      <StatsOverlay \n        show={showControls || isMobile} \n        ref={statsRef}\n        isMobile={isMobile}\n      >\n        <Typography variant={isMobile ? 'caption' : 'body2'}>\n          Altitude: <strong>{currentElevation.toFixed(0)} m</strong>\n        </Typography>\n        <Typography variant={isMobile ? 'caption' : 'body2'}>\n          Pente: <strong>{currentGradient.toFixed(1)}%</strong>\n        </Typography>\n        <Typography variant={isMobile ? 'caption' : 'body2'}>\n          Distance: <strong>{currentDistance.toFixed(1)} / {totalDistance.toFixed(1)} km</strong>\n        </Typography>\n      </StatsOverlay>\n      \n      {/* Contrôles de la visualisation */}\n      <ControlsOverlay \n        show={showControls || isMobile}\n        isMobile={isMobile}\n      >\n        {/* Contrôles principaux */}\n        <ControlButtonsGroup>\n          <Tooltip title={isPlaying ? \"Pause\" : \"Lecture\"}>\n            <IconButton \n              onClick={handlePlayPause} \n              color=\"primary\"\n              size={isMobile ? \"small\" : \"medium\"}\n            >\n              {isPlaying ? <Pause /> : <PlayArrow />}\n            </IconButton>\n          </Tooltip>\n          \n          <Tooltip title=\"Recommencer\">\n            <IconButton \n              onClick={handleReset} \n              color=\"primary\"\n              size={isMobile ? \"small\" : \"medium\"}\n            >\n              <ReplayOutlined />\n            </IconButton>\n          </Tooltip>\n          \n          <Box sx={{ width: isMobile ? 100 : 150, mx: 1 }}>\n            <Slider\n              value={progress}\n              onChange={handleProgressChange}\n              min={0}\n              max={1}\n              step={0.001}\n              aria-label=\"Progression\"\n              size={isMobile ? \"small\" : \"medium\"}\n            />\n          </Box>\n          \n          <Tooltip title={isMuted ? \"Activer le son\" : \"Couper le son\"}>\n            <IconButton \n              onClick={handleMuteToggle} \n              color=\"primary\"\n              size={isMobile ? \"small\" : \"medium\"}\n            >\n              {isMuted ? <VolumeOff /> : <VolumeUp />}\n            </IconButton>\n          </Tooltip>\n          \n          <Tooltip title={isFullscreen ? \"Quitter le plein écran\" : \"Plein écran\"}>\n            <IconButton \n              onClick={handleFullscreenToggle} \n              color=\"primary\"\n              size={isMobile ? \"small\" : \"medium\"}\n            >\n              {isFullscreen ? <FullscreenExit /> : <Fullscreen />}\n            </IconButton>\n          </Tooltip>\n        </ControlButtonsGroup>\n        \n        {/* Contrôles avancés */}\n        <AdvancedControlsGroup>\n          <Box sx={{ display: 'flex', alignItems: 'center', mr: 2 }}>\n            <Typography variant={isMobile ? 'caption' : 'body2'} sx={{ mr: 1 }}>\n              Vitesse:\n            </Typography>\n            <Box sx={{ width: isMobile ? 80 : 100 }}>\n              <Slider\n                value={speed}\n                onChange={handleSpeedChange}\n                min={0.5}\n                max={3}\n                step={0.5}\n                marks={[\n                  { value: 0.5, label: isMobile ? '' : '0.5x' },\n                  { value: 1, label: isMobile ? '' : '1x' },\n                  { value: 2, label: isMobile ? '' : '2x' },\n                  { value: 3, label: isMobile ? '' : '3x' }\n                ]}\n                aria-label=\"Vitesse\"\n                size=\"small\"\n              />\n            </Box>\n          </Box>\n          \n          <Box sx={{ display: 'flex', alignItems: 'center' }}>\n            <Typography variant={isMobile ? 'caption' : 'body2'} sx={{ mr: 1 }}>\n              Caméra:\n            </Typography>\n            <Box sx={{ display: 'flex' }}>\n              <Tooltip title=\"Suivre le parcours\">\n                <IconButton \n                  onClick={() => handleCameraModeChange('follow')} \n                  color={cameraMode === 'follow' ? \"primary\" : \"default\"}\n                  size=\"small\"\n                >\n                  <FlightTakeoff />\n                </IconButton>\n              </Tooltip>\n              \n              <Tooltip title=\"Caméra libre\">\n                <IconButton \n                  onClick={() => handleCameraModeChange('orbit')} \n                  color={cameraMode === 'orbit' ? \"primary\" : \"default\"}\n                  size=\"small\"\n                >\n                  <CameraAlt />\n                </IconButton>\n              </Tooltip>\n              \n              <Tooltip title=\"Vue cinématique\">\n                <IconButton \n                  onClick={() => handleCameraModeChange('cinematic')} \n                  color={cameraMode === 'cinematic' ? \"primary\" : \"default\"}\n                  size=\"small\"\n                >\n                  <SlowMotionVideo />\n                </IconButton>\n              </Tooltip>\n            </Box>\n          </Box>\n        </AdvancedControlsGroup>\n      </ControlsOverlay>\n      \n      {/* Indicateur de contrôle tactile */}\n      {isMobile && (\n        <TouchIndicator>\n          <TouchApp />\n          <Typography variant=\"caption\">\n            Touchez pour afficher les contrôles\n          </Typography>\n        </TouchIndicator>\n      )}\n    </Box>\n  );\n};\n\n// Composants stylisés\nconst StatsOverlay = styled(Box)`\n  position: absolute;\n  top: 10px;\n  left: 10px;\n  background-color: rgba(255, 255, 255, 0.8);\n  padding: 8px 12px;\n  border-radius: 8px;\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n  transition: opacity 0.3s ease-in-out;\n  opacity: ${props => props.show ? 1 : 0};\n  pointer-events: ${props => props.show ? 'auto' : 'none'};\n  z-index: 10;\n  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);\n  font-size: ${props => props.isMobile ? '0.75rem' : '0.875rem'};\n`;\n\nconst ControlsOverlay = styled(Box)`\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  background-color: rgba(255, 255, 255, 0.9);\n  padding: ${props => props.isMobile ? '8px' : '12px'};\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n  transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;\n  opacity: ${props => props.show ? 1 : 0};\n  transform: translateY(${props => props.show ? '0' : '100%'});\n  pointer-events: ${props => props.show ? 'auto' : 'none'};\n  z-index: 10;\n  box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.1);\n`;\n\nconst ControlButtonsGroup = styled(Box)`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n`;\n\nconst AdvancedControlsGroup = styled(Box)`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-wrap: wrap;\n  padding-top: 4px;\n  border-top: 1px solid rgba(0, 0, 0, 0.1);\n`;\n\nconst TouchIndicator = styled(Box)`\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  color: rgba(255, 255, 255, 0.8);\n  opacity: 0.7;\n  pointer-events: none;\n  \n  & > .MuiSvgIcon-root {\n    font-size: 3rem;\n    animation: pulse 2s infinite;\n  }\n  \n  @keyframes pulse {\n    0% {\n      opacity: 0.7;\n      transform: scale(1);\n    }\n    50% {\n      opacity: 1;\n      transform: scale(1.1);\n    }\n    100% {\n      opacity: 0.7;\n      transform: scale(1);\n    }\n  }\n`;\n\nexport default React.memo(ColFlyThrough);\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}