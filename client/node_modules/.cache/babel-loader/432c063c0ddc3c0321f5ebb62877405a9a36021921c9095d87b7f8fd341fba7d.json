{"ast":null,"code":"import React from'react';import{MapContainer,TileLayer,Marker,Popup,Polyline}from'react-leaflet';import{FaMountain}from'react-icons/fa';import{createIcon}from'leaflet';import'leaflet/dist/leaflet.css';/**\n * Composant de carte optimisé pour le chargement paresseux\n * Extrait de EnhancedColDetail pour améliorer les performances\n */import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const MapComponent=_ref=>{let{center,zoom,colData,selectedSide,elevationProfile}=_ref;// Correction pour l'icône Leaflet\nconst MountainIcon=createIcon({iconUrl:'/images/summits/mountain-marker.svg',iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowUrl:null,shadowSize:null,shadowAnchor:null,// Gestion des erreurs pour l'icône\niconRetinaUrl:'/images/summits/mountain-marker.svg',className:'leaflet-mountain-icon'});// Fallback si l'icône personnalisée échoue\nconst handleIconError=()=>{console.warn('Icône de montagne non chargée, utilisation de l\\'icône par défaut');return null;// Leaflet utilisera l'icône par défaut\n};return/*#__PURE__*/_jsxs(\"div\",{className:\"map-wrapper\",children:[/*#__PURE__*/_jsxs(MapContainer,{center:center,zoom:zoom,style:{height:'400px',width:'100%'},whenCreated:map=>{// Amélioration de performance : désactiver le zoom lors du scroll\nmap.scrollWheelZoom.disable();// Ajouter un bouton pour activer/désactiver le zoom au scroll\nconst zoomControl=L.control({position:'topright'});zoomControl.onAdd=()=>{const div=L.DomUtil.create('div','leaflet-control-zoom-toggle');div.innerHTML='<button class=\"btn btn-sm btn-primary\">Activer le zoom</button>';div.onclick=()=>{if(map.scrollWheelZoom.enabled()){map.scrollWheelZoom.disable();div.innerHTML='<button class=\"btn btn-sm btn-primary\">Activer le zoom</button>';}else{map.scrollWheelZoom.enable();div.innerHTML='<button class=\"btn btn-sm btn-secondary\">Désactiver le zoom</button>';}};return div;};zoomControl.addTo(map);},children:[/*#__PURE__*/_jsx(TileLayer,{attribution:\"\\xA9 <a href=\\\"https://www.openstreetmap.org/\\\">OpenStreetMap</a> contributors\",url:\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"// Optimisation des performances\n,updateWhenIdle:true,updateWhenZooming:false,maxZoom:18}),/*#__PURE__*/_jsx(Marker,{position:center,icon:MountainIcon,eventHandlers:{error:handleIconError},children:/*#__PURE__*/_jsx(Popup,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"col-popup\",children:[/*#__PURE__*/_jsx(\"h5\",{children:colData.name}),/*#__PURE__*/_jsxs(\"p\",{children:[colData.altitude,\"m - \",colData.difficulty,\"/5\"]}),selectedSide&&/*#__PURE__*/_jsxs(\"p\",{children:[colData.climbData[selectedSide].length,\"km, \",colData.climbData[selectedSide].gradientAvg,\"%\"]})]})})}),elevationProfile&&elevationProfile.path&&/*#__PURE__*/_jsx(Polyline,{positions:elevationProfile.path.map(point=>[point.lat,point.lng]),color:\"#007bff\",weight:5,opacity:0.7})]}),/*#__PURE__*/_jsx(\"div\",{className:\"map-attribution mt-2\",children:/*#__PURE__*/_jsx(\"small\",{children:\"Donn\\xE9es cartographiques : OpenStreetMap | Trac\\xE9s : Grand Est Cyclisme\"})})]});};export default MapComponent;","map":{"version":3,"names":["React","MapContainer","TileLayer","Marker","Popup","Polyline","FaMountain","createIcon","jsx","_jsx","jsxs","_jsxs","MapComponent","_ref","center","zoom","colData","selectedSide","elevationProfile","MountainIcon","iconUrl","iconSize","iconAnchor","popupAnchor","shadowUrl","shadowSize","shadowAnchor","iconRetinaUrl","className","handleIconError","console","warn","children","style","height","width","whenCreated","map","scrollWheelZoom","disable","zoomControl","L","control","position","onAdd","div","DomUtil","create","innerHTML","onclick","enabled","enable","addTo","attribution","url","updateWhenIdle","updateWhenZooming","maxZoom","icon","eventHandlers","error","name","altitude","difficulty","climbData","length","gradientAvg","path","positions","point","lat","lng","color","weight","opacity"],"sources":["C:/Users/busin/CascadeProjects/grand-est-cyclisme-website-final (1) VERSION FINAL/client/src/components/cols/MapComponent.js"],"sourcesContent":["import React from 'react';\nimport { MapContainer, TileLayer, Marker, Popup, Polyline } from 'react-leaflet';\nimport { FaMountain } from 'react-icons/fa';\nimport { createIcon } from 'leaflet';\nimport 'leaflet/dist/leaflet.css';\n\n/**\n * Composant de carte optimisé pour le chargement paresseux\n * Extrait de EnhancedColDetail pour améliorer les performances\n */\nconst MapComponent = ({ center, zoom, colData, selectedSide, elevationProfile }) => {\n  // Correction pour l'icône Leaflet\n  const MountainIcon = createIcon({\n    iconUrl: '/images/summits/mountain-marker.svg',\n    iconSize: [25, 41],\n    iconAnchor: [12, 41],\n    popupAnchor: [1, -34],\n    shadowUrl: null,\n    shadowSize: null,\n    shadowAnchor: null,\n    // Gestion des erreurs pour l'icône\n    iconRetinaUrl: '/images/summits/mountain-marker.svg',\n    className: 'leaflet-mountain-icon',\n  });\n\n  // Fallback si l'icône personnalisée échoue\n  const handleIconError = () => {\n    console.warn('Icône de montagne non chargée, utilisation de l\\'icône par défaut');\n    return null; // Leaflet utilisera l'icône par défaut\n  };\n\n  return (\n    <div className=\"map-wrapper\">\n      <MapContainer \n        center={center} \n        zoom={zoom} \n        style={{ height: '400px', width: '100%' }}\n        whenCreated={(map) => {\n          // Amélioration de performance : désactiver le zoom lors du scroll\n          map.scrollWheelZoom.disable();\n          // Ajouter un bouton pour activer/désactiver le zoom au scroll\n          const zoomControl = L.control({ position: 'topright' });\n          zoomControl.onAdd = () => {\n            const div = L.DomUtil.create('div', 'leaflet-control-zoom-toggle');\n            div.innerHTML = '<button class=\"btn btn-sm btn-primary\">Activer le zoom</button>';\n            div.onclick = () => {\n              if (map.scrollWheelZoom.enabled()) {\n                map.scrollWheelZoom.disable();\n                div.innerHTML = '<button class=\"btn btn-sm btn-primary\">Activer le zoom</button>';\n              } else {\n                map.scrollWheelZoom.enable();\n                div.innerHTML = '<button class=\"btn btn-sm btn-secondary\">Désactiver le zoom</button>';\n              }\n            };\n            return div;\n          };\n          zoomControl.addTo(map);\n        }}\n      >\n        <TileLayer \n          attribution='&copy; <a href=\"https://www.openstreetmap.org/\">OpenStreetMap</a> contributors'\n          url='https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png'\n          // Optimisation des performances\n          updateWhenIdle={true}\n          updateWhenZooming={false}\n          maxZoom={18}\n        />\n        \n        <Marker \n          position={center} \n          icon={MountainIcon}\n          eventHandlers={{\n            error: handleIconError\n          }}\n        >\n          <Popup>\n            <div className=\"col-popup\">\n              <h5>{colData.name}</h5>\n              <p>{colData.altitude}m - {colData.difficulty}/5</p>\n              {selectedSide && (\n                <p>{colData.climbData[selectedSide].length}km, {colData.climbData[selectedSide].gradientAvg}%</p>\n              )}\n            </div>\n          </Popup>\n        </Marker>\n        \n        {/* Afficher le tracé du col si disponible */}\n        {elevationProfile && elevationProfile.path && (\n          <Polyline \n            positions={elevationProfile.path.map(point => [point.lat, point.lng])}\n            color=\"#007bff\"\n            weight={5}\n            opacity={0.7}\n          />\n        )}\n      </MapContainer>\n      \n      <div className=\"map-attribution mt-2\">\n        <small>Données cartographiques : OpenStreetMap | Tracés : Grand Est Cyclisme</small>\n      </div>\n    </div>\n  );\n};\n\nexport default MapComponent;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}