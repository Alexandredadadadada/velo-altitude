{"ast":null,"code":"import React,{createContext,useState,useContext,useEffect}from'react';import{format}from'date-fns';import{fr}from'date-fns/locale';import{useNotification}from'../components/common/NotificationSystem';import{useFeatureFlags}from'../services/featureFlags';// Création du contexte\nimport{jsx as _jsx}from\"react/jsx-runtime\";export const CommunityContext=/*#__PURE__*/createContext();// Hook personnalisé pour utiliser le contexte\nexport const useCommunity=()=>{const context=useContext(CommunityContext);if(!context){throw new Error('useCommunity doit être utilisé à l\\'intérieur d\\'un CommunityProvider');}return context;};// Données de démonstration\nconst mockUserProfile={id:'123',username:'cycliste_passionné',fullName:'Jean Dupont',following:145,followers:89,achievementCount:27,points:3450,level:7,region:'Alsace',avatar:'/images/profiles/default-avatar.jpg'};const mockCommunityStats={totalMembers:5432,activeMembers:1284,yourRank:172,activeChallenges:14,yourChallenges:5,totalChallenges:48,regionRiders:412,weeklyActivity:[35,42,28,45,51,63,47]};const mockUpcomingEvents=[{id:'1',title:'Randonnée Col de la Schlucht',date:'2025-04-18',time:'09:00',location:'Munster, Haut-Rhin',distance:95,elevation:1200,participants:47,organizer:'Club Cycliste du Haut-Rhin',joined:true,description:'Randonnée cycliste à travers la vallée de Munster et montée du Col de la Schlucht.'},{id:'2',title:'Montée du Grand Ballon',date:'2025-05-02',time:'10:30',location:'Thann, Haut-Rhin',distance:75,elevation:1424,participants:32,organizer:'Cyclomontagnards d\\'Alsace',joined:false,description:'Défi d\\'ascension du Grand Ballon, le point culminant des Vosges.'},{id:'3',title:'Boucle des Trois Frontières',date:'2025-05-15',time:'08:00',location:'Saint-Louis, Haut-Rhin',distance:110,elevation:850,participants:28,organizer:'Vélo Club Transfrontalier',joined:false,description:'Parcours à travers la France, l\\'Allemagne et la Suisse avec découverte de paysages variés.'}];// Composant Provider qui fournit le contexte\nexport const CommunityProvider=_ref=>{let{children}=_ref;// Systèmes externes\nconst{notify}=useNotification();const{isEnabled}=useFeatureFlags();// États\nconst[userProfile,setUserProfile]=useState(mockUserProfile);const[communityStats,setCommunityStats]=useState(mockCommunityStats);const[upcomingEvents,setUpcomingEvents]=useState(mockUpcomingEvents);const[loading,setLoading]=useState(false);const[error,setError]=useState(null);// Effet pour charger les données (simulation)\nuseEffect(()=>{// Dans une application réelle, charger les données depuis l'API\nsetLoading(true);try{// Simuler un délai de chargement\nconst timer=setTimeout(()=>{setUserProfile(mockUserProfile);setCommunityStats(mockCommunityStats);// Vérifier si les défis mensuels sont activés via feature flag\nif(isEnabled('enableMonthlyChallenge')){setUpcomingEvents(mockUpcomingEvents);}else{// Si le feature flag est désactivé, filtrer les défis mensuels\nsetUpcomingEvents(mockUpcomingEvents.filter(event=>!event.title.includes('Mensuel')));}setLoading(false);},800);return()=>clearTimeout(timer);}catch(error){setError(error);setLoading(false);notify.error('Erreur lors du chargement des données communautaires',error);}},[notify,isEnabled]);// Fonction pour formater une date\nconst formatDate=dateString=>{try{const date=new Date(dateString);return format(date,'dd MMM yyyy',{locale:fr});}catch(error){console.error('Error formatting date:',error);notify.error('Erreur lors du formatage de la date',error);return dateString;}};// Fonction pour rejoindre un événement\nconst handleJoinEvent=eventId=>{try{setUpcomingEvents(prevEvents=>prevEvents.map(event=>event.id===eventId?{...event,joined:true}:event));notify.success(`Vous avez rejoint l'événement avec succès`);}catch(error){notify.error('Impossible de rejoindre l\\'événement',error);}};// Fonction pour quitter un événement\nconst handleLeaveEvent=eventId=>{try{setUpcomingEvents(prevEvents=>prevEvents.map(event=>event.id===eventId?{...event,joined:false}:event));notify.info(`Vous avez quitté l'événement`);}catch(error){notify.error('Impossible de quitter l\\'événement',error);}};// Valeur du contexte à exposer\nconst value={userProfile,communityStats,upcomingEvents,loading,error,formatDate,handleJoinEvent,handleLeaveEvent,// Exposer les fonctions externes\nisFeatureEnabled:isEnabled};return/*#__PURE__*/_jsx(CommunityContext.Provider,{value:value,children:children});};export default CommunityProvider;","map":{"version":3,"names":["React","createContext","useState","useContext","useEffect","format","fr","useNotification","useFeatureFlags","jsx","_jsx","CommunityContext","useCommunity","context","Error","mockUserProfile","id","username","fullName","following","followers","achievementCount","points","level","region","avatar","mockCommunityStats","totalMembers","activeMembers","yourRank","activeChallenges","yourChallenges","totalChallenges","regionRiders","weeklyActivity","mockUpcomingEvents","title","date","time","location","distance","elevation","participants","organizer","joined","description","CommunityProvider","_ref","children","notify","isEnabled","userProfile","setUserProfile","communityStats","setCommunityStats","upcomingEvents","setUpcomingEvents","loading","setLoading","error","setError","timer","setTimeout","filter","event","includes","clearTimeout","formatDate","dateString","Date","locale","console","handleJoinEvent","eventId","prevEvents","map","success","handleLeaveEvent","info","value","isFeatureEnabled","Provider"],"sources":["C:/Users/busin/CascadeProjects/grand-est-cyclisme-website-final (1) VERSION FINAL/client/src/contexts/CommunityContext.js"],"sourcesContent":["import React, { createContext, useState, useContext, useEffect } from 'react';\nimport { format } from 'date-fns';\nimport { fr } from 'date-fns/locale';\nimport { useNotification } from '../components/common/NotificationSystem';\nimport { useFeatureFlags } from '../services/featureFlags';\n\n// Création du contexte\nexport const CommunityContext = createContext();\n\n// Hook personnalisé pour utiliser le contexte\nexport const useCommunity = () => {\n  const context = useContext(CommunityContext);\n  if (!context) {\n    throw new Error('useCommunity doit être utilisé à l\\'intérieur d\\'un CommunityProvider');\n  }\n  return context;\n};\n\n// Données de démonstration\nconst mockUserProfile = {\n  id: '123',\n  username: 'cycliste_passionné',\n  fullName: 'Jean Dupont',\n  following: 145,\n  followers: 89,\n  achievementCount: 27,\n  points: 3450,\n  level: 7,\n  region: 'Alsace',\n  avatar: '/images/profiles/default-avatar.jpg',\n};\n\nconst mockCommunityStats = {\n  totalMembers: 5432,\n  activeMembers: 1284,\n  yourRank: 172,\n  activeChallenges: 14,\n  yourChallenges: 5,\n  totalChallenges: 48,\n  regionRiders: 412,\n  weeklyActivity: [35, 42, 28, 45, 51, 63, 47],\n};\n\nconst mockUpcomingEvents = [\n  {\n    id: '1',\n    title: 'Randonnée Col de la Schlucht',\n    date: '2025-04-18',\n    time: '09:00',\n    location: 'Munster, Haut-Rhin',\n    distance: 95,\n    elevation: 1200,\n    participants: 47,\n    organizer: 'Club Cycliste du Haut-Rhin',\n    joined: true,\n    description: 'Randonnée cycliste à travers la vallée de Munster et montée du Col de la Schlucht.'\n  },\n  {\n    id: '2',\n    title: 'Montée du Grand Ballon',\n    date: '2025-05-02',\n    time: '10:30',\n    location: 'Thann, Haut-Rhin',\n    distance: 75,\n    elevation: 1424,\n    participants: 32,\n    organizer: 'Cyclomontagnards d\\'Alsace',\n    joined: false,\n    description: 'Défi d\\'ascension du Grand Ballon, le point culminant des Vosges.'\n  },\n  {\n    id: '3',\n    title: 'Boucle des Trois Frontières',\n    date: '2025-05-15',\n    time: '08:00',\n    location: 'Saint-Louis, Haut-Rhin',\n    distance: 110,\n    elevation: 850,\n    participants: 28,\n    organizer: 'Vélo Club Transfrontalier',\n    joined: false,\n    description: 'Parcours à travers la France, l\\'Allemagne et la Suisse avec découverte de paysages variés.'\n  }\n];\n\n// Composant Provider qui fournit le contexte\nexport const CommunityProvider = ({ children }) => {\n  // Systèmes externes\n  const { notify } = useNotification();\n  const { isEnabled } = useFeatureFlags();\n  \n  // États\n  const [userProfile, setUserProfile] = useState(mockUserProfile);\n  const [communityStats, setCommunityStats] = useState(mockCommunityStats);\n  const [upcomingEvents, setUpcomingEvents] = useState(mockUpcomingEvents);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n\n  // Effet pour charger les données (simulation)\n  useEffect(() => {\n    // Dans une application réelle, charger les données depuis l'API\n    setLoading(true);\n    \n    try {\n      // Simuler un délai de chargement\n      const timer = setTimeout(() => {\n        setUserProfile(mockUserProfile);\n        setCommunityStats(mockCommunityStats);\n        \n        // Vérifier si les défis mensuels sont activés via feature flag\n        if (isEnabled('enableMonthlyChallenge')) {\n          setUpcomingEvents(mockUpcomingEvents);\n        } else {\n          // Si le feature flag est désactivé, filtrer les défis mensuels\n          setUpcomingEvents(mockUpcomingEvents.filter(event => !event.title.includes('Mensuel')));\n        }\n        \n        setLoading(false);\n      }, 800);\n      \n      return () => clearTimeout(timer);\n    } catch (error) {\n      setError(error);\n      setLoading(false);\n      notify.error('Erreur lors du chargement des données communautaires', error);\n    }\n  }, [notify, isEnabled]);\n\n  // Fonction pour formater une date\n  const formatDate = (dateString) => {\n    try {\n      const date = new Date(dateString);\n      return format(date, 'dd MMM yyyy', { locale: fr });\n    } catch (error) {\n      console.error('Error formatting date:', error);\n      notify.error('Erreur lors du formatage de la date', error);\n      return dateString;\n    }\n  };\n\n  // Fonction pour rejoindre un événement\n  const handleJoinEvent = (eventId) => {\n    try {\n      setUpcomingEvents(prevEvents => \n        prevEvents.map(event => \n          event.id === eventId \n            ? { ...event, joined: true } \n            : event\n        )\n      );\n      notify.success(`Vous avez rejoint l'événement avec succès`);\n    } catch (error) {\n      notify.error('Impossible de rejoindre l\\'événement', error);\n    }\n  };\n\n  // Fonction pour quitter un événement\n  const handleLeaveEvent = (eventId) => {\n    try {\n      setUpcomingEvents(prevEvents => \n        prevEvents.map(event => \n          event.id === eventId \n            ? { ...event, joined: false } \n            : event\n        )\n      );\n      notify.info(`Vous avez quitté l'événement`);\n    } catch (error) {\n      notify.error('Impossible de quitter l\\'événement', error);\n    }\n  };\n\n  // Valeur du contexte à exposer\n  const value = {\n    userProfile,\n    communityStats,\n    upcomingEvents,\n    loading,\n    error,\n    formatDate,\n    handleJoinEvent,\n    handleLeaveEvent,\n    // Exposer les fonctions externes\n    isFeatureEnabled: isEnabled\n  };\n\n  return (\n    <CommunityContext.Provider value={value}>\n      {children}\n    </CommunityContext.Provider>\n  );\n};\n\nexport default CommunityProvider;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}