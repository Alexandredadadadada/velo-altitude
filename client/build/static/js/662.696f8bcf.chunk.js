"use strict";(self.webpackChunkgrand_est_cyclisme_client=self.webpackChunkgrand_est_cyclisme_client||[]).push([[662],{45577:(e,r,t)=>{t.d(r,{hN:()=>s});var i=t(65043);t(83910),t(70579);const n=(0,i.createContext)(),s=()=>{const e=(0,i.useContext)(n);if(!e)throw new Error("useNotification doit \xeatre utilis\xe9 \xe0 l'int\xe9rieur d'un NotificationProvider");return e}},62382:(e,r,t)=>{t.d(r,{A:()=>c});var i=t(65043),n=t(45577),s=t(94505);const o={auth_token_expired:{type:"error",title:"Session expir\xe9e",severity:"warning"},auth_token_invalid:{type:"error",title:"Authentification invalide",severity:"warning"},auth_token_missing:{type:"error",title:"Authentification requise",severity:"warning"},auth_token_revoked:{type:"error",title:"Session r\xe9voqu\xe9e",severity:"warning"},auth_credentials_invalid:{type:"error",title:"Identifiants invalides",severity:"warning"},validation_error:{type:"warning",title:"Donn\xe9es invalides",severity:"warning"},invalid_input:{type:"warning",title:"Saisie invalide",severity:"warning"},missing_required_field:{type:"warning",title:"Champ requis manquant",severity:"warning"},resource_not_found:{type:"error",title:"Ressource introuvable",severity:"warning"},route_not_found:{type:"error",title:"Page introuvable",severity:"warning"},resource_conflict:{type:"error",title:"Conflit de ressources",severity:"warning"},resource_exists:{type:"warning",title:"Ressource existante",severity:"info"},permission_denied:{type:"error",title:"Acc\xe8s refus\xe9",severity:"warning"},insufficient_permissions:{type:"error",title:"Permissions insuffisantes",severity:"warning"},server_error:{type:"error",title:"Erreur serveur",severity:"critical"},database_error:{type:"error",title:"Erreur de base de donn\xe9es",severity:"critical"},service_unavailable:{type:"error",title:"Service indisponible",severity:"critical"},timeout_error:{type:"error",title:"D\xe9lai d'attente d\xe9pass\xe9",severity:"warning"},rate_limit_exceeded:{type:"warning",title:"Limite de requ\xeates d\xe9pass\xe9e",severity:"warning"},performance_issue:{type:"warning",title:"Probl\xe8me de performance",severity:"info"},network_error:{type:"error",title:"Erreur r\xe9seau",severity:"warning"},api_error:{type:"error",title:"Erreur API",severity:"warning"},default:{type:"error",title:"Erreur",severity:"warning"}},a={critical:{position:"top-center",autoClose:!1,type:"toast",closeButton:!0,pauseOnHover:!0},warning:{position:"top-right",autoClose:8e3,type:"toast",closeButton:!0,pauseOnHover:!0},info:{position:"bottom-right",autoClose:5e3,type:"toast",closeButton:!0,pauseOnHover:!0}};const l=new class{constructor(){this.notifyFn=null,this.errorStats={count:0,byType:{},byEndpoint:{}},this.setupApiInterceptor()}init(e){this.notifyFn=e,console.log("Service d'erreur initialis\xe9 avec le syst\xe8me de notification")}setupApiInterceptor(){s.FH.interceptors.response.use((e=>e),(e=>(this.handleApiError(e),Promise.reject(e))))}handleApiError(e){let r={type:"network_error",message:"Erreur de connexion au serveur",severity:"warning",details:e.message};if(e.response&&e.response.data){const{data:t}=e.response;t.error&&(r={type:t.error.type||r.type,message:t.error.message||r.message,severity:t.error.severity||r.severity,details:t.error.details||r.details,notification:t.error.notification||null})}return this.trackError(r,e),this.notifyError(r),r}trackError(e,r){if(this.errorStats.count++,this.errorStats.byType[e.type]||(this.errorStats.byType[e.type]=0),this.errorStats.byType[e.type]++,r.config&&r.config.url){const e=r.config.url;this.errorStats.byEndpoint[e]||(this.errorStats.byEndpoint[e]=0),this.errorStats.byEndpoint[e]++}}notifyError(e){if(!this.notifyFn)return void console.warn("Syst\xe8me de notification non initialis\xe9, impossible d'afficher l'erreur");const r=o[e.type]||o.default,t=a[e.severity]||a.warning,i=e.notification||{};this.notifyFn.error(e.message,null,{title:r.title,details:void 0,duration:i.autoClose||t.autoClose,...i})}handleError(e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const t={type:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",message:e,severity:r.severity||"warning",details:r.details||"",notification:r.notification||null};return this.trackError(t,new Error(e)),this.notifyError(t),t}getErrorStats(){return{...this.errorStats}}resetErrorStats(){this.errorStats={count:0,byType:{},byEndpoint:{}}}},c=()=>{const{notify:e}=(0,n.hN)();(0,i.useEffect)((()=>{l.init(e)}),[e]);return{handleApiRequest:(0,i.useCallback)((async function(r){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{successMessage:i,loadingMessage:n,errorMessage:s="Une erreur est survenue",showSuccess:o=!1,showLoading:a=!1,onSuccess:c,onError:u}=t;let d;try{a&&n&&(d=e.info(n,{title:"Chargement",duration:0}));const t=await r;return d&&l.notifyFn.removeNotification(d),o&&i&&e.success(i),c&&c(t),t}catch(g){var p,y,m;if(d&&l.notifyFn.removeNotification(d),s)l.handleError(s,(null===(p=g.response)||void 0===p||null===(y=p.data)||void 0===y||null===(m=y.error)||void 0===m?void 0:m.type)||"default",{details:g.message});throw u&&u(g),g}}),[e]),tryCatch:(0,i.useCallback)((function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{errorMessage:t="Une erreur est survenue",showError:i=!0,fallbackValue:n=null,onError:s}=r;try{return e()}catch(o){return i&&l.handleError(t,"default",{details:o.message}),s&&s(o),n}}),[]),handleFormError:(0,i.useCallback)(((e,r)=>{var t,i,n;if(null!==(t=e.response)&&void 0!==t&&null!==(i=t.data)&&void 0!==i&&null!==(n=i.error)&&void 0!==n&&n.validationErrors){const{validationErrors:t}=e.response.data.error;Object.entries(t).forEach((e=>{let[t,i]=e;r(t,{type:"manual",message:i})})),l.handleError("Veuillez corriger les erreurs dans le formulaire","validation_error")}else l.handleApiError(e)}),[]),handleError:l.handleError.bind(l),getErrorStats:l.getErrorStats.bind(l)}}},68713:(e,r,t)=>{t.d(r,{A:()=>w});t(65043);var i=t(16662),n=t(22698),s=t(88446),o=t(85865),a=t(33639),l=t(56658),c=t(78415),u=t(6963),d=t(75883),p=t(22536),y=t(37991),m=t(52177),g=t(92577),v=t(45194),h=t(70579);const f={"/":{label:"Accueil",icon:(0,h.jsx)(a.A,{fontSize:"small"})},"/cols":{label:"Cols",icon:(0,h.jsx)(u.A,{fontSize:"small"})},"/training":{label:"Entra\xeenement",icon:(0,h.jsx)(c.A,{fontSize:"small"})},"/nutrition":{label:"Nutrition",icon:(0,h.jsx)(d.A,{fontSize:"small"})},"/routes":{label:"Parcours",icon:(0,h.jsx)(p.A,{fontSize:"small"})},"/social":{label:"Communaut\xe9",icon:(0,h.jsx)(y.A,{fontSize:"small"})},"/profile":{label:"Profil",icon:(0,h.jsx)(m.A,{fontSize:"small"})},"/settings":{label:"Param\xe8tres",icon:(0,h.jsx)(g.A,{fontSize:"small"})},"/error-demo":{label:"D\xe9mo Gestion d'Erreurs",icon:(0,h.jsx)(v.A,{fontSize:"small"})}},b={catalog:{label:"Catalogue"},explorer:{label:"Explorateur"},detail:{label:"D\xe9tails"},stats:{label:"Statistiques"},calendar:{label:"Calendrier"},programs:{label:"Programmes"},planner:{label:"Planificateur"},community:{label:"Communaut\xe9"},achievements:{label:"R\xe9ussites"}},w=()=>{const e=(0,i.zy)().pathname.split("/").filter((e=>e)),r=e=>b[e]?b[e].label:/^\d+$/.test(e)||/^[a-zA-Z0-9\-_]+$/.test(e)?`#${e}`:e.charAt(0).toUpperCase()+e.slice(1).replace(/-/g," ");return(0,h.jsx)("div",{className:"breadcrumbs-container",children:(0,h.jsxs)(n.A,{separator:(0,h.jsx)(l.A,{fontSize:"small"}),"aria-label":"navigation hi\xe9rarchique",children:[(0,h.jsxs)(s.A,{component:i.N_,to:"/",color:"inherit",display:"flex",alignItems:"center",className:"breadcrumb-link",children:[(0,h.jsx)(a.A,{fontSize:"small",style:{marginRight:"4px"}}),"Accueil"]}),e.map(((t,n)=>{const a=(r=>"/"+e.slice(0,r+1).join("/"))(n),l=f[a]||{};return n===e.length-1?(0,h.jsxs)(o.A,{color:"textPrimary",display:"flex",alignItems:"center",className:"breadcrumb-current",children:[l.icon||null,l.label||r(t)]},a):(0,h.jsxs)(s.A,{component:i.N_,to:a,color:"inherit",display:"flex",alignItems:"center",className:"breadcrumb-link",children:[l.icon||null,l.label||r(t)]},a)}))]})})}},94505:(e,r,t)=>{t.d(r,{Ay:()=>n,FH:()=>i});const i=t(86213).A.create({baseURL:"https://api.grand-est-cyclisme.fr",headers:{"Content-Type":"application/json"},timeout:3e4,withCredentials:!0});i.interceptors.request.use((e=>{const r=localStorage.getItem("authToken");return r&&(e.headers.Authorization=`Bearer ${r}`),"get"===e.method&&(e.params={...e.params,_t:Date.now()}),e}),(e=>Promise.reject(e))),i.interceptors.response.use((e=>{const r=e.headers["x-new-access-token"];return r&&localStorage.setItem("authToken",r),e}),(e=>{if(e.response&&401===e.response.status){var r,t,i,n;"auth_token_expired"===(null===(r=e.response.data)||void 0===r||null===(t=r.error)||void 0===t?void 0:t.type)||(null===(i=e.response.data)||void 0===i||null===(n=i.message)||void 0===n||n.includes("expired"));localStorage.removeItem("authToken"),localStorage.removeItem("user"),"/login"!==window.location.pathname&&(window.location.href="/login?expired=true")}return"ECONNABORTED"===e.code&&e.message.includes("timeout")&&(e.response={data:{error:{type:"timeout_error",message:"La requ\xeate a pris trop de temps \xe0 s'ex\xe9cuter",severity:"warning"}}}),e.response||(e.response={data:{error:{type:"network_error",message:"Impossible de se connecter au serveur",severity:"warning",details:e.message}}}),Promise.reject(e)}));const n=i}}]);
//# sourceMappingURL=662.696f8bcf.chunk.js.map