"use strict";(self.webpackChunkgrand_est_cyclisme_client=self.webpackChunkgrand_est_cyclisme_client||[]).push([[9193],{34372:(e,t,s)=>{s.d(t,{Ay:()=>c,h:()=>g});var i=s(86213),a=s(65043);s(70579);const r={enableDarkMode:!1,showBetaFeatures:!1,useNewNavigation:!1,enableSevenMajorsChallenge:!0,enableMonthlyChallenge:!0,enableSocialSharing:!0,enableApiCaching:!0,enablePerformanceMonitoring:!0,enable3DColVisualization:!0,enableProgressiveLoading3D:!0,enableAIRecommendations:!1,enableRealTimeWeather:!0,enableAdvancedCaching:!0,enableOfflineMode:!1,enableLazyLoadingImages:!0,enableAdvancedMetrics:!0,enableBulkOperations:!1,enableNutritionPlanner:!0,enableMealSuggestions:!0,enableColSpecificNutrition:!0,enableTrainingPrograms:!0,enablePerformanceAnalytics:!0,enableColSpecificTraining:!0,enableMountainModule:!0,enableRegionalTrainingPlans:!0},n="development",o="production",l=(0,a.createContext)({flags:r,isLoading:!0,error:null,updateFlag:()=>{},refreshFlags:()=>{},isEnabled:()=>!1,getVariant:()=>null});const u=new class{constructor(){this.flags={...r},this.subscribers=[],this.isInitialized=!1,this.lastFetchTime=0,this.cacheDuration=3e5,this.environment="production",this.userSegment=null,this.flagsHistory={}}async initialize(){if(this.isInitialized)return this.flags;try{return this.determineUserSegment(),await this.loadFlagsFromLocalStorage(),await this.fetchFlagsFromApi(),this.applyEnvironmentOverrides(),Object.keys(this.flags).forEach((e=>{this.flagsHistory[e]=[{value:this.flags[e],timestamp:Date.now(),source:"initialization"}]})),this.isInitialized=!0,this.notifySubscribers(),this.flags}catch(e){return console.error("Erreur lors de l'initialisation des feature flags:",e),this.flags}}determineUserSegment(){try{const e=JSON.parse(localStorage.getItem("userInfo")||"{}");if("admin"===e.role)this.userSegment="admin";else if(e.visits&&e.visits>10)this.userSegment="power_user";else if(e.registeredAt){const t=new Date(e.registeredAt),s=new Date;s.setMonth(s.getMonth()-1),this.userSegment=t>s?"new_user":"regular_user"}else this.userSegment="anonymous"}catch(e){console.error("Erreur lors de la d\xe9termination du segment utilisateur:",e),this.userSegment="unknown"}}applyEnvironmentOverrides(){if(this.environment===o){const e={showBetaFeatures:!1,enableAIRecommendations:!1};Object.keys(e).forEach((t=>{this.flagsHistory[t]&&0!==this.flagsHistory[t].length||(this.flags[t]=e[t])}))}if(this.environment===n){const e={showBetaFeatures:!0,enablePerformanceMonitoring:!0};Object.assign(this.flags,e)}}async loadFlagsFromLocalStorage(){try{const e=localStorage.getItem("featureFlags");if(e){const t=JSON.parse(e);this.flags={...this.flags,...t},Object.keys(t).forEach((e=>{this.flagsHistory[e]||(this.flagsHistory[e]=[]),this.flagsHistory[e].push({value:t[e],timestamp:Date.now(),source:"localStorage"})}))}}catch(e){console.error("Erreur lors du chargement des feature flags du localStorage:",e)}}async fetchFlagsFromApi(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=Date.now();if(!e&&t-this.lastFetchTime<this.cacheDuration)return this.flags;try{const e=await i.A.get("/api/feature-flags",{params:{segment:this.userSegment,environment:this.environment}});if(e.data&&e.data.flags){const s={...this.flags};this.flags={...this.flags,...e.data.flags},this.lastFetchTime=t,localStorage.setItem("featureFlags",JSON.stringify(this.flags)),Object.keys(e.data.flags).forEach((i=>{this.flagsHistory[i]||(this.flagsHistory[i]=[]),this.flagsHistory[i].push({value:e.data.flags[i],previousValue:s[i],timestamp:t,source:"api"})})),this.notifySubscribers(),this.logFlagChanges(s,this.flags)}}catch(s){console.error("Erreur lors de la r\xe9cup\xe9ration des feature flags depuis l'API:",s)}return this.flags}logFlagChanges(e,t){const s=[];Object.keys(t).forEach((i=>{e[i]!==t[i]&&s.push({flag:i,oldValue:e[i],newValue:t[i],timestamp:Date.now()})})),s.length>0&&(console.info("Feature Flags mis \xe0 jour:",s),this.environment===n&&"undefined"!==typeof window&&this.showDevNotification(`${s.length} feature flags mis \xe0 jour`))}showDevNotification(e){if("undefined"===typeof document)return;const t="feature-flag-notification";let s=document.getElementById(t);s||(s=document.createElement("div"),s.id=t,s.style.position="fixed",s.style.bottom="20px",s.style.right="20px",s.style.padding="10px 15px",s.style.backgroundColor="#333",s.style.color="white",s.style.borderRadius="4px",s.style.zIndex="9999",s.style.opacity="0",s.style.transition="opacity 0.3s ease-in-out",document.body.appendChild(s)),s.textContent=e,s.style.opacity="1",setTimeout((()=>{s.style.opacity="0",setTimeout((()=>{s.parentNode&&s.parentNode.removeChild(s)}),300)}),3e3)}async updateFlags(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const s={...this.flags};if(this.flags={...this.flags,...e},localStorage.setItem("featureFlags",JSON.stringify(this.flags)),Object.keys(e).forEach((t=>{this.flagsHistory[t]||(this.flagsHistory[t]=[]),this.flagsHistory[t].push({value:e[t],previousValue:s[t],timestamp:Date.now(),source:"manual_update"})})),this.logFlagChanges(s,this.flags),this.notifySubscribers(),t)try{await i.A.post("/api/feature-flags",{flags:e,segment:this.userSegment,environment:this.environment})}catch(a){console.error("Erreur lors de la mise \xe0 jour des feature flags sur le serveur:",a)}return this.flags}isEnabled(e){return e in this.flags?!0===this.flags[e]:(console.warn(`Feature flag "${e}" non trouv\xe9`),!1)}getVariant(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e in this.flags?this.flags[e]:(console.warn(`Feature flag variant "${e}" non trouv\xe9`),t)}subscribe(e){return this.subscribers.push(e),()=>{this.subscribers=this.subscribers.filter((t=>t!==e))}}notifySubscribers(){this.subscribers.forEach((e=>{try{e(this.flags)}catch(t){console.error("Erreur lors de la notification d'un abonn\xe9 aux feature flags:",t)}}))}getFlagHistory(e){return this.flagsHistory[e]||[]}setCacheDuration(e){this.cacheDuration=e}},g=()=>{const e=(0,a.useContext)(l);if(!e)throw new Error("useFeatureFlags doit \xeatre utilis\xe9 \xe0 l'int\xe9rieur d'un FeatureFlagsProvider");return e},c=u},45577:(e,t,s)=>{s.d(t,{hN:()=>r});var i=s(65043);s(83910),s(70579);const a=(0,i.createContext)(),r=()=>{const e=(0,i.useContext)(a);if(!e)throw new Error("useNotification doit \xeatre utilis\xe9 \xe0 l'int\xe9rieur d'un NotificationProvider");return e}},49193:(e,t,s)=>{s.d(t,{nr:()=>r});var i=s(65043);s(45577),s(34372),s(70579);const a=(0,i.createContext)(),r=()=>{const e=(0,i.useContext)(a);if(!e)throw new Error("useCommunity doit \xeatre utilis\xe9 \xe0 l'int\xe9rieur d'un CommunityProvider");return e}}}]);
//# sourceMappingURL=9193.006a9dfa.chunk.js.map