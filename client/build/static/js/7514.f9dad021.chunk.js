"use strict";(self.webpackChunkgrand_est_cyclisme_client=self.webpackChunkgrand_est_cyclisme_client||[]).push([[7514],{30073:(e,t,r)=>{r.r(t),r.d(t,{default:()=>T});var n=r(65043),a=r(74117),s=r(62690),i=r(35682),l=r(52076),o=r(59131),d=r(99972),c=r(97461),u=r(57650),m=r(45577),h=r(18097),p=r(70579);const v=e=>{let{userProfile:t,onSaveWorkout:r}=e;const{t:v}=(0,a.Bd)(),{notify:x}=(0,m.hN)(),[j,f]=(0,n.useState)([]),[g,w]=(0,n.useState)(null),[y,k]=(0,n.useState)(null),[b,N]=(0,n.useState)(!0),[P,D]=(0,n.useState)(null);(0,n.useEffect)((()=>{t&&(async()=>{try{if(N(!0),D(null),!t)throw new Error("Profil utilisateur manquant ou incomplet");await new Promise((e=>setTimeout(e,300)));const e=I(t);if(f(e),!(e.length>0))throw new Error("Aucun template HIIT n'a pu \xeatre g\xe9n\xe9r\xe9");w(e[0]),k(e[0]),x.success("Templates HIIT charg\xe9s avec succ\xe8s",{title:"Chargement termin\xe9"})}catch(P){console.error("Error loading HIIT templates:",P),D(P.message||"Erreur lors du chargement des templates HIIT"),x.error("Impossible de charger les templates HIIT",P,{title:"Erreur de chargement"})}finally{N(!1)}})()}),[t,x,v]);const I=e=>{if(!e)return console.error("Profil utilisateur manquant pour la g\xe9n\xe9ration des templates HIIT"),[];let{level:t="intermediate"}=e;const r=h.Ay.validateFTP(e.ftp,e);["beginner","intermediate","advanced","elite"].includes(t)||(console.warn(`Niveau utilisateur invalide: ${t}, utilisation du niveau interm\xe9diaire par d\xe9faut`),t="intermediate"),console.info(`G\xe9n\xe9ration des templates HIIT avec FTP=${r}W et level=${t}`);const n=[];try{"beginner"===t?(n.push({id:"hiit-beginner-1",name:"Pyramid de R\xe9cup\xe9ration",description:v("beginnerPyramidDesc","Intervalles de dur\xe9e progressive adapt\xe9s aux d\xe9butants"),difficulty:1,duration:30,intervals:M(r,.7,.85,30,60,60,[30,60,90,60,30])}),n.push({id:"hiit-beginner-2",name:"Intervalles D\xe9butant",description:v("beginnerIntervalsDesc","Intervalles courts \xe0 intensit\xe9 mod\xe9r\xe9e pour d\xe9butants"),difficulty:1,duration:35,intervals:S(r,.75,45,90,6)})):"intermediate"===t?(n.push({id:"hiit-intermediate-1",name:"Ladder Classique",description:v("intervalLadderDesc","Intervalles en \xe9chelle pour am\xe9liorer l'endurance et la puissance"),difficulty:2,duration:45,intervals:T(r,.85,.95,[30,60,90,120,120,90,60,30],60)}),n.push({id:"hiit-intermediate-2",name:"Over-Under 90/105",description:v("overUnderDesc","Alternance d'intensit\xe9 pour stimuler le seuil lactique"),difficulty:2,duration:40,intervals:W(r,.9,1.05,180,30,4)})):"advanced"===t?(n.push({id:"hiit-advanced-1",name:"VO2max Intense",description:v("vo2maxDesc","Stimulation intense de VO2max avec intervalles courts \xe0 haute intensit\xe9"),difficulty:3,duration:50,intervals:S(r,1.1,30,30,10,3)}),n.push({id:"hiit-advanced-2",name:"Pyramide Avanc\xe9e",description:v("advancedPyramidDesc","Pyramide difficile pour cyclistes avanc\xe9s"),difficulty:3,duration:60,intervals:M(r,.9,1.1,30,180,60,[30,60,120,180,120,60,30])})):"elite"===t&&(n.push({id:"hiit-elite-1",name:"Sprints Supramaximaux",description:v("sprintsDesc","Sprints courts tr\xe8s intenses pour cyclistes de comp\xe9tition"),difficulty:3,duration:45,intervals:S(r,1.3,15,45,12,3)}),n.push({id:"hiit-elite-2",name:"Over-Under Elite",description:v("eliteOverUnderDesc","Over-under de comp\xe9tition pour cyclistes d'\xe9lite"),difficulty:3,duration:65,intervals:W(r,.95,1.2,240,30,5)})),n.push({id:"hiit-common-1",name:"30/30 Classique",description:v("thirtyThirtyDesc","Intervalles 30/30 classiques pour tous niveaux"),difficulty:"beginner"===t?2:1,duration:40,intervals:S(r,"beginner"===t?.9:"intermediate"===t?1:1.05,30,30,10,2)})}catch(P){console.error("Erreur lors de la g\xe9n\xe9ration des templates HIIT",P),x.error("Erreur lors de la g\xe9n\xe9ration des templates",P,{details:"Un template par d\xe9faut a \xe9t\xe9 fourni \xe0 la place"}),n.push({id:"hiit-fallback",name:"Entra\xeenement par D\xe9faut",description:"Entra\xeenement par intervalles standard",difficulty:1,duration:30,intervals:S(r||200,.8,60,60,5)})}const a=n.filter((e=>e.intervals&&Array.isArray(e.intervals)&&e.intervals.length>0));return 0===a.length&&(console.error("Aucun template valide n'a pu \xeatre g\xe9n\xe9r\xe9"),x.warning("Aucun template valide n'a pu \xeatre g\xe9n\xe9r\xe9, utilisation d'un template de secours"),a.push({id:"hiit-emergency",name:"Intervalles Simples",description:"Entra\xeenement par intervalles de base",difficulty:1,duration:20,intervals:[{type:"work",power:Math.round(.75*(r||200)),duration:60,restDuration:60},{type:"work",power:Math.round(.75*(r||200)),duration:60,restDuration:60},{type:"work",power:Math.round(.75*(r||200)),duration:60,restDuration:60},{type:"work",power:Math.round(.75*(r||200)),duration:60,restDuration:0}]})),a},S=function(e,t,r,n,a){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;(!e||e<=0)&&(console.error("FTP invalide pour la g\xe9n\xe9ration d'intervalles"),e=200),(t<=0||t>2)&&(console.warn(`Facteur d'intensit\xe9 invalide (${t}), utilisation d'une valeur par d\xe9faut (0.8)`),t=.8),r<=0&&(r=30),n<0&&(n=30),a<=0&&(a=5),s<=0&&(s=1);const i=[],l=Math.round(e*t);for(let o=0;o<s;o++){o>0&&i.push({power:Math.round(.4*e),duration:120,type:"rest",setRest:!0});for(let t=0;t<a;t++)i.push({power:l,duration:r,type:"work"}),(t<a-1||o<s-1)&&i.push({power:Math.round(.4*e),duration:n,type:"rest"})}return i},M=(e,t,r,n,a,s,i)=>{(!e||e<=0)&&(e=200),(t<=0||t>2)&&(t=.7),(r<=0||r>2||r<t)&&(r=t+.2),n<=0&&(n=30),(a<=0||a<n)&&(a=2*n),s<0&&(s=30);const l=[];if(Array.isArray(i)&&i.length>0){const n=i.length;i.forEach(((a,o)=>{const d=t+o/(n-1)*(r-t);l.push({power:Math.round(e*d),duration:a,type:"work"}),o<i.length-1&&l.push({power:Math.round(.4*e),duration:s,type:"rest"})}))}return l},T=(e,t,r,n,a)=>{(!e||"number"!==typeof e||e<=0)&&(console.error("FTP invalide dans generateLadderIntervals",{ftp:e}),e=200),("number"!==typeof t||t<=0||t>1.5)&&(console.error("Intensit\xe9 minimale invalide dans generateLadderIntervals",{minIntensity:t}),t=.75),("number"!==typeof r||r<=0||r>1.5||r<t)&&(console.error("Intensit\xe9 maximale invalide dans generateLadderIntervals",{maxIntensity:r}),r=t+.1),Array.isArray(n)&&0!==n.length||(console.error("Dur\xe9es invalides dans generateLadderIntervals",{durations:n}),n=[30,60,90]),("number"!==typeof a||a<0)&&(console.error("Dur\xe9e de repos invalide dans generateLadderIntervals",{restDuration:a}),a=60);const s=[],i=n.length,l=(r-t)/(i-1||1);return n.forEach(((r,i)=>{("number"!==typeof r||r<=0)&&(console.warn(`Dur\xe9e invalide \xe0 l'index ${i}`,{duration:r}),r=30);const o=t+l*i,d=Math.round(e*o);s.push({type:"work",power:d,intensity:o,duration:r,restDuration:i<n.length-1?a:0})})),s},W=(e,t,r,n,a,s)=>{(!e||"number"!==typeof e||e<=0)&&(console.error("FTP invalide dans generateOverUnderIntervals",{ftp:e}),e=200),("number"!==typeof t||t<=0||t>1.2)&&(console.error("Intensit\xe9 basse invalide dans generateOverUnderIntervals",{lowerIntensity:t}),t=.85),("number"!==typeof r||r<=0||r>1.5||r<=t)&&(console.error("Intensit\xe9 haute invalide dans generateOverUnderIntervals",{higherIntensity:r}),r=t+.1),("number"!==typeof n||n<=0)&&(console.error("Dur\xe9e totale invalide dans generateOverUnderIntervals",{totalDuration:n}),n=300),("number"!==typeof a||a<=0||a>=n)&&(console.error("Temps de changement invalide dans generateOverUnderIntervals",{switchTime:a}),a=30),("number"!==typeof s||s<=0)&&(console.error("Nombre d'intervalles invalide dans generateOverUnderIntervals",{count:s}),s=4);const i=[],l=Math.round(e*t),o=Math.round(e*r),d=Math.round(n/2);for(let c=0;c<s;c++)i.push({type:"over-under",power:l,secondaryPower:o,intensity:t,secondaryIntensity:r,duration:n,switchTime:a,restDuration:c<s-1?d:0});return i},E=(e,r,n)=>{if(e<0||!y||!y.intervals)return console.error("Index invalide ou template non disponible",{index:e,customizedTemplate:y}),void x.error("Impossible de modifier l'intervalle",{details:"Donn\xe9es d'intervalle non disponibles"});if(!y.intervals[e])return console.error("Intervalle non trouv\xe9 \xe0 l'index sp\xe9cifi\xe9",{index:e,intervals:y.intervals}),void x.error("Intervalle non trouv\xe9");const a=JSON.parse(JSON.stringify(y));let s=parseFloat(n);if(isNaN(s))if(console.warn(`Valeur non num\xe9rique entr\xe9e pour ${r}:`,n),x.warning("Valeur invalide pour "+("power"===r?"la puissance":"la dur\xe9e")),"power"===r)s=a.intervals[e].power||0;else{if("duration"!==r&&"restDuration"!==r)return;s=a.intervals[e][r]||0}if("power"===r){const r=(null===t||void 0===t?void 0:t.ftp)||200,n=h.Ay.validateFTP(r,t),i=Math.round(.5*n),l=Math.round(1.5*n);s<i?(console.warn(`Puissance trop basse (${s}W), limit\xe9e \xe0 ${i}W`),x.info(`Puissance ajust\xe9e au minimum (${i}W)`),s=i):s>l&&(console.warn(`Puissance trop \xe9lev\xe9e (${s}W), limit\xe9e \xe0 ${l}W`),x.info(`Puissance ajust\xe9e au maximum (${l}W)`),s=l),a.intervals[e].intensity=parseFloat((s/n).toFixed(2))}else"duration"!==r&&"restDuration"!==r||(s<5?(console.warn(`Dur\xe9e trop courte (${s}s), limit\xe9e \xe0 5s`),x.info("Dur\xe9e ajust\xe9e au minimum (5s)"),s=5):s>600&&(console.warn(`Dur\xe9e trop longue (${s}s), limit\xe9e \xe0 600s`),x.info("Dur\xe9e ajust\xe9e au maximum (10 minutes)"),s=600));a.intervals[e][r]=s,a.duration=$(a.intervals),k(a)},$=e=>{if(!e||!Array.isArray(e))return console.error("Intervalles invalides pour le calcul de dur\xe9e",{intervals:e}),x.error("Erreur lors du calcul de la dur\xe9e"),0;try{const t=e.reduce(((e,t)=>e+("number"===typeof t.duration?t.duration:0)+("number"===typeof t.restDuration?t.restDuration:0)),0),r=t+300;return Math.ceil(r/60)}catch(P){return console.error("Erreur lors du calcul de la dur\xe9e de l'entra\xeenement",P),x.error("Erreur lors du calcul de la dur\xe9e",P),0}};return P?(0,p.jsx)("div",{className:"hiit-templates-error",children:(0,p.jsxs)("div",{className:"alert alert-danger",children:[(0,p.jsx)("h4",{children:"Erreur :"}),(0,p.jsx)("p",{children:P}),(0,p.jsx)("button",{className:"btn btn-primary mt-3",onClick:()=>D(null),children:"R\xe9essayer"})]})}):b?(0,p.jsx)("div",{className:"hiit-templates-loading",children:v("loadingTemplates","Chargement des templates...")}):(0,p.jsxs)("div",{className:"hiit-templates",children:[(0,p.jsxs)("div",{className:"templates-list",children:[(0,p.jsx)("h3",{children:v("availableTemplates","Templates disponibles")}),(0,p.jsx)("div",{className:"templates-grid",children:j.map((e=>(0,p.jsxs)("div",{className:"template-card "+((null===g||void 0===g?void 0:g.id)===e.id?"selected":""),onClick:()=>(e=>{try{if(!e)throw new Error("Template invalide");w(e),k(JSON.parse(JSON.stringify(e)))}catch(P){console.error("Erreur lors de la s\xe9lection du template:",P),D(`Erreur lors de la s\xe9lection du template: ${P.message}`)}})(e),children:[(0,p.jsx)("h4",{children:e.name}),(0,p.jsxs)("div",{className:"template-difficulty",children:[Array(e.difficulty).fill().map(((e,t)=>(0,p.jsx)("span",{className:"difficulty-star",children:"\u2605"},t))),Array(3-e.difficulty).fill().map(((e,t)=>(0,p.jsx)("span",{className:"difficulty-star empty",children:"\u2606"},t)))]}),(0,p.jsxs)("div",{className:"template-duration",children:[e.duration," ",v("min","min")]}),(0,p.jsx)("div",{className:"template-description",children:e.description})]},e.id)))})]}),y&&(0,p.jsxs)("div",{className:"template-customization",children:[(0,p.jsx)("h3",{children:v("customizeWorkout","Personnaliser l'entra\xeenement")}),(e=>{try{if(!e||!Array.isArray(e)||0===e.length)return(0,p.jsx)("div",{className:"visualization-error",children:"Intervalles non disponibles"});const t=e.map(((e,t)=>({name:`${t+1}`,power:e.power||0,type:e.type||"work"}))),r=e=>"work"===e.type?"#ff4757":"rest"===e.type?"#2ed573":e.setRest?"#1e90ff":"#ffa502";return(0,p.jsxs)("div",{className:"interval-visualization",children:[(0,p.jsx)("h4",{children:v("powerProfile","Profil de puissance")}),(0,p.jsx)(s.u,{width:"100%",height:200,children:(0,p.jsxs)(i.E,{data:t,margin:{top:5,right:5,bottom:5,left:5},children:[(0,p.jsx)(l.d,{strokeDasharray:"3 3"}),(0,p.jsx)(o.W,{dataKey:"name"}),(0,p.jsx)(d.h,{domain:[0,"dataMax + 20"]}),(0,p.jsx)(c.m,{formatter:e=>[`${e}W`,"Puissance"],labelFormatter:e=>`Intervalle ${e}`}),(0,p.jsx)(u.y,{dataKey:"power",name:"Puissance",fill:"#8884d8",stroke:"#8884d8",fillOpacity:.8,barSize:20,isAnimationActive:!1,data:t,children:t.map(((e,t)=>(0,p.jsx)(Cell,{fill:r(e)},`cell-${t}`)))})]})})]})}catch(P){return console.error("Erreur lors de la g\xe9n\xe9ration de la visualisation:",P),(0,p.jsxs)("div",{className:"visualization-error",children:["Erreur d'affichage: ",P.message]})}})(y.intervals),(0,p.jsxs)("div",{className:"intervals-table",children:[(0,p.jsx)("h4",{children:v("intervals","Intervalles")}),(0,p.jsxs)("table",{children:[(0,p.jsx)("thead",{children:(0,p.jsxs)("tr",{children:[(0,p.jsx)("th",{children:"#"}),(0,p.jsx)("th",{children:v("power","Puissance")}),(0,p.jsx)("th",{children:v("duration","Dur\xe9e")}),(0,p.jsx)("th",{children:v("rest","R\xe9cup\xe9ration")})]})}),(0,p.jsx)("tbody",{children:y.intervals.map(((e,r)=>(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{children:r+1}),(0,p.jsxs)("td",{children:[(0,p.jsx)("input",{type:"number",value:e.power,onChange:e=>E(r,"power",e.target.value),min:Math.round(.5*(null===t||void 0===t?void 0:t.ftp))||100,max:Math.round(1.5*(null===t||void 0===t?void 0:t.ftp))||400}),(0,p.jsx)("span",{children:"W"})]}),(0,p.jsxs)("td",{children:[(0,p.jsx)("input",{type:"number",value:e.duration,onChange:e=>E(r,"duration",e.target.value),min:10,max:600}),(0,p.jsx)("span",{children:v("sec","sec")})]}),(0,p.jsxs)("td",{children:[(0,p.jsx)("input",{type:"number",value:e.restDuration||0,onChange:e=>E(r,"restDuration",e.target.value),min:0,max:600}),(0,p.jsx)("span",{children:v("sec","sec")})]})]},r)))})]})]}),(0,p.jsxs)("div",{className:"template-actions",children:[(0,p.jsx)("button",{className:"template-save-button",onClick:()=>{try{if(!y)throw new Error("Aucun template n'est s\xe9lectionn\xe9");const e={.6:1,.75:2,.85:3,.95:4,1.05:5,1.2:6,1.5:7};let n=0,a=0;y.intervals.forEach((e=>{if("work"===e.type||!e.type){const r=e.intensity||e.power/((null===t||void 0===t?void 0:t.ftp)||200),s=e.duration||0;n+=r*s,a+=s}}));const s=n/(a||1);let i=3;for(const[t,r]of Object.entries(e))if(s<=parseFloat(t)){i=r;break}const l={...y,targetZone:i,date:(new Date).toISOString(),userId:null===t||void 0===t?void 0:t.id};r(l)&&x.success("L'entra\xeenement a \xe9t\xe9 enregistr\xe9 avec succ\xe8s",{title:"Sauvegarde r\xe9ussie"})}catch(P){console.error("Erreur lors de la sauvegarde de l'entra\xeenement",P),x.error("Impossible de sauvegarder l'entra\xeenement",P)}},children:v("saveWorkout","Enregistrer")}),(0,p.jsx)("button",{className:"template-reset-button",onClick:()=>k({...g}),children:v("resetChanges","R\xe9initialiser")})]})]})]})};var x=r(80150),j=r(10961),f=r(94382),g=r(80444),w=r(96078),y=r(77743),k=r(83602),b=r(48384),N=r(58768),P=r(89963),D=r(90952);const I=e=>{let{userProfile:t,workouts:r}=e;const{t:m}=(0,a.Bd)(),[h,v]=(0,n.useState)("month"),[I,S]=(0,n.useState)("power"),[M,T]=(0,n.useState)([]);(0,n.useEffect)((()=>{if(!r||0===r.length)return void T([]);const e=new Date;let t=new Date;switch(h){case"week":t.setDate(e.getDate()-7);break;case"month":default:t.setMonth(e.getMonth()-1);break;case"quarter":t.setMonth(e.getMonth()-3);break;case"year":t.setFullYear(e.getFullYear()-1)}const n=r.filter((e=>new Date(e.date)>=t));n.sort(((e,t)=>new Date(e.date)-new Date(t.date))),T(n)}),[r,h]);const W=(()=>{if(0===M.length)return{totalWorkouts:0,totalDuration:0,avgPower:0,maxPower:0,totalTSS:0,workoutTypes:[]};const e=M.length,t=M.reduce(((e,t)=>e+t.duration),0),r=M.filter((e=>{var t;return null===(t=e.metrics)||void 0===t?void 0:t.averagePower})),n=r.length?Math.round(r.reduce(((e,t)=>e+t.metrics.averagePower),0)/r.length):0,a=r.length?Math.max(...r.map((e=>e.metrics.normalizedPower||e.metrics.averagePower))):0,s=M.reduce(((e,t)=>e+(t.tss||0)),0),i={};M.forEach((e=>{i[e.type]=(i[e.type]||0)+1}));return{totalWorkouts:e,totalDuration:t,avgPower:n,maxPower:a,totalTSS:s,workoutTypes:Object.entries(i).map((e=>{let[t,r]=e;return{name:t,value:r}}))}})(),E=e=>{const t=new Date(e);t.setHours(0,0,0,0),t.setDate(t.getDate()+3-(t.getDay()+6)%7);const r=new Date(t.getFullYear(),0,4);return 1+Math.round(((t-r)/864e5-3+(r.getDay()+6)%7)/7)},$=0===M.length?[]:M.map((e=>{var t,r,n,a;let s=0;switch(I){case"power":s=(null===(t=e.metrics)||void 0===t?void 0:t.normalizedPower)||(null===(r=e.metrics)||void 0===r?void 0:r.averagePower)||0;break;case"tss":s=e.tss||0;break;case"duration":s=e.duration||0;break;case"heartrate":s=(null===(n=e.metrics)||void 0===n?void 0:n.averageHr)||0;break;default:s=(null===(a=e.metrics)||void 0===a?void 0:a.averagePower)||0}const i=new Date(e.date);return{date:`${i.getDate()}/${i.getMonth()+1}`,value:s,type:e.type}})),A=(()=>{if(0===M.length)return[];const e={};return M.forEach((t=>{e[t.type]=(e[t.type]||0)+1})),Object.entries(e).map((e=>{let[t,r]=e;return{name:t,value:r}}))})(),C=(()=>{if(0===M.length)return[];const e={};return M.forEach((t=>{const r=new Date(t.date),n=`W${E(r)}`;e[n]||(e[n]=0),e[n]+=t.tss||0})),Object.entries(e).map((e=>{let[t,r]=e;return{name:t,value:r}}))})(),H=(()=>{if(!t||0===M.length)return[];const e=M.filter((e=>"endurance"===e.type||e.duration>=90)),r=e.length?Math.min(100,e.reduce(((e,t)=>e+t.duration),0)/10):20,n=M.filter((e=>"hiit"===e.type)),a=n.length?Math.min(100,n.reduce(((e,t)=>e+(t.tss||50)),0)/5):20,s=Math.min(100,10*M.length),i=M.filter((e=>{var t;return null===(t=e.metrics)||void 0===t?void 0:t.normalizedPower})),l=i.length&&t.ftp?Math.min(100,Math.max(...i.map((e=>e.metrics.normalizedPower)))/t.ftp*80):20,o=100-Math.min(100,W.totalTSS/10);return[{subject:m("endurance"),A:r,fullMark:100},{subject:m("intensity"),A:a,fullMark:100},{subject:m("consistency"),A:s,fullMark:100},{subject:m("power"),A:l,fullMark:100},{subject:m("recovery"),A:o,fullMark:100}]})(),O={hiit:"#f44336",endurance:"#4caf50",strength:"#2196f3",recovery:"#ff9800",default:"#9c27b0"};return 0===M.length?(0,p.jsxs)("div",{className:"performance-tracker",children:[(0,p.jsx)("div",{className:"tracker-controls",children:(0,p.jsxs)("div",{className:"timeframe-selector",children:[(0,p.jsxs)("label",{children:[m("timeframe"),":"]}),(0,p.jsxs)("select",{value:h,onChange:e=>v(e.target.value),children:[(0,p.jsx)("option",{value:"week",children:m("lastWeek")}),(0,p.jsx)("option",{value:"month",children:m("lastMonth")}),(0,p.jsx)("option",{value:"quarter",children:m("lastQuarter")}),(0,p.jsx)("option",{value:"year",children:m("lastYear")})]})]})}),(0,p.jsx)("div",{className:"no-workouts-message",children:m("noWorkoutsInTimeframe")})]}):(0,p.jsxs)("div",{className:"performance-tracker",children:[(0,p.jsxs)("div",{className:"tracker-controls",children:[(0,p.jsxs)("div",{className:"timeframe-selector",children:[(0,p.jsxs)("label",{children:[m("timeframe"),":"]}),(0,p.jsxs)("select",{value:h,onChange:e=>v(e.target.value),children:[(0,p.jsx)("option",{value:"week",children:m("lastWeek")}),(0,p.jsx)("option",{value:"month",children:m("lastMonth")}),(0,p.jsx)("option",{value:"quarter",children:m("lastQuarter")}),(0,p.jsx)("option",{value:"year",children:m("lastYear")})]})]}),(0,p.jsxs)("div",{className:"metric-selector",children:[(0,p.jsxs)("label",{children:[m("metric"),":"]}),(0,p.jsxs)("select",{value:I,onChange:e=>S(e.target.value),children:[(0,p.jsx)("option",{value:"power",children:m("power")}),(0,p.jsx)("option",{value:"tss",children:m("tss")}),(0,p.jsx)("option",{value:"duration",children:m("duration")}),(0,p.jsx)("option",{value:"heartrate",children:m("heartRate")})]})]})]}),(0,p.jsxs)("div",{className:"performance-stats",children:[(0,p.jsxs)("div",{className:"stat-card",children:[(0,p.jsx)("div",{className:"stat-value",children:W.totalWorkouts}),(0,p.jsx)("div",{className:"stat-label",children:m("workouts")})]}),(0,p.jsxs)("div",{className:"stat-card",children:[(0,p.jsx)("div",{className:"stat-value",children:W.totalDuration}),(0,p.jsx)("div",{className:"stat-label",children:m("minutes")})]}),(0,p.jsxs)("div",{className:"stat-card",children:[(0,p.jsxs)("div",{className:"stat-value",children:[W.avgPower,"W"]}),(0,p.jsx)("div",{className:"stat-label",children:m("avgPower")})]}),(0,p.jsxs)("div",{className:"stat-card",children:[(0,p.jsx)("div",{className:"stat-value",children:W.totalTSS}),(0,p.jsx)("div",{className:"stat-label",children:m("totalTSS")})]})]}),(0,p.jsxs)("div",{className:"charts-grid",children:[(0,p.jsxs)("div",{className:"chart-container",children:[(0,p.jsx)("h3",{children:`${m(I)} ${m("overTime")}`}),(0,p.jsx)(s.u,{width:"100%",height:250,children:(0,p.jsxs)(x.b,{data:$,children:[(0,p.jsx)(l.d,{strokeDasharray:"3 3"}),(0,p.jsx)(o.W,{dataKey:"date"}),(0,p.jsx)(d.h,{}),(0,p.jsx)(c.m,{formatter:e=>[`${e} ${"duration"===I?m("min"):"tss"===I?"":"W"}`,m(I)]}),(0,p.jsx)(j.s,{}),(0,p.jsx)(f.N,{type:"monotone",dataKey:"value",stroke:"#8884d8",strokeWidth:2,dot:{fill:"#8884d8",strokeWidth:2},activeDot:{r:8}})]})})]}),(0,p.jsxs)("div",{className:"chart-container",children:[(0,p.jsx)("h3",{children:m("workoutTypes")}),(0,p.jsx)(s.u,{width:"100%",height:250,children:(0,p.jsxs)(g.r,{children:[(0,p.jsx)(w.F,{data:A,cx:"50%",cy:"50%",labelLine:!1,outerRadius:80,fill:"#8884d8",dataKey:"value",nameKey:"name",label:e=>{let{name:t,percent:r}=e;return`${m(t)} ${(100*r).toFixed(0)}%`},children:A.map(((e,t)=>{return(0,p.jsx)(y.f,{fill:(r=e.name,O[r]||O.default)},`cell-${t}`);var r}))}),(0,p.jsx)(c.m,{formatter:(e,t)=>[e,m(t)]})]})})]}),(0,p.jsxs)("div",{className:"chart-container",children:[(0,p.jsx)("h3",{children:m("weeklyTrainingLoad")}),(0,p.jsx)(s.u,{width:"100%",height:250,children:(0,p.jsxs)(i.E,{data:C,children:[(0,p.jsx)(l.d,{strokeDasharray:"3 3"}),(0,p.jsx)(o.W,{dataKey:"name"}),(0,p.jsx)(d.h,{}),(0,p.jsx)(c.m,{formatter:e=>[e,m("tss")]}),(0,p.jsx)(u.y,{dataKey:"value",fill:"#ff7043"})]})})]}),(0,p.jsxs)("div",{className:"chart-container",children:[(0,p.jsx)("h3",{children:m("performanceProfile")}),(0,p.jsx)(s.u,{width:"100%",height:250,children:(0,p.jsxs)(k.V,{cx:"50%",cy:"50%",outerRadius:"80%",data:H,children:[(0,p.jsx)(b.z,{}),(0,p.jsx)(N.r,{dataKey:"subject"}),(0,p.jsx)(P.E,{angle:30,domain:[0,100]}),(0,p.jsx)(D.V,{name:m("currentPerformance"),dataKey:"A",stroke:"#8884d8",fill:"#8884d8",fillOpacity:.6}),(0,p.jsx)(c.m,{formatter:e=>[e,m("score")]})]})})]})]}),(0,p.jsxs)("div",{className:"workout-history",children:[(0,p.jsx)("h3",{children:m("recentWorkouts")}),(0,p.jsxs)("table",{className:"workout-table",children:[(0,p.jsx)("thead",{children:(0,p.jsxs)("tr",{children:[(0,p.jsx)("th",{children:m("date")}),(0,p.jsx)("th",{children:m("type")}),(0,p.jsx)("th",{children:m("duration")}),(0,p.jsx)("th",{children:m("power")}),(0,p.jsx)("th",{children:m("tss")})]})}),(0,p.jsx)("tbody",{children:M.slice(-5).reverse().map(((e,t)=>{var r;return(0,p.jsxs)("tr",{children:[(0,p.jsx)("td",{children:e.date}),(0,p.jsx)("td",{children:m(e.type)}),(0,p.jsxs)("td",{children:[e.duration," ",m("min")]}),(0,p.jsxs)("td",{children:[(null===(r=e.metrics)||void 0===r?void 0:r.averagePower)||"-"," W"]}),(0,p.jsx)("td",{children:e.tss||"-"})]},t)}))})]})]})]})};var S=r(15031);r(21847);const M=e=>{var t;let{userProfile:r,workouts:s,onSaveWorkout:i}=e;const{t:l}=(0,a.Bd)(),[o,d]=(0,n.useState)(new Date),[c,u]=(0,n.useState)([]),[m,h]=(0,n.useState)([]),[v,x]=(0,n.useState)(null),[j,f]=(0,n.useState)(!1),[g,w]=(0,n.useState)(!0);(0,n.useEffect)((()=>{(async()=>{w(!0);try{await new Promise((e=>setTimeout(e,300)));const e=y(r);h(e);const t=k();u(t),e.length>0&&x(e[0])}catch(e){console.error("Error loading workout plans:",e)}finally{w(!1)}})()}),[r]);const y=e=>{if(!e)return[];const{level:t,ftp:r,preferences:n}=e,a=(null===n||void 0===n?void 0:n.focusAreas)||["endurance"],s=[{id:"recovery-ride",name:l("recoveryRide"),type:"recovery",description:l("recoveryRideDesc"),duration:30,intensity:"low",metrics:{targetPower:Math.round(.6*r),targetHr:"beginner"===t?120:130}},{id:"endurance-ride",name:l("enduranceRide"),type:"endurance",description:l("enduranceRideDesc"),duration:90,intensity:"medium-low",metrics:{targetPower:Math.round(.75*r),targetHr:"beginner"===t?130:140}},{id:"tempo-ride",name:l("tempoRide"),type:"endurance",description:l("tempoRideDesc"),duration:60,intensity:"medium",metrics:{targetPower:Math.round(.85*r),targetHr:"beginner"===t?140:150}},{id:"sweet-spot",name:l("sweetSpot"),type:"hiit",description:l("sweetSpotDesc"),duration:75,intensity:"medium-high",metrics:{targetPower:Math.round(.9*r),targetHr:"beginner"===t?150:160}},{id:"threshold",name:l("threshold"),type:"hiit",description:l("thresholdDesc"),duration:60,intensity:"high",metrics:{targetPower:Math.round(.95*r),targetHr:"beginner"===t?160:170}},{id:"vo2max",name:l("vo2max"),type:"hiit",description:l("vo2maxDesc"),duration:45,intensity:"very-high",metrics:{targetPower:Math.round(1.1*r),targetHr:"beginner"===t?170:180}}];return a.includes("climbing")&&s.push({id:"climbing",name:l("climbingWorkout"),type:"hiit",description:l("climbingWorkoutDesc"),duration:60,intensity:"high",metrics:{targetPower:Math.round(.93*r),targetHr:"beginner"===t?160:170}}),a.includes("sprinting")&&s.push({id:"sprint",name:l("sprintWorkout"),type:"hiit",description:l("sprintWorkoutDesc"),duration:45,intensity:"very-high",metrics:{targetPower:Math.round(1.3*r),targetHr:"beginner"===t?170:180}}),s},k=()=>{const e=new Date,t=[];for(let r=1;r<=10;r++){if(r%3===0)continue;const n=new Date;n.setDate(e.getDate()+r),t.push({id:`planned-${r}`,date:n.toISOString().split("T")[0],templateId:r%5===0?"recovery-ride":r%4===0?"threshold":r%3===0?"endurance-ride":r%2===0?"sweet-spot":"tempo-ride",name:l(r%5===0?"recoveryRide":r%4===0?"threshold":r%3===0?"enduranceRide":r%2===0?"sweetSpot":"tempoRide"),type:r%4===0||r%2===0?"hiit":"endurance",duration:r%5===0?30:r%3===0?90:60,notes:""})}return t},b=()=>{f(!0)},N=e=>{u(c.filter((t=>t.id!==e)))},P=e=>{switch(e){case"low":return"intensity-low";case"medium-low":return"intensity-medium-low";case"medium":default:return"intensity-medium";case"medium-high":return"intensity-medium-high";case"high":return"intensity-high";case"very-high":return"intensity-very-high"}};if(g)return(0,p.jsx)("div",{className:"workout-planner-loading",children:l("loadingWorkoutPlanner")});const D=o.toISOString().split("T")[0],I=c.filter((e=>e.date===D));return(0,p.jsxs)("div",{className:"workout-planner",children:[(0,p.jsxs)("div",{className:"planner-main",children:[(0,p.jsx)("div",{className:"planner-calendar",children:(0,p.jsx)(S.Ay,{onChange:e=>{d(e),f(!1)},value:o,tileContent:e=>{let{date:t,view:r}=e;if("month"!==r)return null;const n=(e=>{const t=e.toISOString().split("T")[0];return c.filter((e=>e.date===t))})(t);return 0===n.length?null:(0,p.jsx)("div",{className:"workout-date-indicator",children:n.map(((e,t)=>(0,p.jsx)("div",{className:`workout-indicator ${e.type}`,title:e.name},t)))})},minDate:new Date})}),(0,p.jsxs)("div",{className:"planner-details",children:[(0,p.jsxs)("h3",{children:[l("selectedDate"),": ",D]}),0===I.length?(0,p.jsxs)("div",{className:"no-workouts",children:[(0,p.jsx)("p",{children:l("noWorkoutsPlanned")}),(0,p.jsxs)("button",{className:"add-workout-button",onClick:b,children:[(0,p.jsx)("i",{className:"fas fa-plus"})," ",l("addWorkout")]})]}):(0,p.jsxs)("div",{className:"date-workouts",children:[(0,p.jsx)("h4",{children:l("plannedWorkouts")}),I.map(((e,t)=>(0,p.jsxs)("div",{className:"planned-workout-card",children:[(0,p.jsxs)("div",{className:"workout-header",children:[(0,p.jsx)("h5",{children:e.name}),(0,p.jsxs)("div",{className:"workout-actions",children:[(0,p.jsx)("button",{className:"start-workout-button",onClick:()=>(e=>{var t,n,a,s,o;const d=m.find((t=>t.id===e.templateId));if(!d)return;const c={type:e.type,templateId:e.templateId,name:e.name,duration:e.duration,tss:Math.round(e.duration*((null===(t=d.metrics)||void 0===t?void 0:t.targetPower)/((null===r||void 0===r?void 0:r.ftp)||200))*100/60),metrics:{averagePower:(null===(n=d.metrics)||void 0===n?void 0:n.targetPower)||200,normalizedPower:Math.round(1.05*((null===(a=d.metrics)||void 0===a?void 0:a.targetPower)||200)),averageHr:(null===(s=d.metrics)||void 0===s?void 0:s.targetHr)||150,maxHr:Math.round(1.1*((null===(o=d.metrics)||void 0===o?void 0:o.targetHr)||150)),calories:Math.round(10*e.duration),elevation:0},intervals:[]};var u,h,p;"hiit"===e.type&&(c.intervals=[{power:Math.round(1.1*(null===(u=d.metrics)||void 0===u?void 0:u.targetPower)),duration:180,rest:120},{power:Math.round(1.15*(null===(h=d.metrics)||void 0===h?void 0:h.targetPower)),duration:180,rest:120},{power:Math.round(1.2*(null===(p=d.metrics)||void 0===p?void 0:p.targetPower)),duration:180,rest:120}]),i(c),N(e.id),alert(l("workoutStarted"))})(e),children:(0,p.jsx)("i",{className:"fas fa-play"})}),(0,p.jsx)("button",{className:"remove-workout-button",onClick:()=>N(e.id),children:(0,p.jsx)("i",{className:"fas fa-trash"})})]})]}),(0,p.jsx)("div",{className:"workout-type",children:l(e.type)}),(0,p.jsxs)("div",{className:"workout-duration",children:[e.duration," ",l("min")]}),e.notes&&(0,p.jsx)("div",{className:"workout-notes",children:e.notes})]},t))),(0,p.jsxs)("button",{className:"add-workout-button",onClick:b,children:[(0,p.jsx)("i",{className:"fas fa-plus"})," ",l("addAnotherWorkout")]})]}),j&&(0,p.jsxs)("div",{className:"add-workout-form",children:[(0,p.jsxs)("h4",{children:[l("addWorkoutTo")," ",D]}),(0,p.jsxs)("div",{className:"template-selector",children:[(0,p.jsx)("h5",{children:l("selectWorkoutTemplate")}),(0,p.jsx)("div",{className:"templates-grid",children:m.map(((e,t)=>(0,p.jsxs)("div",{className:`template-card ${(null===v||void 0===v?void 0:v.id)===e.id?"selected":""} ${e.type}`,onClick:()=>(e=>{x(e)})(e),children:[(0,p.jsx)("h5",{children:e.name}),(0,p.jsx)("div",{className:`template-intensity ${P(e.intensity)}`,children:l(e.intensity)}),(0,p.jsxs)("div",{className:"template-duration",children:[e.duration," ",l("min")]})]},t)))})]}),(0,p.jsxs)("div",{className:"workout-notes-input",children:[(0,p.jsxs)("label",{htmlFor:"workout-notes",children:[l("workoutNotes"),":"]}),(0,p.jsx)("textarea",{id:"workout-notes",rows:"3",placeholder:l("enterNotesPlaceholder")})]}),(0,p.jsxs)("div",{className:"form-actions",children:[(0,p.jsx)("button",{className:"save-workout-button",onClick:()=>{if(!v)return;const e=o.toISOString().split("T")[0],t={id:`planned-${Date.now()}`,date:e,templateId:v.id,name:v.name,type:v.type,duration:v.duration,notes:document.getElementById("workout-notes").value||""};u([...c,t]),f(!1)},disabled:!v,children:l("savePlannedWorkout")}),(0,p.jsx)("button",{className:"cancel-button",onClick:()=>f(!1),children:l("cancel")})]})]})]})]}),(0,p.jsxs)("div",{className:"training-recommendations",children:[(0,p.jsx)("h3",{children:l("trainingRecommendations")}),(0,p.jsxs)("div",{className:"recommendation-cards",children:[(0,p.jsxs)("div",{className:"recommendation-card",children:[(0,p.jsx)("h4",{children:l("weeklyTraining")}),(0,p.jsx)("p",{children:l("weeklyTrainingRecommendation")}),(0,p.jsxs)("ul",{children:[(0,p.jsxs)("li",{children:[l("hiitSessions"),": 2-3"]}),(0,p.jsxs)("li",{children:[l("enduranceSessions"),": 1-2"]}),(0,p.jsxs)("li",{children:[l("recoverySessions"),": 1"]}),(0,p.jsxs)("li",{children:[l("restDays"),": 2"]})]})]}),(0,p.jsxs)("div",{className:"recommendation-card",children:[(0,p.jsx)("h4",{children:l("monthlyCycle")}),(0,p.jsx)("p",{children:l("monthlyCycleRecommendation")}),(0,p.jsxs)("ul",{children:[(0,p.jsxs)("li",{children:[l("week1"),": ",l("buildPhase")]}),(0,p.jsxs)("li",{children:[l("week2"),": ",l("intensityPhase")]}),(0,p.jsxs)("li",{children:[l("week3"),": ",l("peakPhase")]}),(0,p.jsxs)("li",{children:[l("week4"),": ",l("recoveryPhase")]})]})]}),(0,p.jsxs)("div",{className:"recommendation-card",children:[(0,p.jsx)("h4",{children:l("focusAreas")}),(0,p.jsx)("p",{children:l("basedOnProfile")}),(0,p.jsx)("ul",{children:null===r||void 0===r||null===(t=r.preferences)||void 0===t?void 0:t.focusAreas.map(((e,t)=>(0,p.jsxs)("li",{children:[l(e),": ",l(`${e}Recommendation`)]},t)))})]})]})]})]})},T=e=>{let{userId:t,initialView:r="templates"}=e;const{t:s}=(0,a.Bd)(),[i,l]=(0,n.useState)(r),[o,d]=(0,n.useState)(null),[c,u]=(0,n.useState)([]),[m,h]=(0,n.useState)(!0);(0,n.useEffect)((()=>{(async()=>{try{h(!0),await new Promise((e=>setTimeout(e,500)));const e=[{id:"workout-1",date:"2025-03-28",type:"hiit",templateId:"hiit-1",duration:45,tss:65,metrics:{averagePower:230,normalizedPower:245,averageHr:152,maxHr:178,calories:540,elevation:320},intervals:[{power:240,duration:180,rest:120},{power:250,duration:180,rest:120},{power:255,duration:180,rest:120},{power:260,duration:180,rest:120},{power:265,duration:180,rest:120}]},{id:"workout-2",date:"2025-03-30",type:"endurance",templateId:"endurance-1",duration:120,tss:85,metrics:{averagePower:195,normalizedPower:210,averageHr:142,maxHr:158,calories:1240,elevation:850}},{id:"workout-3",date:"2025-04-01",type:"hiit",templateId:"hiit-2",duration:60,tss:75,metrics:{averagePower:235,normalizedPower:255,averageHr:155,maxHr:182,calories:680,elevation:420},intervals:[{power:250,duration:60,rest:60},{power:255,duration:60,rest:60},{power:260,duration:60,rest:60},{power:270,duration:60,rest:60},{power:275,duration:60,rest:60},{power:280,duration:60,rest:60},{power:285,duration:60,rest:60},{power:290,duration:60,rest:60}]}];d({id:t||"user-1",name:"Jean Cycliste",level:"intermediate",ftp:260,maxHr:185,restingHr:52,weight:72,preferences:{workoutDuration:60,focusAreas:["endurance","climbing"],outdoorRiding:!0}}),u(e)}catch(e){console.error("Error fetching user data:",e)}finally{h(!1)}})()}),[t]);const x=e=>{const t={...e,id:`workout-${Date.now()}`,date:(new Date).toISOString().split("T")[0]};return u((e=>[...e,t])),t};return(0,p.jsxs)("div",{className:"training-module",children:[(0,p.jsxs)("div",{className:"training-header",children:[(0,p.jsx)("h2",{children:s("trainingModule")}),o&&(0,p.jsxs)("div",{className:"user-profile-summary",children:[(0,p.jsx)("span",{className:"user-name",children:o.name}),(0,p.jsx)("span",{className:"user-level",children:s(o.level)}),(0,p.jsxs)("span",{className:"user-ftp",children:["FTP: ",o.ftp,"w"]})]})]}),(0,p.jsxs)("div",{className:"training-navigation",children:[(0,p.jsxs)("button",{className:"training-nav-button "+("templates"===i?"active":""),onClick:()=>l("templates"),children:[(0,p.jsx)("i",{className:"fas fa-th-large"}),s("hiitTemplates")]}),(0,p.jsxs)("button",{className:"training-nav-button "+("performance"===i?"active":""),onClick:()=>l("performance"),children:[(0,p.jsx)("i",{className:"fas fa-chart-line"}),s("performanceTracker")]}),(0,p.jsxs)("button",{className:"training-nav-button "+("planner"===i?"active":""),onClick:()=>l("planner"),children:[(0,p.jsx)("i",{className:"fas fa-calendar-alt"}),s("workoutPlanner")]})]}),(0,p.jsx)("div",{className:"training-content",children:(()=>{if(m)return(0,p.jsx)("div",{className:"training-module-loading",children:s("loadingTrainingData")});switch(i){case"templates":return(0,p.jsx)(v,{userProfile:o,onSaveWorkout:x});case"performance":return(0,p.jsx)(I,{userProfile:o,workouts:c});case"planner":return(0,p.jsx)(M,{userProfile:o,workouts:c,onSaveWorkout:x});default:return(0,p.jsx)("div",{children:s("selectTrainingView")})}})()})]})}}}]);
//# sourceMappingURL=7514.f9dad021.chunk.js.map