"use strict";(self.webpackChunkgrand_est_cyclisme_client=self.webpackChunkgrand_est_cyclisme_client||[]).push([[4507],{44836:(e,t,n)=>{n.d(t,{A:()=>j});var r=n(65043),s=n(79183),i=n(71985),a=n(31951),o=n(50007),l=n(29408),c=n(96446),d=n(81637),h=n(85865),m=n(63336),u=n(70579);const x=e=>{let{data:t,color:n="#444444"}=e;const s=(0,r.useRef)(),i=t.map((e=>new l.Vector3(e.x,e.y,e.z))),a=new l.CatmullRomCurve3(i),o=new l.TubeGeometry(a,100,.2,8,!1);return(0,u.jsxs)("mesh",{ref:s,children:[(0,u.jsx)("primitive",{object:o,attach:"geometry"}),(0,u.jsx)("meshStandardMaterial",{color:n,roughness:.6})]})},p=e=>{let{data:t}=e;const n=(0,r.useRef)(),s=Math.max(...t.map((e=>e.x)))+2,i=(Math.max(...t.map((e=>e.y))),Math.min(...t.map((e=>e.y)))-.5);return(0,u.jsxs)("mesh",{ref:n,rotation:[-Math.PI/2,0,0],position:[s/2,i-.1,0],children:[(0,u.jsx)("planeGeometry",{args:[1.5*s,10]}),(0,u.jsx)("meshStandardMaterial",{color:"#4b7f52",wireframe:!1})]})},f=e=>{let{position:t,name:n,type:s}=e;const[i,o]=(0,r.useState)(!1);let l;switch(s){case"viewpoint":l="#1E88E5";break;case"rest":l="#43A047";break;case"summit":l="#E53935";break;default:l="#FFC107"}return(0,u.jsxs)("group",{position:t,children:[(0,u.jsxs)("mesh",{onPointerOver:()=>o(!0),onPointerOut:()=>o(!1),children:[(0,u.jsx)("sphereGeometry",{args:[.15,16,16]}),(0,u.jsx)("meshStandardMaterial",{color:l})]}),i&&(0,u.jsx)(a.E,{position:[0,.3,0],color:"white",fontSize:.15,maxWidth:2,textAlign:"center",anchorX:"center",anchorY:"middle",outlineWidth:.01,outlineColor:"#000000",children:n})]})},g=e=>{let{data:t}=e;const{camera:n}=(0,s.D)(),i=Math.max(...t.map((e=>e.x))),a=Math.max(...t.map((e=>e.y)));return(0,r.useEffect)((()=>{n.position.set(i/2,2*a,5),n.lookAt(i/2,0,0)}),[n,i,a]),(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(o.N,{enablePan:!0,enableZoom:!0,enableRotate:!0,target:[i/2,a/2,0]}),(0,u.jsx)("ambientLight",{intensity:.5}),(0,u.jsx)("directionalLight",{position:[10,10,5],intensity:.7}),(0,u.jsx)("directionalLight",{position:[-10,10,5],intensity:.3})]})},y=e=>{let{data:t,isPlaying:n}=e;const{camera:i}=(0,s.D)(),a=t.map((e=>new l.Vector3(e.x,e.y+.5,e.z))),o=new l.CatmullRomCurve3(a),[c,d]=(0,r.useState)(0);return(0,s.F)((()=>{if(n){d((e=>(e+.001)%1));const e=o.getPoint(c),t=o.getPoint(Math.min(c+.01,1));i.position.set(e.x,e.y,e.z),i.lookAt(t.x,t.y,t.z)}})),null},j=e=>{let{colId:t,colData:n,pointsOfInterest:s}=e;const[a,o]=(0,r.useState)(!0),[l,j]=(0,r.useState)(null),[A,b]=(0,r.useState)(null),[w,v]=(0,r.useState)(!1);return(0,r.useEffect)((()=>{n?(b(n),o(!1)):(j("Donn\xe9es du col non disponibles"),o(!1))}),[n]),a?(0,u.jsx)(c.A,{display:"flex",justifyContent:"center",alignItems:"center",height:"400px",children:(0,u.jsx)(d.A,{})}):l?(0,u.jsx)(c.A,{display:"flex",justifyContent:"center",alignItems:"center",height:"400px",children:(0,u.jsx)(h.A,{color:"error",children:l})}):A?(0,u.jsxs)(m.A,{elevation:2,sx:{height:"400px",width:"100%",overflow:"hidden",position:"relative"},children:[(0,u.jsx)(h.A,{variant:"button",sx:{position:"absolute",top:10,left:10,zIndex:1,backgroundColor:"rgba(0,0,0,0.6)",color:"white",padding:"5px 10px",borderRadius:"4px",cursor:"pointer"},onClick:()=>v(!w),children:w?"Arr\xeater l'animation":"Parcourir le col"}),(0,u.jsxs)(i.Hl,{shadows:!0,children:[(0,u.jsx)(g,{data:A}),(0,u.jsx)(y,{data:A,isPlaying:w}),(0,u.jsx)(p,{data:A}),(0,u.jsx)(x,{data:A}),s&&s.map(((e,t)=>{const n=e.distance/Math.max(...A.map((e=>e.x))),r=Math.floor(n*A.length),s=A[Math.min(r,A.length-1)];return(0,u.jsx)(f,{position:[s.x,s.y+.3,s.z],name:e.name,type:e.type},t)}))]})]}):null}},59720:(e,t,n)=>{n.d(t,{A:()=>i});var r=n(94505);const s=!1,i=(Array.from({length:100},((e,t)=>{const n=t/99;return{x:9.3*n,y:(454+970*n)/100,z:.5*Math.sin(n*Math.PI)}})),Array.from({length:100},((e,t)=>{const n=t/99;return{x:7.8*n,y:(710+429*n)/100,z:.7*Math.sin(n*Math.PI)}})),Array.from({length:100},((e,t)=>{const n=t/99;return{x:5.4*n,y:(500+227*n)/100,z:.6*Math.sin(n*Math.PI)}})),{getAllCols:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{s;const t=new URLSearchParams;e.region&&t.append("region",e.region),e.difficulty&&t.append("difficulty",e.difficulty),e.minElevation&&t.append("minElevation",e.minElevation),e.maxElevation&&t.append("maxElevation",e.maxElevation),e.surface&&e.surface.length>0&&e.surface.forEach((e=>{t.append("surface",e.toLowerCase())})),e.technicalDifficulty&&t.append("technicalDifficulty",e.technicalDifficulty),e.seasons&&e.seasons.length>0&&e.seasons.forEach((e=>{t.append("season",e.toLowerCase())}));return(await r.Ay.get(`/cols?${t.toString()}`)).data}catch(t){throw console.error("Error fetching cols:",t),t}},getColById:async e=>{try{s;return(await r.Ay.get(`/cols/${e}`)).data}catch(t){throw console.error(`Error fetching col ${e}:`,t),t}},getColElevationData:async e=>{try{s;return(await r.Ay.get(`/cols/${e}/elevation`)).data}catch(t){throw console.error(`Error fetching elevation data for col ${e}:`,t),t}},getCol3DTerrainData:async e=>{try{s;return(await r.Ay.get(`/cols/${e}/terrain3d`)).data}catch(t){throw console.error(`Error fetching 3D terrain data for col ${e}:`,t),t}}})},94505:(e,t,n)=>{n.d(t,{Ay:()=>s,FH:()=>r});const r=n(86213).A.create({baseURL:"https://api.grand-est-cyclisme.fr",headers:{"Content-Type":"application/json"},timeout:3e4,withCredentials:!0});r.interceptors.request.use((e=>{const t=localStorage.getItem("authToken");return t&&(e.headers.Authorization=`Bearer ${t}`),"get"===e.method&&(e.params={...e.params,_t:Date.now()}),e}),(e=>Promise.reject(e))),r.interceptors.response.use((e=>{const t=e.headers["x-new-access-token"];return t&&localStorage.setItem("authToken",t),e}),(e=>{if(e.response&&401===e.response.status){var t,n,r,s;"auth_token_expired"===(null===(t=e.response.data)||void 0===t||null===(n=t.error)||void 0===n?void 0:n.type)||(null===(r=e.response.data)||void 0===r||null===(s=r.message)||void 0===s||s.includes("expired"));localStorage.removeItem("authToken"),localStorage.removeItem("user"),"/login"!==window.location.pathname&&(window.location.href="/login?expired=true")}return"ECONNABORTED"===e.code&&e.message.includes("timeout")&&(e.response={data:{error:{type:"timeout_error",message:"La requ\xeate a pris trop de temps \xe0 s'ex\xe9cuter",severity:"warning"}}}),e.response||(e.response={data:{error:{type:"network_error",message:"Impossible de se connecter au serveur",severity:"warning",details:e.message}}}),Promise.reject(e)}));const s=r},94507:(e,t,n)=>{n.r(t),n.d(t,{default:()=>le});var r=n(65043),s=n(26240),i=n(30344),a=n(96446),o=n(81637),l=n(85865),c=n(12110),d=n(26494),h=n(43845),m=n(68903),u=n(63336),x=n(39336),p=n(8939),f=n(24056),g=n(42518),y=n(94271),j=n(69131),A=n(61321),b=n(92153),w=n(33254),v=n(74886),S=n(3632),C=n(26372),z=n(62690),M=n(80150),I=n(52076),k=n(59131),P=n(99972),E=n(97461),D=n(94382),R=n(44836),$=n(18483),F=n(17392),L=n(99070),T=n(63564),G=n(84593),B=n(4265),V=n(93841),O=n(97139),_=n(65257),W=n(98225),q=n(97712),H=n(33552),N=n(42588),U=n(46718),Y=n(29408),K=n(17583),X=n(94905),Q=n(70579);const Z=e=>{let{colId:t,colData:n,pointsOfInterest:s,elevationData:i,isMobile:c}=e;const d=(0,r.useRef)(null),h=(0,r.useRef)(null),m=(0,r.useRef)(null),u=(0,r.useRef)(null),x=(0,r.useRef)(null),p=(0,r.useRef)(null),f=(0,r.useRef)(null),g=(0,r.useRef)(null),[y,j]=(0,r.useState)(!0),[A,b]=(0,r.useState)(null),[w,v]=(0,r.useState)(!1),[S,C]=(0,r.useState)(0),[z,M]=(0,r.useState)(1),[I,k]=(0,r.useState)(!0),[P,E]=(0,r.useState)(!1),[D,R]=(0,r.useState)(0),[X,Z]=(0,r.useState)(0),[se,ie]=(0,r.useState)(0),[ae,oe]=(0,r.useState)(!0),[le,ce]=(0,r.useState)("follow"),[de,he]=(0,r.useState)(0);(0,r.useEffect)((()=>{if(!d.current||!n||0===n.length)return;const e=d.current,t=e.clientWidth,r=e.clientHeight,a=new Y.Scene;a.background=new Y.Color(8900331),a.fog=new Y.FogExp2(8900331,.002),h.current=a;const o=new Y.PerspectiveCamera(75,t/r,.1,1e4);o.position.set(0,50,200),m.current=o;const l=new Y.WebGLRenderer({antialias:!0});l.setSize(t,r),l.setPixelRatio(window.devicePixelRatio),l.shadowMap.enabled=!0,e.appendChild(l.domElement),u.current=l;const c=new K.N(o,l.domElement);c.enableDamping=!0,c.dampingFactor=.05,c.maxPolarAngle=Math.PI/2,c.enabled=!1,x.current=c;const g=new Y.AmbientLight(16777215,.6);a.add(g);const y=new Y.DirectionalLight(16777215,.8);y.position.set(100,100,50),y.castShadow=!0,y.shadow.mapSize.width=1024,y.shadow.mapSize.height=1024,a.add(y);const{path:A}=(()=>{const e=new Y.Group;a.add(e);const t=(()=>{const t=n.map((e=>new Y.Vector3(10*e.x,e.elevation,10*e.y)));let r=0;for(let e=1;e<t.length;e++)r+=t[e].distanceTo(t[e-1]);he(r/10);const s=new Y.CatmullRomCurve3(t);p.current=s;const i=new Y.TubeGeometry(s,200,2,8,!1),a=new Y.MeshStandardMaterial({color:3355443,roughness:.8,metalness:.2}),o=new Y.Mesh(i,a);return o.receiveShadow=!0,e.add(o),s})();return(t=>{const n=new Y.PlaneGeometry(1e3,1e3,100,100),r=n.attributes.position.array;for(let e=0;e<r.length;e+=3){const n=r[e],s=r[e+2];let i=1/0,a=0;for(let e=0;e<=1;e+=.01){const r=t.getPoint(e),o=new Y.Vector2(n-r.x,s-r.z).length();o<i&&(i=o,a=r.y)}const o=Math.min(1,i/50);r[e+1]=a*(1-o)+(a-50)*o}n.computeVertexNormals(),n.rotateX(-Math.PI/2);const s=new Y.MeshStandardMaterial({vertexColors:!0,roughness:.8,metalness:.2}),i=[],a=new Y.Color;for(let e=0;e<r.length;e+=3){const t=r[e+1];t<200?a.setRGB(.2,.5,.2):t<500?a.setRGB(.4,.6,.3):t<1e3?a.setRGB(.6,.6,.4):t<1500?a.setRGB(.7,.7,.6):t<2e3?a.setRGB(.8,.8,.8):a.setRGB(1,1,1),i.push(a.r,a.g,a.b)}const o=new Y.Float32BufferAttribute(i,3);n.setAttribute("color",o);const l=new Y.Mesh(n,s);l.receiveShadow=!0,e.add(l)})(t),(t=>{s&&0!==s.length&&s.forEach((n=>{const r=t.getPoint(n.position/de),s=new Y.SphereGeometry(3,16,16);let i=16711680;"viewpoint"===n.type?i=65280:"rest"===n.type?i=255:"summit"===n.type&&(i=16750848);const a=new Y.MeshStandardMaterial({color:i,emissive:i,emissiveIntensity:.3}),o=new Y.Mesh(s,a);o.position.copy(r),o.position.y+=5,o.castShadow=!0;const l=document.createElement("canvas"),c=l.getContext("2d");l.width=256,l.height=128,c.fillStyle="#ffffff",c.fillRect(0,0,l.width,l.height),c.fillStyle="#000000",c.font="Bold 20px Arial",c.fillText(n.name,10,64);const d=new Y.CanvasTexture(l),h=new Y.SpriteMaterial({map:d}),m=new Y.Sprite(h);m.position.copy(o.position),m.position.y+=10,m.scale.set(20,10,1),e.add(o),e.add(m)}))})(t),{path:t,terrainGroup:e}})(),b={animationId:null,isPlaying:!1,progress:0,speed:1,start:function(){this.isPlaying=!0,v(!0),this.animate()},pause:function(){this.isPlaying=!1,v(!1),this.animationId&&cancelAnimationFrame(this.animationId)},reset:function(){this.progress=0,C(0),this.updateCamera()},setProgress:function(e){this.progress=Math.max(0,Math.min(1,e)),C(e),this.updateCamera()},setSpeed:function(e){this.speed=e,M(e)},updateCamera:function(){if(!A)return;const e=A.getPoint(this.progress),t=A.getTangent(this.progress);if("follow"===le){o.position.set(e.x-10*t.x,e.y+5,e.z-10*t.z);const n=new Y.Vector3(e.x+20*t.x,e.y+1,e.z+20*t.z);o.lookAt(n)}else if("cinematic"===le){const t=this.progress*Math.PI*4,n=20;o.position.set(e.x+Math.cos(t)*n,e.y+10,e.z+Math.sin(t)*n),o.lookAt(e)}if(i&&i.length>0){const e=Math.floor(this.progress*(i.length-1)),t=i[e];t&&(R(t.elevation),Z(t.gradient),ie(t.distance))}},animate:function(){if(!this.isPlaying)return;const e=1e-4*this.speed;this.progress+=e,this.progress>=1&&(this.progress=0),C(this.progress),this.updateCamera(),this.animationId=requestAnimationFrame((()=>this.animate()))}};f.current=b,b.updateCamera();const w=()=>{const t=e.clientWidth,n=e.clientHeight;o.aspect=t/n,o.updateProjectionMatrix(),l.setSize(t,n)};window.addEventListener("resize",w);const S=()=>{requestAnimationFrame(S),x.current&&x.current.update(),l.render(a,o)};return S(),j(!1),()=>{window.removeEventListener("resize",w),f.current&&f.current.animationId&&cancelAnimationFrame(f.current.animationId),u.current&&e.contains(u.current.domElement)&&e.removeChild(u.current.domElement),x.current&&x.current.dispose()}}),[n,s,le,i]);const me=e=>{ce(e),x.current&&(x.current.enabled="orbit"===e)};return(0,r.useEffect)((()=>{const e=()=>{E(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",e),()=>{document.removeEventListener("fullscreenchange",e)}}),[]),y?(0,Q.jsxs)(a.A,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%",sx:{backgroundColor:"rgba(0, 0, 0, 0.03)"},children:[(0,Q.jsx)(o.A,{size:40}),(0,Q.jsx)(l.A,{variant:"subtitle1",sx:{mt:2},children:"Pr\xe9paration du Fly-through..."})]}):A?(0,Q.jsx)(a.A,{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",sx:{backgroundColor:"rgba(0, 0, 0, 0.03)"},children:(0,Q.jsx)(l.A,{color:"error",role:"alert",children:A})}):(0,Q.jsxs)(a.A,{sx:{position:"relative",height:"100%",overflow:"hidden",borderRadius:"8px",boxShadow:3},ref:d,onMouseMove:()=>oe(!0),onMouseLeave:()=>setTimeout((()=>oe(!1)),3e3),onTouchStart:()=>oe(!0),onTouchEnd:()=>setTimeout((()=>oe(!1)),3e3),children:[(0,Q.jsxs)(J,{show:ae||c,ref:g,isMobile:c,children:[(0,Q.jsxs)(l.A,{variant:c?"caption":"body2",children:["Altitude: ",(0,Q.jsxs)("strong",{children:[D.toFixed(0)," m"]})]}),(0,Q.jsxs)(l.A,{variant:c?"caption":"body2",children:["Pente: ",(0,Q.jsxs)("strong",{children:[X.toFixed(1),"%"]})]}),(0,Q.jsxs)(l.A,{variant:c?"caption":"body2",children:["Distance: ",(0,Q.jsxs)("strong",{children:[se.toFixed(1)," / ",de.toFixed(1)," km"]})]})]}),(0,Q.jsxs)(ee,{show:ae||c,isMobile:c,children:[(0,Q.jsxs)(te,{children:[(0,Q.jsx)($.A,{title:w?"Pause":"Lecture",children:(0,Q.jsx)(F.A,{onClick:()=>{f.current&&(w?f.current.pause():f.current.start())},color:"primary",size:c?"small":"medium",children:w?(0,Q.jsx)(T.A,{}):(0,Q.jsx)(G.A,{})})}),(0,Q.jsx)($.A,{title:"Recommencer",children:(0,Q.jsx)(F.A,{onClick:()=>{f.current&&f.current.reset()},color:"primary",size:c?"small":"medium",children:(0,Q.jsx)(B.A,{})})}),(0,Q.jsx)(a.A,{sx:{width:c?100:150,mx:1},children:(0,Q.jsx)(L.Ay,{value:S,onChange:(e,t)=>{f.current&&f.current.setProgress(t)},min:0,max:1,step:.001,"aria-label":"Progression",size:c?"small":"medium"})}),(0,Q.jsx)($.A,{title:I?"Activer le son":"Couper le son",children:(0,Q.jsx)(F.A,{onClick:()=>{k(!I)},color:"primary",size:c?"small":"medium",children:I?(0,Q.jsx)(V.A,{}):(0,Q.jsx)(O.A,{})})}),(0,Q.jsx)($.A,{title:P?"Quitter le plein \xe9cran":"Plein \xe9cran",children:(0,Q.jsx)(F.A,{onClick:()=>{d.current&&(P?document.exitFullscreen&&document.exitFullscreen():d.current.requestFullscreen&&d.current.requestFullscreen(),E(!P))},color:"primary",size:c?"small":"medium",children:P?(0,Q.jsx)(_.A,{}):(0,Q.jsx)(W.A,{})})})]}),(0,Q.jsxs)(ne,{children:[(0,Q.jsxs)(a.A,{sx:{display:"flex",alignItems:"center",mr:2},children:[(0,Q.jsx)(l.A,{variant:c?"caption":"body2",sx:{mr:1},children:"Vitesse:"}),(0,Q.jsx)(a.A,{sx:{width:c?80:100},children:(0,Q.jsx)(L.Ay,{value:z,onChange:(e,t)=>{f.current&&f.current.setSpeed(t)},min:.5,max:3,step:.5,marks:[{value:.5,label:c?"":"0.5x"},{value:1,label:c?"":"1x"},{value:2,label:c?"":"2x"},{value:3,label:c?"":"3x"}],"aria-label":"Vitesse",size:"small"})})]}),(0,Q.jsxs)(a.A,{sx:{display:"flex",alignItems:"center"},children:[(0,Q.jsx)(l.A,{variant:c?"caption":"body2",sx:{mr:1},children:"Cam\xe9ra:"}),(0,Q.jsxs)(a.A,{sx:{display:"flex"},children:[(0,Q.jsx)($.A,{title:"Suivre le parcours",children:(0,Q.jsx)(F.A,{onClick:()=>me("follow"),color:"follow"===le?"primary":"default",size:"small",children:(0,Q.jsx)(q.A,{})})}),(0,Q.jsx)($.A,{title:"Cam\xe9ra libre",children:(0,Q.jsx)(F.A,{onClick:()=>me("orbit"),color:"orbit"===le?"primary":"default",size:"small",children:(0,Q.jsx)(H.A,{})})}),(0,Q.jsx)($.A,{title:"Vue cin\xe9matique",children:(0,Q.jsx)(F.A,{onClick:()=>me("cinematic"),color:"cinematic"===le?"primary":"default",size:"small",children:(0,Q.jsx)(N.A,{})})})]})]})]})]}),c&&(0,Q.jsxs)(re,{children:[(0,Q.jsx)(U.A,{}),(0,Q.jsx)(l.A,{variant:"caption",children:"Touchez pour afficher les contr\xf4les"})]})]})},J=(0,X.Ay)(a.A)`
  position: absolute;
  top: 10px;
  left: 10px;
  background-color: rgba(255, 255, 255, 0.8);
  padding: 8px 12px;
  border-radius: 8px;
  display: flex;
  flex-direction: column;
  gap: 4px;
  transition: opacity 0.3s ease-in-out;
  opacity: ${e=>e.show?1:0};
  pointer-events: ${e=>e.show?"auto":"none"};
  z-index: 10;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
  font-size: ${e=>e.isMobile?"0.75rem":"0.875rem"};
`,ee=(0,X.Ay)(a.A)`
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  background-color: rgba(255, 255, 255, 0.9);
  padding: ${e=>e.isMobile?"8px":"12px"};
  display: flex;
  flex-direction: column;
  gap: 8px;
  transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
  opacity: ${e=>e.show?1:0};
  transform: translateY(${e=>e.show?"0":"100%"});
  pointer-events: ${e=>e.show?"auto":"none"};
  z-index: 10;
  box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.1);
`,te=(0,X.Ay)(a.A)`
  display: flex;
  align-items: center;
  justify-content: center;
`,ne=(0,X.Ay)(a.A)`
  display: flex;
  align-items: center;
  justify-content: center;
  flex-wrap: wrap;
  padding-top: 4px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
`,re=(0,X.Ay)(a.A)`
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  display: flex;
  flex-direction: column;
  align-items: center;
  color: rgba(255, 255, 255, 0.8);
  opacity: 0.7;
  pointer-events: none;
  
  & > .MuiSvgIcon-root {
    font-size: 3rem;
    animation: pulse 2s infinite;
  }
  
  @keyframes pulse {
    0% {
      opacity: 0.7;
      transform: scale(1);
    }
    50% {
      opacity: 1;
      transform: scale(1.1);
    }
    100% {
      opacity: 0.7;
      transform: scale(1);
    }
  }
`,se=r.memo(Z);var ie=n(59720),ae=n(9634);n(81580);const oe=e=>{let{colId:t}=e;const[n,$]=(0,r.useState)(null),[F,L]=(0,r.useState)(!0),[T,G]=(0,r.useState)(null),[B,V]=(0,r.useState)([]),[O,_]=(0,r.useState)(null),[W,q]=(0,r.useState)(0),H=(0,s.A)(),N=(0,i.A)(H.breakpoints.down("sm")),U=(0,i.A)(H.breakpoints.between("sm","md"));(0,r.useEffect)((()=>{t&&(async()=>{try{L(!0);const e=await ie.A.getColById(t);$(e);const n=await ie.A.getColElevationData(t);V(n);const r=await ie.A.getCol3DTerrainData(t);_(r),L(!1)}catch(e){console.error("Erreur lors du chargement des donn\xe9es du col:",e),G("Impossible de charger les donn\xe9es du col. Veuillez r\xe9essayer plus tard."),L(!1)}})()}),[t]);const Y=(0,r.useCallback)(((e,t)=>{q(t)}),[]);return F?(0,Q.jsx)(a.A,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:N?"200px":"400px",children:(0,Q.jsx)(o.A,{"aria-label":"Chargement des donn\xe9es du col"})}):T?(0,Q.jsx)(a.A,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:N?"200px":"400px",children:(0,Q.jsx)(l.A,{color:"error",role:"alert",children:T})}):n?(0,Q.jsx)(c.A,{elevation:3,children:(0,Q.jsxs)(d.A,{sx:{p:N?1.5:3},children:[(0,Q.jsxs)(a.A,{mb:2,display:"flex",flexDirection:N?"column":"row",justifyContent:N?"center":"space-between",alignItems:N?"center":"flex-start",gap:N?1:0,children:[(0,Q.jsx)(l.A,{variant:N?"h5":"h4",component:"h1",align:N?"center":"left",children:n.name}),(0,Q.jsx)(h.A,{icon:(0,Q.jsx)(y.A,{}),label:n.difficulty,color:"Difficile"===n.difficulty?"error":"Mod\xe9r\xe9"===n.difficulty?"warning":"success",size:N?"small":"medium","aria-label":`Difficult\xe9: ${n.difficulty}`})]}),(0,Q.jsx)(a.A,{mb:2,children:(0,Q.jsx)(ae.LazyLoadImage,{src:n.imageUrl,alt:`Vue du col ${n.name}`,effect:"blur",style:{width:"100%",height:N?"180px":"250px",objectFit:"cover",borderRadius:"8px"},wrapperClassName:"lazy-image-wrapper"})}),(0,Q.jsx)(l.A,{variant:"body1",paragraph:!0,sx:{mb:3,fontSize:N?"0.9rem":"1rem",textAlign:N?"justify":"left"},children:n.description}),(0,Q.jsxs)(m.Ay,{container:!0,spacing:N?1:3,sx:{mb:3},children:[(0,Q.jsx)(m.Ay,{item:!0,xs:6,sm:6,md:4,children:(0,Q.jsxs)(u.A,{sx:{p:N?1:2,height:"100%"},children:[(0,Q.jsxs)(a.A,{display:"flex",alignItems:"center",mb:.5,children:[(0,Q.jsx)(y.A,{color:"primary",sx:{mr:.5,fontSize:N?"1rem":"1.25rem"}}),(0,Q.jsx)(l.A,{variant:N?"body2":"h6",children:"Altitude"})]}),(0,Q.jsxs)(l.A,{variant:N?"h6":"h4",component:"p",align:"center",sx:{mt:N?.5:1},children:[n.altitude," m"]})]})}),(0,Q.jsx)(m.Ay,{item:!0,xs:6,sm:6,md:4,children:(0,Q.jsxs)(u.A,{sx:{p:N?1:2,height:"100%"},children:[(0,Q.jsxs)(a.A,{display:"flex",alignItems:"center",mb:.5,children:[(0,Q.jsx)(j.A,{color:"primary",sx:{mr:.5,fontSize:N?"1rem":"1.25rem"}}),(0,Q.jsx)(l.A,{variant:N?"body2":"h6",children:"Longueur"})]}),(0,Q.jsxs)(l.A,{variant:N?"h6":"h4",component:"p",align:"center",sx:{mt:N?.5:1},children:[n.length," km"]})]})}),(0,Q.jsx)(m.Ay,{item:!0,xs:12,sm:12,md:4,children:(0,Q.jsxs)(u.A,{sx:{p:N?1:2,height:"100%"},children:[(0,Q.jsxs)(a.A,{display:"flex",alignItems:"center",mb:.5,children:[(0,Q.jsx)(A.A,{color:"primary",sx:{mr:.5,fontSize:N?"1rem":"1.25rem"}}),(0,Q.jsx)(l.A,{variant:N?"body2":"h6",children:"Pente moyenne"})]}),(0,Q.jsxs)(l.A,{variant:N?"h6":"h4",component:"p",align:"center",sx:{mt:N?.5:1},children:[n.avgGradient,"%"]})]})})]}),(0,Q.jsx)(x.A,{sx:{mb:2}}),(0,Q.jsx)(a.A,{sx:{mb:2},children:(0,Q.jsxs)(p.A,{value:W,onChange:Y,variant:"scrollable",scrollButtons:N?"auto":"desktop",allowScrollButtonsMobile:!0,"aria-label":"Onglets de visualisation du col",children:[(0,Q.jsx)(f.A,{label:N?"Profil":"Profil d'\xe9l\xe9vation",icon:(0,Q.jsx)(b.A,{}),id:`tab-chart-${t}`,"aria-controls":`tabpanel-chart-${t}`,iconPosition:"start"}),(0,Q.jsx)(f.A,{label:N?"3D":"Visualisation 3D",icon:(0,Q.jsx)(w.A,{}),id:`tab-3d-${t}`,"aria-controls":`tabpanel-3d-${t}`,iconPosition:"start"}),(0,Q.jsx)(f.A,{label:N?"Fly":"Fly-through",icon:(0,Q.jsx)(v.A,{}),id:`tab-fly-${t}`,"aria-controls":`tabpanel-fly-${t}`,iconPosition:"start"})]})}),(0,Q.jsxs)(a.A,{sx:{mb:3},children:[(0,Q.jsx)(a.A,{role:"tabpanel",id:`tabpanel-chart-${t}`,hidden:0!==W,sx:{height:N?"250px":U?"300px":"400px",mb:2},"aria-labelledby":`tab-chart-${t}`,children:0===W&&(0,Q.jsx)(z.u,{width:"100%",height:"100%",children:(0,Q.jsxs)(M.b,{data:B,margin:{top:10,right:N?5:30,left:N?5:20,bottom:10},children:[(0,Q.jsx)(I.d,{strokeDasharray:"3 3"}),(0,Q.jsx)(k.W,{dataKey:"distance",label:{value:"Distance (km)",position:"insideBottomRight",offset:-10,fontSize:N?10:12},tick:{fontSize:N?10:12}}),(0,Q.jsx)(P.h,{label:{value:"\xc9l\xe9vation (m)",angle:-90,position:"insideLeft",fontSize:N?10:12},domain:["dataMin - 50","dataMax + 50"],tick:{fontSize:N?10:12}}),(0,Q.jsx)(E.m,{formatter:e=>[`${e} m`,"\xc9l\xe9vation"],labelFormatter:e=>`Distance: ${e} km`,contentStyle:{fontSize:N?"0.75rem":"0.875rem"}}),(0,Q.jsx)(D.N,{type:"monotone",dataKey:"elevation",stroke:"#2196F3",dot:!1,strokeWidth:N?1.5:2})]})})}),(0,Q.jsx)(a.A,{role:"tabpanel",id:`tabpanel-3d-${t}`,hidden:1!==W,sx:{height:N?"300px":U?"350px":"450px",mb:2},"aria-labelledby":`tab-3d-${t}`,children:1===W&&O&&(0,Q.jsx)(R.A,{colId:t,colData:O.coordinates,pointsOfInterest:O.pointsOfInterest,isMobile:N})}),(0,Q.jsx)(a.A,{role:"tabpanel",id:`tabpanel-fly-${t}`,hidden:2!==W,sx:{height:N?"350px":U?"400px":"500px",mb:2},"aria-labelledby":`tab-fly-${t}`,children:2===W&&O&&(0,Q.jsx)(se,{colId:t,colData:O.coordinates,pointsOfInterest:O.pointsOfInterest,elevationData:B,isMobile:N})})]}),(0,Q.jsx)(l.A,{variant:N?"h6":"h5",component:"h2",sx:{mb:N?1:2},children:"Points d'int\xe9r\xeat"}),(0,Q.jsx)(m.Ay,{container:!0,spacing:N?1:2,children:n.terrainData.pointsOfInterest.map(((e,t)=>(0,Q.jsx)(m.Ay,{item:!0,xs:12,sm:6,md:4,children:(0,Q.jsxs)(u.A,{sx:{p:N?1.5:2,transition:"transform 0.2s ease-in-out","&:hover":{transform:"translateY(-4px)",boxShadow:3}},children:[(0,Q.jsxs)(a.A,{display:"flex",alignItems:"center",mb:1,children:["viewpoint"===e.type&&(0,Q.jsx)(S.A,{color:"primary",sx:{mr:1,fontSize:N?"1.1rem":"1.25rem"},"aria-hidden":"true"}),"rest"===e.type&&(0,Q.jsx)(C.A,{color:"primary",sx:{mr:1,fontSize:N?"1.1rem":"1.25rem"},"aria-hidden":"true"}),"summit"===e.type&&(0,Q.jsx)(y.A,{color:"primary",sx:{mr:1,fontSize:N?"1.1rem":"1.25rem"},"aria-hidden":"true"}),(0,Q.jsx)(l.A,{variant:N?"subtitle1":"h6",sx:{fontSize:N?"0.9rem":"inherit"},children:e.name})]}),(0,Q.jsxs)(l.A,{variant:"body2",color:"textSecondary",sx:{fontSize:N?"0.8rem":"inherit"},children:["\xc0 ",e.distance," km du d\xe9part"]})]})},t)))}),(0,Q.jsxs)(a.A,{mt:3,display:"flex",flexDirection:N?"column":"row",justifyContent:N?"center":"space-between",gap:N?1:0,children:[(0,Q.jsx)(g.A,{variant:"outlined",color:"primary",fullWidth:N,"aria-label":"Voir le col sur la carte",children:"Voir sur la carte"}),(0,Q.jsx)(g.A,{variant:"contained",color:"primary",fullWidth:N,startIcon:(0,Q.jsx)(v.A,{}),onClick:()=>q(2),sx:{mt:N?1:0,mx:N?0:1},"aria-label":"Explorer le col en Fly-through",children:"Explorer en Fly-through"}),(0,Q.jsx)(g.A,{variant:"contained",color:"primary",fullWidth:N,sx:{mt:N?1:0},"aria-label":"Ajouter le col \xe0 mon itin\xe9raire",children:"Ajouter \xe0 mon itin\xe9raire"})]})]})}):(0,Q.jsx)(a.A,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:N?"200px":"400px",children:(0,Q.jsx)(l.A,{variant:"subtitle1",children:"S\xe9lectionnez un col pour voir ses d\xe9tails"})})},le=r.memo(oe)}}]);
//# sourceMappingURL=4507.ca953035.chunk.js.map